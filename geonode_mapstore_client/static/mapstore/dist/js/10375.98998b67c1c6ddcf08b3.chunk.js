(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[10375],{810375:(n,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>m});var r=t(845243),o=t.n(r),i=t(984596),l=t.n(i);function c(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function a(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function u(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function f(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?u(Object(t),!0).forEach((function(e){d(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function d(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function s(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var y={Point:["Mark","Icon","Text"],MultiPoint:["Mark","Icon","Text"],LineString:["Line"],MultiLineString:["Line"],Polygon:["Fill"],MultiPolygon:["Fill"]};function v(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return n.properties?Object.keys(n.properties).reduce((function(e,t){var r,o=new RegExp("\\{\\{".concat(t,"\\}\\}"),"g");return e.replace(o,null!==(r=n.properties[t])&&void 0!==r?r:"")}),e):e}function p(n,e){var t,r=n.rules,i=void 0===r?[]:r,c=e.geoStylerStyleFilter,a=e.images,u=e.getImageIdFromSymbolizer,d=(t=i,function(n){if(Array.isArray(n))return s(n)}(t)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(t)||function(n,e){if(n){if("string"==typeof n)return s(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?s(n,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).reverse();return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=n.opacity,t=void 0===e?1:e;return{filter:function(n){var e,t=null==n||null===(e=n.geometry)||void 0===e?void 0:e.type;if(0===d.length)return!1;var r=y[t]||[];return!!d.find((function(e){var t;return(null==e||null===(t=e.symbolizers)||void 0===t?void 0:t.find((function(n){return r.includes(n.kind)})))&&(!e.filter||c(n,e.filter))}))},pointToLayer:function(n,e){var r,i,f=null==n||null===(r=n.geometry)||void 0===r?void 0:r.type,s=y[f]||[],p=d.find((function(e){var t;return(null==e||null===(t=e.symbolizers)||void 0===t?void 0:t.find((function(n){return s.includes(n.kind)})))&&(!e.filter||c(n,e.filter))}))||{},m=(null==p||null===(i=p.symbolizers)||void 0===i?void 0:i.find((function(n){return s.includes(n.kind)})))||{};if("Mark"===m.kind){var g=a.find((function(n){return n.id===u(m)}))||{},b=g.image,h=g.src,k=g.width,w=g.height;if(b){var S=k/w,O=2*m.radius,j=O,I=j/S;return w>k&&(j=(I=O)*S),o().marker(e,{icon:o().icon({iconUrl:h,iconSize:[j,I],iconAnchor:[j/2,I/2]}),opacity:1*t})}}if("Icon"===m.kind){var P=a.find((function(n){return n.id===u(m)}))||{},z=P.image,F=P.src,x=P.width,A=P.height;if(z){var _=x/A,C=m.size,M=C/_;return A>x&&(C=(M=m.size)*_),o().marker(e,{icon:o().icon({iconUrl:F,iconSize:[C,M],iconAnchor:[C/2,M/2]}),opacity:m.opacity*t})}}if("Text"===m.kind){var L,T,E,D,W,U=v(n,m.label),J="\n                        -webkit-text-stroke-width:".concat(m.haloWidth,"px;\n                        -webkit-text-stroke-color:").concat(m.haloColor||"",";\n                    "),N=o().divIcon({html:'<div style="\n                            color:'.concat(m.color,";\n                            font-family: ").concat(l()(m.font||[]).join(", "),";\n                            font-style: ").concat(m.fontStyle||"normal",";\n                            font-weight: ").concat(m.fontWeight||"normal",";\n                            font-size: ").concat(m.size,"px;\n\n                            position: absolute;\n                            transform: translate(").concat(null!==(L=null==m||null===(T=m.offset)||void 0===T?void 0:T[0])&&void 0!==L?L:0,"px, ").concat(null!==(E=null==m||null===(D=m.offset)||void 0===D?void 0:D[1])&&void 0!==E?E:0,"px) rotateZ(").concat(null!==(W=null==m?void 0:m.rotate)&&void 0!==W?W:0,"deg);\n\n                            ").concat(m.haloWidth>0?J:"",'\n                        ">\n                            ').concat(U,"\n                            </div>"),className:""});return o().marker(e,{icon:N,opacity:1*t})}return null},style:function(n){var e,r,o,i,l=null==n||null===(e=n.geometry)||void 0===e?void 0:e.type,a=y[l]||[],u=d.find((function(e){var t;return(null==e||null===(t=e.symbolizers)||void 0===t?void 0:t.find((function(n){return a.includes(n.kind)})))&&(!e.filter||c(n,e.filter))}))||{},s=(null==u||null===(r=u.symbolizers)||void 0===r?void 0:r.find((function(n){return a.includes(n.kind)})))||{};return"Line"===s.kind?f(f(f({stroke:!0,fill:!1,color:s.color,opacity:s.opacity*t,weight:s.width},s.dasharray&&{dashArray:s.dasharray.join(" ")}),s.cap&&{lineCap:s.cap}),s.join&&{lineJoin:s.join}):"Fill"===s.kind?{fill:!0,stroke:!0,fillColor:s.color,fillOpacity:s.fillOpacity*t,color:s.outlineColor,opacity:(null!==(o=s.outlineOpacity)&&void 0!==o?o:0)*t,weight:null!==(i=s.outlineWidth)&&void 0!==i?i:0}:{stroke:!1,fill:!1}}}}}const m=function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.drawIcons,r=e.getImageIdFromSymbolizer,o=e.geoStylerStyleFilter;c(this,n),this._drawIcons=t||function(){return Promise.resolve(null)},this._getImageIdFromSymbolizer=r||function(n){return n.symbolizerId},this._geoStylerStyleFilter=o||function(){return!0}}var e,t;return e=n,(t=[{key:"readStyle",value:function(){return new Promise((function(n,e){try{n(null)}catch(n){e(n)}}))}},{key:"writeStyle",value:function(n){var e=this;return new Promise((function(t,r){try{e._drawIcons(n).then((function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=p(n,{images:r,getImageIdFromSymbolizer:e._getImageIdFromSymbolizer,geoStylerStyleFilter:e._geoStylerStyleFilter});t(o)}))}catch(n){r(n)}}))}}])&&a(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),n}()}}]);