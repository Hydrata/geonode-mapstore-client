(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[33122],{833122:(e,o,t)=>{"use strict";t.r(o),t.d(o,{default:()=>C});var r=t(376180),i=t(65792),n=t.n(i),l=t(984596),a=t.n(l),c=t(281763),s=t.n(c),u=t(396026),f=t.n(u);function d(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function p(e,o){for(var t=0;t<o.length;t++){var r=o[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,o){(null==o||o>e.length)&&(o=e.length);for(var t=0,r=new Array(o);t<o;t++)r[t]=e[t];return r}function h(e){var o,t,i=e.color,l=e.opacity,a=(o=n()(i).gl(),t=4,function(e){if(Array.isArray(e))return e}(o)||function(e,o){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,n=[],l=!0,a=!1;try{for(t=t.call(e);!(l=(r=t.next()).done)&&(n.push(r.value),!o||n.length!==o);l=!0);}catch(e){a=!0,i=e}finally{try{l||null==t.return||t.return()}finally{if(a)throw i}}return n}}(o,t)||function(e,o){if(e){if("string"==typeof e)return y(e,o);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?y(e,o):void 0}}(o,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=a[0],s=a[1],u=a[2],f=a[3];return void 0!==l?new r.Color(c,s,u,l):new r.Color(c,s,u,f)}function m(e,o){var t,r;switch(e){case"polyline":return null===(t=o[e])||void 0===t?void 0:t.positions;case"polygon":return null===(r=o[e])||void 0===r?void 0:r.hierarchy;default:return null}}function v(e){var o=e.color,t=e.opacity,i=e.dasharray;if((null==i?void 0:i.length)<=0)return h({color:o,opacity:t});var n=i.reduce((function(e,o){return e+o}),0);return new r.PolylineDashMaterialProperty({color:h({color:o,opacity:t}),dashLength:n,dashPattern:parseInt(i.map((function(e){return Math.floor(e/n*16)})).map((function(e,o){return f()(e).map((function(){return o%2==0?"1":"0"})).join("")})).join(""),2)})}function g(e,o,t,i){var n,l;o._msPosition||(o._msPosition=o.position.getValue(r.JulianDate.now()));var a=function(e,o){var t=parseFloat(e);if(!isNaN(t)&&s()(t))return t;var r="attribute"===(null==e?void 0:e.type)&&parseFloat(o[e.name]);return!isNaN(r)&&s()(r)?r:null}(t.msHeight,i);if(null!==a){var c=null==e||null===(n=e.scene)||void 0===n||null===(l=n.globe)||void 0===l?void 0:l.ellipsoid;if(c){var u=c.cartesianToCartographic(o._msPosition);u.height=a,o.position.setValue(c.cartographicToCartesian(u))}}else o.position.setValue(o._msPosition)}function b(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.properties?Object.keys(e.properties).reduce((function(o,t){var r,i=new RegExp("\\{\\{".concat(t,"\\}\\}"),"g");return o.replace(i,null!==(r=e.properties[t])&&void 0!==r?r:"")}),o):o}var w=["billboard","box","corridor","cylinder","ellipse","ellipsoid","label","model","tileset","path","plane","point","polygon","polyline","polylineVolume","rectangle","wall"],S={none:"NONE",relative:"RELATIVE_TO_GROUND",clamp:"CLAMP_TO_GROUND"};function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=e.rules,t=void 0===o?[]:o,i=arguments.length>1?arguments[1]:void 0,n=i.images,l=void 0===n?[]:n,c=i.getImageIdFromSymbolizer,s=i.geoStylerStyleFilter,u=void 0===s?function(){return!0}:s;return function(e){var o=e.entities,i=e.map,n=e.opacity,s=void 0===n?1:n;o.forEach((function(e){var o={};w.forEach((function(t){e._msStoredCoordinates||(o[t]=m(t,e)||void 0),e[t]=void 0})),e._msStoredCoordinates||(e._msStoredCoordinates=o)})),t.forEach((function(e){e.symbolizers.forEach((function(t){o.forEach((function(o){var n,f=(null==o||null===(n=o.properties)||void 0===n?void 0:n.getValue(r.JulianDate.now()))||{};if(!e.filter||u({properties:f||{}},e.filter)){if("Mark"===t.kind&&o.position){var d=l.find((function(e){return e.id===c(t)}))||{},p=d.image,y=d.width,m=d.height;if(p){var w=y>m?y:m,I=2*t.radius/w;o.billboard=new r.BillboardGraphics({image:p,scale:I,rotation:r.Math.toRadians(-1*t.rotate||0),disableDepthTestDistance:t.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:r.HeightReference[S[t.msHeightReference]||"NONE"],color:h({color:"#ffffff",opacity:1*s})}),g(i,o,t,f)}}if("Icon"===t.kind&&o.position){var C=l.find((function(e){return e.id===c(t)}))||{},_=C.image,T=C.width,N=C.height;if(_){var E=T>N?T:N,O=t.size/E;o.billboard=new r.BillboardGraphics({image:_,scale:O,rotation:r.Math.toRadians(-1*t.rotate||0),disableDepthTestDistance:t.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:r.HeightReference[S[t.msHeightReference]||"NONE"],color:h({color:"#ffffff",opacity:t.opacity*s})}),g(i,o,t,f)}}var P,F,R,k;"Line"===t.kind&&o._msStoredCoordinates.polyline&&(o.polyline=new r.PolylineGraphics({material:null!=t&&t.dasharray?v({color:t.color,opacity:t.opacity*s,dasharray:t.dasharray}):h({color:t.color,opacity:t.opacity*s}),width:t.width,positions:o._msStoredCoordinates.polyline,clampToGround:t.msClampToGround})),"Fill"===t.kind&&o._msStoredCoordinates.polygon&&(o.polygon=new r.PolygonGraphics({material:h({color:t.color,opacity:t.fillOpacity*s}),hierarchy:o._msStoredCoordinates.polygon,classificationType:"terrain"===t.msClassificationType?r.ClassificationType.TERRAIN:"3d"===t.msClassificationType?r.ClassificationType.CESIUM_3D_TILE:r.ClassificationType.BOTH}),t.outlineColor&&0!==t.outlineWidth&&(o.polyline=new r.PolylineGraphics({material:h({color:t.outlineColor,opacity:t.outlineOpacity*s}),width:t.outlineWidth,positions:o._msStoredCoordinates.polygon.getValue().positions,clampToGround:t.msClampToGround}))),"Text"===t.kind&&o.position&&(o.label=new r.LabelGraphics({text:b({properties:f},t.label),font:[t.fontStyle,t.fontWeight,"".concat(t.size,"px"),a()(t.font||["serif"]).join(", ")].filter((function(e){return e})).join(" "),fillColor:h({color:t.color,opacity:1*s}),heightReference:r.HeightReference[S[t.msHeightReference]||"NONE"],pixelOffset:new r.Cartesian2(null!==(P=null==t||null===(F=t.offset)||void 0===F?void 0:F[0])&&void 0!==P?P:0,null!==(R=null==t||null===(k=t.offset)||void 0===k?void 0:k[1])&&void 0!==R?R:0),outlineColor:h({color:t.haloColor,opacity:1*s}),outlineWidth:t.haloWidth}),g(i,o,t,f))}}))}))}))}}const C=function(){function e(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=o.drawIcons,r=o.getImageIdFromSymbolizer,i=o.geoStylerStyleFilter;d(this,e),this._drawIcons=t||function(){return Promise.resolve(null)},this._getImageIdFromSymbolizer=r||function(e){return e.symbolizerId},this._geoStylerStyleFilter=i||function(){return!0}}var o,t;return o=e,(t=[{key:"readStyle",value:function(){return new Promise((function(e,o){try{e(null)}catch(e){o(e)}}))}},{key:"writeStyle",value:function(e){var o=this;return new Promise((function(t,r){try{o._drawIcons(e).then((function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=I(e,{images:r,getImageIdFromSymbolizer:o._getImageIdFromSymbolizer,geoStylerStyleFilter:o._geoStylerStyleFilter});t(i)}))}catch(e){r(e)}}))}}])&&p(o.prototype,t),Object.defineProperty(o,"prototype",{writable:!1}),e}()},540098:e=>{var o=Math.ceil,t=Math.max;e.exports=function(e,r,i,n){for(var l=-1,a=t(o((r-e)/(i||1)),0),c=Array(a);a--;)c[n?a:++l]=e,e+=i;return c}},747445:(e,o,t)=>{var r=t(540098),i=t(816612),n=t(418601);e.exports=function(e){return function(o,t,l){return l&&"number"!=typeof l&&i(o,t,l)&&(t=l=void 0),o=n(o),void 0===t?(t=o,o=0):t=n(t),l=void 0===l?o<t?1:-1:n(l),r(o,t,l,e)}}},396026:(e,o,t)=>{var r=t(747445)();e.exports=r}}]);