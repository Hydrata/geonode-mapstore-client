(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[70082],{801550:(t,n,e)=>{"use strict";e.d(n,{pP:()=>r,TR:()=>a,N7:()=>o,mq:()=>u,uv:()=>i,Qy:()=>l,IL:()=>c,Li:()=>s,OW:()=>d,ZO:()=>A,Um:()=>f,TF:()=>_,Ls:()=>v,Ec:()=>p,Eu:()=>E,JJ:()=>O,nZ:()=>g,YD:()=>N,GI:()=>S,Jb:()=>b,Uh:()=>T,e$:()=>y,eh:()=>U,$j:()=>R,bJ:()=>D,Mk:()=>I,xy:()=>h,o6:()=>m,FP:()=>C,Mo:()=>M,sO:()=>w,Px:()=>P,hd:()=>G,Ju:()=>L,BV:()=>j,SO:()=>k,H0:()=>H,$X:()=>F,ou:()=>W,NE:()=>x,Lq:()=>V,aN:()=>K});var r="CHANGE_MAP_VIEW",a="CLICK_ON_MAP",o="CHANGE_MOUSE_POINTER",u="CHANGE_ZOOM_LVL",i="PAN_TO",l="ZOOM_TO_EXTENT",c="ZOOM_TO_POINT",s="CHANGE_MAP_CRS",d="CHANGE_MAP_SCALES",A="CHANGE_MAP_STYLE",f="CHANGE_ROTATION",_="CREATION_ERROR_LAYER",v="UPDATE_VERSION",p="INIT_MAP",E="RESIZE_MAP",O="CHANGE_MAP_LIMITS",g="SET_MAP_RESOLUTIONS",N="REGISTER_EVENT_LISTENER",S="UNREGISTER_EVENT_LISTENER",b="MOUSE_MOVE",T="MOUSE_OUT",y="MAP:MAP_PLUGIN_LOAD",U="MAP:ORIENTATION",R="MAP:UPDATE_MAP_VIEW",D="MAP:UPDATE_MAP_OPTIONS";function I(t,n,e,r){return{type:y,mapType:n,loading:t,loaded:e,error:r}}function h(t,n,e){return{type:c,pos:t,zoom:n,crs:e}}function m(t,n,e,a,o,u,i,l){return{type:r,center:t,zoom:n,bbox:e,size:a,mapStateSource:o,projection:u,viewerOptions:i,resolution:l}}function C(t,n){return{type:a,point:t,layer:n}}function M(t){return{type:o,pointer:t}}function w(t,n){return{type:u,zoom:t,mapStateSource:n}}function P(t,n,e,r){return{type:l,extent:t,crs:n,maxZoom:e,options:r}}function G(t,n){return{type:A,style:t,mapStateSource:n}}function L(){return{type:E}}function j(t){var n=t.restrictedExtent,e=t.crs,r=t.minZoom;return{type:O,restrictedExtent:n,crs:e,minZoom:r}}function k(t){return{type:g,resolutions:t}}var H=function(t,n){return{type:N,eventName:t,toolName:n}},F=function(t,n){return{type:S,eventName:t,toolName:n}},W=function(t){return{type:b,position:t}},x=function(){return{type:T}},V=function(t){return{type:U,orientation:t}},K=function(t){return{type:D,configUpdate:t}}},615402:(t,n,e)=>{"use strict";e.d(n,{Z:()=>p});var r=e(45697),a=e.n(r),o=e(124852),u=e.n(o);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function c(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,n){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t})(t,n)}function d(t,n){if(n&&("object"===i(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var _=e(868195).FormattedHTMLMessage,v=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&s(t,n)}(i,t);var n,e,r,a,o=(r=i,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=A(r);if(a){var e=A(this).constructor;t=Reflect.construct(n,arguments,e)}else t=n.apply(this,arguments);return d(this,t)});function i(){return l(this,i),o.apply(this,arguments)}return n=i,(e=[{key:"render",value:function(){return this.context.intl?u().createElement(_,{id:this.props.msgId,values:this.props.msgParams}):u().createElement("span",null,this.props.msgId||"")}}])&&c(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),i}(u().Component);f(v,"propTypes",{msgId:a().string.isRequired,msgParams:a().object}),f(v,"contextTypes",{intl:a().object});const p=v},368658:(t,n,e)=>{function r(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function a(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?r(Object(e),!0).forEach((function(n){o(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):r(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function o(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var u=e(197395).SHOW_NOTIFICATION,i=e(423570),l="INIT_ANUGA",c="SET_ANUGA_INPUT_MENU",s="SET_ANUGA_SCENARIO_MENU",d="SET_ANUGA_RESULT_MENU",A="SET_NETWORK_MENU",f="SET_REVIEW_PANEL",_="SET_PUBLICATION_PANEL",v="SET_ANUGA_PROJECT_DATA",p="SET_ANUGA_SCENARIO_DATA",E="SET_ANUGA_BOUNDARY_DATA",O="SET_ANUGA_FRICTION_DATA",g="SET_ANUGA_INFLOW_DATA",N="SET_ANUGA_STRUCTURE_DATA",S="SET_ANUGA_FULL_MESH_DATA",b="SET_ANUGA_MESH_REGION_DATA",T="SET_NETWORK_DATA",y="SET_LUMPED_CATCHMENT_DATA",U="SET_ANUGA_NODES_DATA",R="SET_ANUGA_LINKS_DATA",D="SET_PUBLICATION_DATA",I="CREATE_ANUGA_BOUNDARY",h="CREATE_ANUGA_FRICTION",m="CREATE_ANUGA_INFLOW",C="CREATE_ANUGA_STRUCTURE",M="CREATE_ANUGA_MESH_REGION",w="CREATE_NETWORK",P="CREATE_LUMPED_CATCHMENT",G="CREATE_NODES",L="CREATE_LINKS",j="CREATE_FIGURE",k="ADD_ANUGA_BOUNDARY",H="ADD_ANUGA_FRICTION",F="ADD_ANUGA_INFLOW",W="ADD_ANUGA_STRUCTURE",x="ADD_ANUGA_FULL_MESH",V="ADD_ANUGA_MESH_REGION",K="ADD_ANUGA_NETWORK",B="ADD_LUMPED_CATCHMENT",Y="ADD_NODES",Z="ADD_LINKS",J="ADD_COMPARISON",z="SET_ANUGA_ELEVATION_DATA",$="CREATE_ANUGA_ELEVATION_FROM_LAYER",Q="SET_ADD_ANUGA_ELEVATION_DATA",q="ADD_ANUGA_SCENARIO",X="RUN_ANUGA_SCENARIO",tt="RUN_ANUGA_SCENARIO_SUCCESS",nt="RUN_NETWORK",et="RUN_NETWORK_SUCCESS",rt="SAVE_ANUGA_SCENARIO",at="SAVE_ANUGA_SCENARIO_SUCCESS",ot="SAVE_ANUGA_SCENARIO_ERROR",ut="DELETE_ANUGA_SCENARIO",it="SHOW_ANUGA_SCENARIO_LOG",lt="SHOW_ANUGA_RUN_MENU",ct="START_ANUGA_SCENARIO_POLLING",st="STOP_ANUGA_SCENARIO_POLLING",dt="START_ANUGA_ELEVATION_POLLING",At="STOP_ANUGA_ELEVATION_POLLING",ft="START_ANUGA_MODEL_CREATION_POLLING",_t="STOP_ANUGA_MODEL_CREATION_POLLING",vt="START_COMPARISON_POLLING",pt="STOP_COMPARISON_POLLING",Et="SET_COMPARISON_DATA",Ot="SET_ANUGA_POLLING_DATA",gt="UPDATE_ANUGA_SCENARIO",Nt="UPDATE_NETWORK",St="SELECT_ANUGA_SCENARIO",bt="SET_CREATING_ANUGA_LAYER",Tt="SET_ANUGA_SCENARIO_IS_LOADED",yt="CANCEL_ANUGA_RUN",Ut="UPDATE_COMPUTE_INSTANCE",Rt="UPDATE_COMPUTE_INSTANCE_SUCCESS",Dt="TOGGLE_SCENARIO_SELECTED",It="SHOW_MANAGE_ACCOUNT",ht="COMPARE_SCENARIOS",mt="COMPARE_SCENARIOS_SUCCESS",Ct="UPDATE_ANUGA_RESOURCES",Mt="SET_ANUGA_RESOURCES";t.exports={INIT_ANUGA:l,initAnuga:function(){return{type:l}},SET_ANUGA_INPUT_MENU:c,setAnugaInputMenu:function(t){return{type:c,visible:t}},SET_ANUGA_SCENARIO_MENU:s,setAnugaScenarioMenu:function(t){return{type:s,visible:t}},SET_ANUGA_RESULT_MENU:d,setAnugaResultMenu:function(t){return{type:d,visible:t}},SET_REVIEW_PANEL:f,setReviewPanel:function(t){return{type:f,visible:t}},SET_PUBLICATION_PANEL:_,setPublicationPanel:function(t){return{type:_,visible:t}},SET_ANUGA_PROJECT_DATA:v,setAnugaProjectData:function(t){return{type:v,data:t}},SET_ANUGA_SCENARIO_DATA:p,setAnugaScenarioData:function(t){return{type:p,scenarios:t}},SET_ANUGA_ELEVATION_DATA:z,setAnugaElevationData:function(t){return{type:z,data:t}},SET_ANUGA_BOUNDARY_DATA:E,setAnugaBoundaryData:function(t){return{type:E,data:t}},SET_ANUGA_FRICTION_DATA:O,setAnugaFrictionData:function(t){return{type:O,data:t}},SET_ANUGA_INFLOW_DATA:g,setAnugaInflowData:function(t){return{type:g,data:t}},SET_ANUGA_STRUCTURE_DATA:N,setAnugaStructureData:function(t){return{type:N,data:t}},SET_ANUGA_FULL_MESH_DATA:S,setAnugaFullMeshData:function(t){return{type:S,data:t}},SET_ANUGA_MESH_REGION_DATA:b,setAnugaMeshRegionData:function(t){return{type:b,data:t}},SET_NETWORK_DATA:T,setNetworkData:function(t){return{type:T,data:t}},SET_LUMPED_CATCHMENT_DATA:y,setCatchmentData:function(t){return{type:y,data:t}},SET_ANUGA_NODES_DATA:U,setAnugaNodesData:function(t){return{type:U,data:t}},SET_ANUGA_LINKS_DATA:R,setAnugaLinksData:function(t){return{type:R,data:t}},SET_PUBLICATION_DATA:D,setPublicationData:function(t){return{type:D,data:t}},CREATE_ANUGA_BOUNDARY:I,createAnugaBoundary:function(t){return{type:I,boundaryTitle:t}},CREATE_ANUGA_FRICTION:h,createAnugaFriction:function(t){return{type:h,frictionTitle:t}},CREATE_ANUGA_INFLOW:m,createAnugaInflow:function(t){return{type:m,inflowTitle:t}},CREATE_ANUGA_STRUCTURE:C,createAnugaStructure:function(t){return{type:C,structureTitle:t}},CREATE_ANUGA_MESH_REGION:M,createAnugaMeshRegion:function(t){return{type:M,meshRegionTitle:t}},CREATE_NETWORK:w,createNetwork:function(t){return{type:w,networkTitle:t}},CREATE_LUMPED_CATCHMENT:P,createCatchment:function(t){return{type:P,catchmentTitle:t}},CREATE_NODES:G,createNodes:function(t){return{type:G,nodesTitle:t}},CREATE_LINKS:L,createLinks:function(t){return{type:L,linksTitle:t}},CREATE_FIGURE:j,createFigure:function(t,n){return{type:j,figureTitle:t,publicationId:n}},ADD_ANUGA_BOUNDARY:k,addAnugaBoundary:function(){return{type:k}},ADD_ANUGA_FRICTION:H,addAnugaFriction:function(){return{type:H}},ADD_ANUGA_INFLOW:F,addAnugaInflow:function(){return{type:F}},ADD_ANUGA_STRUCTURE:W,addAnugaStructure:function(){return{type:W}},ADD_ANUGA_MESH_REGION:V,addAnugaMeshRegion:function(){return{type:V}},ADD_ANUGA_FULL_MESH:x,addAnugaFullMesh:function(){return{type:x}},ADD_NETWORK:K,addNetwork:function(){return{type:K}},ADD_LUMPED_CATCHMENT:B,addCatchment:function(){return{type:B}},ADD_NODES:Y,addNodes:function(){return{type:Y}},ADD_LINKS:Z,addLinks:function(){return{type:Z}},ADD_COMPARISON:J,addComparison:function(){return{type:J}},SET_ADD_ANUGA_ELEVATION_DATA:Q,setAddAnugaElevation:function(t){return{type:Q,visible:t}},CREATE_ANUGA_ELEVATION_FROM_LAYER:$,createAnugaElevationFromLayer:function(t,n){return{type:$,pk:t,title:n}},SAVE_ANUGA_SCENARIO:rt,saveAnugaScenario:function(t){return{type:rt,scenario:t}},ADD_ANUGA_SCENARIO:q,addAnugaScenario:function(){return{type:q}},SAVE_ANUGA_SCENARIO_SUCCESS:at,saveAnugaScenarioSuccess:function(t){return function(n){n({type:u,title:"Success",autoDismiss:6,position:"tc",message:"Scenario ID: ".concat(t.id," building"),uid:i(),level:"success"}),n({type:at,scenario:t})}},SAVE_ANUGA_SCENARIO_ERROR:ot,saveAnugaScenarioError:function(t){return function(n){n({type:u,title:"Error",autoDismiss:60,position:"tc",message:"Error saving scenario: ".concat(JSON.stringify(null==t?void 0:t.data)),uid:i(),level:"error"}),n({type:ot,error:t})}},DELETE_ANUGA_SCENARIO:ut,deleteAnugaScenario:function(t){return{type:ut,scenario:t}},DELETE_ANUGA_SCENARIO_SUCCESS:"DELETE_ANUGA_SCENARIO_SUCCESS",deleteAnugaScenarioSuccess:function(t){return function(n){n({type:u,title:"Success",autoDismiss:6,position:"tc",message:"Scenario ID: ".concat(t.id," deleted"),uid:i(),level:"info"}),n({type:l})}},RUN_ANUGA_SCENARIO:X,runAnugaScenario:function(t,n){return{type:X,scenario:t,computeInstanceId:n}},RUN_ANUGA_SCENARIO_SUCCESS:tt,runAnugaScenarioSuccess:function(t){return function(n){n({type:u,title:"Success",autoDismiss:6,position:"tc",message:"Scenario running",uid:i(),level:"success"}),n({type:tt,scenario:t})}},SET_NETWORK_MENU:A,setNetworkMenu:function(t){return{type:A,visible:t}},RUN_NETWORK:nt,runNetwork:function(t){return{type:nt,network:t}},RUN_NETWORK_SUCCESS:et,runNetworkSuccess:function(t){return function(n){n({type:u,title:"Success",autoDismiss:6,position:"tc",message:"Network Calculated",uid:i(),level:"success"}),n({type:et,network:t})}},UPDATE_NETWORK:Nt,updateNetwork:function(t,n){return{type:Nt,network:a(a({},t),n)}},UPDATE_ANUGA_SCENARIO:gt,updateAnugaScenario:function(t,n){return{type:gt,scenario:a(a({},t),n)}},SELECT_ANUGA_SCENARIO:St,selectAnugaScenario:function(t){return{type:St,scenario:t}},SHOW_ANUGA_SCENARIO_LOG:it,showAnugaScenarioLog:function(t){return{type:it,scenarioId:t}},SHOW_ANUGA_RUN_MENU:lt,showAnugaRunMenu:function(t){return{type:lt,visible:t}},START_ANUGA_SCENARIO_POLLING:ct,startAnugaScenarioPolling:function(){return{type:ct}},STOP_ANUGA_SCENARIO_POLLING:st,stopAnugaScenarioPolling:function(){return{type:st}},START_ANUGA_ELEVATION_POLLING:dt,startAnugaElevationPolling:function(){return{type:dt}},STOP_ANUGA_ELEVATION_POLLING:At,stopAnugaElevationPolling:function(){return{type:At}},START_ANUGA_MODEL_CREATION_POLLING:ft,startAnugaModelCreationPolling:function(){return{type:ft}},STOP_ANUGA_MODEL_CREATION_POLLING:_t,stopAnugaModelCreationPolling:function(){return{type:_t}},START_COMPARISON_POLLING:vt,startComparisonPolling:function(){return{type:vt}},STOP_COMPARISON_POLLING:pt,stopComparisonPolling:function(){return{type:pt}},SET_COMPARISON_DATA:Et,setComparisonData:function(t){return{type:Et,data:t}},SET_ANUGA_POLLING_DATA:Ot,setAnugaPollingData:function(t){return{type:Ot,scenarios:t}},SET_CREATING_ANUGA_LAYER:bt,setCreatingAnugaLayer:function(t){return{type:bt,isCreatingAnugaLayer:t}},SET_ANUGA_SCENARIO_IS_LOADED:Tt,setAnugaScenarioResultsLoaded:function(t,n){return{type:Tt,scenarioId:t,isLoaded:n}},CANCEL_ANUGA_RUN:yt,cancelAnugaRun:function(t,n){return{type:yt,scenario:t,computeInstanceId:n}},UPDATE_COMPUTE_INSTANCE:Ut,updateComputeInstance:function(){return{type:Ut}},UPDATE_COMPUTE_INSTANCE_SUCCESS:Rt,updateComputeInstanceSuccess:function(t){return{type:Rt,data:t}},TOGGLE_SCENARIO_SELECTED:Dt,toggleScenarioSelected:function(t){return{type:Dt,scenario:t}},SHOW_MANAGE_ACCOUNT:It,showManageAccount:function(t){return{type:It,visible:t}},COMPARE_SCENARIOS:ht,compareScenarios:function(t){return{type:ht,scenarios:t}},COMPARE_SCENARIOS_SUCCESS:mt,compareScenariosSuccess:function(t){return function(n){n({type:u,title:"Success",autoDismiss:6,position:"tc",message:"Scenario comparison started",uid:i(),level:"success"}),n({type:mt,scenarios:t})}},UPDATE_ANUGA_RESOURCES:Ct,updateAnugaResources:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return{type:Ct,action:t,pageSize:n}},SET_ANUGA_RESOURCES:Mt,setAnugaResources:function(t){return{type:Mt,data:t}}}},300806:(t,n,e)=>{"use strict";e.d(n,{gE:()=>S,GM:()=>b,z1:()=>T,Z6:()=>y,Zu:()=>U,Rf:()=>R,F7:()=>D,EE:()=>I,ax:()=>h,b2:()=>m,sW:()=>C,Ye:()=>M,dd:()=>w,rJ:()=>P,As:()=>G,lA:()=>L,T9:()=>j,QH:()=>k,XO:()=>H,Qc:()=>F,Ok:()=>W,AC:()=>x,Xv:()=>V,yN:()=>K,oq:()=>B,Qy:()=>Y,BA:()=>Z,Og:()=>J,h2:()=>z,bp:()=>$,d:()=>Q,E_:()=>q,YL:()=>X,o$:()=>tt,HQ:()=>nt});var r=e(49977),a=e.n(r),o=e(375875),u=e.n(o),i=e(580416),l=e(197395),c=e(801550),s=e(73443),d=e(433528),A=e(368658),f=e(351288),_=e(926036),v=e(643892),p=e(55035);function E(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function O(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?E(Object(e),!0).forEach((function(n){g(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):E(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function g(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var N=function(t,n){var e;if(0===(null===(e=t.data)||void 0===e?void 0:e.length))return a().Observable.empty();var r=[(0,A.initAnuga)(),(0,A.setCreatingAnugaLayer)(!1)];return t.data.map((function(t){0===n.getState().layers.flat.filter((function(n){return n.name===(null==t?void 0:t.name)})).length&&(r.unshift((0,i.A4)(t)),r.push((0,l.show)({message:"New layers added... You should save your project.",title:"Layers added",uid:1e3,position:"tc"})))})),a().Observable.from(r)},S=function(t,n){return t.ofType(A.INIT_ANUGA,f.UPDATE_DATASET_TITLE_SUCCESS).filter((function(){var t;return null===(t=n.getState())||void 0===t?void 0:t.gnresource.id})).switchMap((function(){var t;return a().Observable.from(u().post("/anuga/api/project/get_project_from_map_id/",{mapId:null===(t=n.getState())||void 0===t?void 0:t.gnresource.id}).catch((function(t){return console.log("**",t),"error"}))).filter((function(t){return(null==t?void 0:t.status)<=400})).filter((function(){var t,e;return!(null===(t=n.getState())||void 0===t||null===(e=t.security)||void 0===e||!e.user)})).switchMap((function(t){return a().Observable.from(u().get("/anuga/api/project/".concat(t.data.projectId,"/"))).switchMap((function(n){var e;return a().Observable.of((0,A.setAnugaProjectData)(n.data)).concat(a().Observable.of((0,f.setSvConfig)(null===(e=n.data)||void 0===e?void 0:e.simple_view_config)),a().Observable.from(u().get("/anuga/api/".concat(t.data.projectId,"/scenario/"))).switchMap((function(t){return a().Observable.of((0,A.setAnugaScenarioData)(t.data))})),a().Observable.from(u().get("/anuga/api/".concat(t.data.projectId,"/boundary/"))).switchMap((function(t){return a().Observable.of((0,A.setAnugaBoundaryData)(t.data))})),a().Observable.from(u().get("/anuga/api/".concat(t.data.projectId,"/elevation/"))).switchMap((function(t){return a().Observable.of((0,A.setAnugaElevationData)(t.data))})),a().Observable.from(u().get("/anuga/api/".concat(t.data.projectId,"/inflow/"))).switchMap((function(t){return a().Observable.of((0,A.setAnugaInflowData)(t.data))})),a().Observable.from(u().get("/anuga/api/".concat(t.data.projectId,"/structure/"))).switchMap((function(t){return a().Observable.of((0,A.setAnugaStructureData)(t.data))})),a().Observable.from(u().get("/anuga/api/".concat(t.data.projectId,"/friction/"))).switchMap((function(t){return a().Observable.of((0,A.setAnugaFrictionData)(t.data))})),a().Observable.from(u().get("/anuga/api/".concat(t.data.projectId,"/full-mesh/"))).switchMap((function(t){return a().Observable.of((0,A.setAnugaFullMeshData)(t.data))})),a().Observable.from(u().get("/anuga/api/".concat(t.data.projectId,"/mesh-region/"))).switchMap((function(t){return a().Observable.of((0,A.setAnugaMeshRegionData)(t.data))})),a().Observable.from(u().get("/anuga/api/".concat(t.data.projectId,"/network/"))).switchMap((function(t){return a().Observable.of((0,A.setNetworkData)(t.data))})),a().Observable.from(u().get("/anuga/api/".concat(t.data.projectId,"/catchment/"))).switchMap((function(t){return a().Observable.of((0,A.setCatchmentData)(t.data))})),a().Observable.from(u().get("/anuga/api/".concat(t.data.projectId,"/nodes/"))).switchMap((function(t){return a().Observable.of((0,A.setAnugaNodesData)(t.data))})),a().Observable.from(u().get("/anuga/api/".concat(t.data.projectId,"/links/"))).switchMap((function(t){return a().Observable.of((0,A.setAnugaLinksData)(t.data))})),a().Observable.from(u().get("/anuga/api/".concat(t.data.projectId,"/comparison/"))).switchMap((function(t){return a().Observable.of((0,A.setComparisonData)(t.data))})),a().Observable.from(u().get("/anuga/api/".concat(t.data.projectId,"/publication/"))).switchMap((function(t){return a().Observable.of((0,A.setPublicationData)(t.data))})),a().Observable.of((0,A.startAnugaScenarioPolling)()))})).filter((function(t){return t}))}))})).filter((function(t){return t}))},b=function(t){return t.ofType(A.START_ANUGA_MODEL_CREATION_POLLING).switchMap((function(){return a().Observable.timer(0,1e4).takeUntil(t.ofType(A.STOP_ANUGA_MODEL_CREATION_POLLING)).switchMap((function(){return a().Observable.concat(a().Observable.of((0,A.addAnugaBoundary)()),a().Observable.of((0,A.addAnugaFriction)()),a().Observable.of((0,A.addAnugaStructure)()),a().Observable.of((0,A.addAnugaInflow)()),a().Observable.of((0,A.addAnugaFullMesh)()),a().Observable.of((0,A.addAnugaMeshRegion)()),a().Observable.of((0,A.addNetwork)()),a().Observable.of((0,A.addCatchment)()),a().Observable.of((0,A.addNodes)()),a().Observable.of((0,A.addLinks)()))}))}))},T=function(t,n){return t.ofType(A.START_ANUGA_ELEVATION_POLLING).switchMap((function(){return a().Observable.timer(0,6e3).takeUntil(t.ofType(A.STOP_ANUGA_ELEVATION_POLLING)).switchMap((function(){var t,e,r;return a().Observable.from(u().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/elevation/available/"))).catch((function(t){return t}))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){var e,r,o,u,l,d,_,v,p,E;return(null===(e=t.data)||void 0===e?void 0:e.length)<2?a().Observable.empty():a().Observable.concat(a().Observable.of((0,A.stopAnugaElevationPolling)()),a().Observable.of((function(){var t,e,r,a=(null===(t=n.getState())||void 0===t||null===(e=t.layers)||void 0===e||null===(r=e.flat)||void 0===r?void 0:r.filter((function(t){return"wms"===t.type&&"background"!==t.group})))||[];return(0,i.oZ)(a)})),a().Observable.of((0,i.A4)(t.data[0])),a().Observable.of((0,i.A4)(null===(r=t.data)||void 0===r?void 0:r[1])),a().Observable.of((0,c.Px)(null===(o=t.data[0])||void 0===o||null===(u=o.bbox)||void 0===u?void 0:u.bounds,null===(l=t.data[0])||void 0===l||null===(d=l.bbox)||void 0===d?void 0:d.crs,20)),a().Observable.of((0,f.updateUploadStatus)("Complete")),a().Observable.of((0,s.nY)()),a().Observable.of((0,A.initAnuga)()),a().Observable.of((0,A.startAnugaModelCreationPolling)()),a().Observable.of((function(){var t,e,r,a=(null===(t=n.getState())||void 0===t||null===(e=t.layers)||void 0===e||null===(r=e.flat)||void 0===r?void 0:r.filter((function(t){return"wms"===t.type&&"background"!==t.group})))||[];return(0,i.oZ)(a)})),a().Observable.of((0,i.Dv)("Input Data.Elevations","Input Data",null===(_=n.getState())||void 0===_||null===(v=_.layers.groups.filter((function(t){return"Input Data"===t.id})))||void 0===v||null===(p=v[0])||void 0===p||null===(E=p.nodes)||void 0===E?void 0:E.length)))}))}))},y=function(t,n){return t.ofType(A.START_ANUGA_SCENARIO_POLLING).switchMap((function(){return a().Observable.timer(0,8e3).takeUntil(t.ofType(A.STOP_ANUGA_SCENARIO_POLLING)).switchMap((function(){var t,e,r;return a().Observable.from(u().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/scenario/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return a().Observable.of((0,A.setAnugaPollingData)(t.data)).switchMap((function(t){var e,r,o,u,l,c,s,d,f,_,v,p,E,O,g,N,S,b,T,y,U,R,D,I,h,m,C,M,w,P,G,L=(null===(e=t.scenarios)||void 0===e?void 0:e.filter((function(t){var n;return"complete"===(null===(n=t.latest_run)||void 0===n?void 0:n.status)}))).filter((function(t){var e,r,a;return null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.scenarios)||void 0===a?void 0:a.filter((function(e){var r,a,o,u,i,l,c,s,d,A,f,_=(null==e?void 0:e.id)===t.id,v=!e.isLoaded,p=(r=e,d=null==(a=n.getState())||null===(o=a.layers)||void 0===o||null===(u=o.flat)||void 0===u?void 0:u.filter((function(t){var n,e;return t.name===(null==r||null===(n=r.latest_run)||void 0===n||null===(e=n.gn_layer_depth_max)||void 0===e?void 0:e.name)})),A=null==a||null===(i=a.layers)||void 0===i||null===(l=i.flat)||void 0===l?void 0:l.filter((function(t){var n,e;return t.name===(null==r||null===(n=r.latest_run)||void 0===n||null===(e=n.gn_layer_depth_integrated_velocity_max)||void 0===e?void 0:e.name)})),f=null==a||null===(c=a.layers)||void 0===c||null===(s=c.flat)||void 0===s?void 0:s.filter((function(t){var n,e;return t.name===(null==r||null===(n=r.latest_run)||void 0===n||null===(e=n.gn_layer_velocity_max)||void 0===e?void 0:e.name)})),!(null!=d&&d.length&&null!=A&&A.length&&null!=f&&f.length));return _&&v&&p?t:null}))[0]}))[0],j=null===(r=n.getState())||void 0===r||null===(o=r.layers)||void 0===o||null===(u=o.flat)||void 0===u?void 0:u.map((function(t){return null==t?void 0:t.name})),k=(null===(l=n.getState())||void 0===l||null===(c=l.layers)||void 0===c||null===(s=c.flat)||void 0===s?void 0:s.filter((function(t){return"wms"===(null==t?void 0:t.type)&&"background"!==(null==t?void 0:t.group)})))||[],H=[null==L||null===(d=L.latest_run)||void 0===d||null===(f=d.gn_layer_depth_integrated_velocity_max)||void 0===f?void 0:f.title,null==L||null===(_=L.latest_run)||void 0===_||null===(v=_.gn_layer_depth_max)||void 0===v?void 0:v.title,null==L||null===(p=L.latest_run)||void 0===p||null===(E=p.gn_layer_velocity_max)||void 0===E?void 0:E.title],F=null===(O=n.getState())||void 0===O||null===(g=O.layers)||void 0===g||null===(N=g.flat)||void 0===N?void 0:N.filter((function(t){return H.includes(null==t?void 0:t.title)}));return console.log("remove these existingResultLayers:",F),L&&null!=L&&null!==(S=L.latest_run)&&void 0!==S&&null!==(b=S.gn_layer_depth_integrated_velocity_max)&&void 0!==b&&b.catalogURL&&null!=L&&null!==(T=L.latest_run)&&void 0!==T&&null!==(y=T.gn_layer_depth_max)&&void 0!==y&&y.catalogURL&&null!=L&&null!==(U=L.latest_run)&&void 0!==U&&null!==(R=U.gn_layer_velocity_max)&&void 0!==R&&R.catalogURL&&!j.includes(null==L||null===(D=L.latest_run)||void 0===D||null===(I=D.gn_layer_depth_integrated_velocity_max)||void 0===I?void 0:I.name)&&!j.includes(null==L||null===(h=L.latest_run)||void 0===h||null===(m=h.gn_layer_depth_max)||void 0===m?void 0:m.name)&&!j.includes(null==L||null===(C=L.latest_run)||void 0===C||null===(M=C.gn_layer_velocity_max)||void 0===M?void 0:M.name)?a().Observable.concat(a().Observable.of((0,i.$o)(null==F||null===(w=F[0])||void 0===w?void 0:w.id)),a().Observable.of((0,i.$o)(null==F||null===(P=F[1])||void 0===P?void 0:P.id)),a().Observable.of((0,i.$o)(null==F||null===(G=F[2])||void 0===G?void 0:G.id)),a().Observable.of((0,A.setAnugaPollingData)(t.scenarios)),a().Observable.of((0,i.A4)(L.latest_run.gn_layer_depth_integrated_velocity_max)),a().Observable.of((0,i.A4)(L.latest_run.gn_layer_depth_max)),a().Observable.of((0,i.A4)(L.latest_run.gn_layer_velocity_max)),a().Observable.of((0,A.setAnugaScenarioResultsLoaded)(null==L?void 0:L.id,!0)),a().Observable.of((0,i.oZ)(k))):a().Observable.of((0,A.setAnugaPollingData)(t.scenarios))}))}))}))}))},U=function(t,n){return t.ofType(A.DELETE_ANUGA_SCENARIO).concatMap((function(t){var e,r,o;return a().Observable.from(u().delete("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.projectData)||void 0===o?void 0:o.id,"/scenario/").concat(t.scenario.id,"/")))})).concatMap((function(t){return a().Observable.of((0,A.deleteAnugaScenarioSuccess)(t.data))}))},R=function(t,n){return t.ofType(A.RUN_ANUGA_SCENARIO).concatMap((function(t){var e,r,o;return a().Observable.from(u().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.projectData)||void 0===o?void 0:o.id,"/scenario/").concat(t.scenario.id,"/run/"),t).then((function(t){return(0,A.runAnugaScenarioSuccess)(t.data)})))})).concatMap((function(){return a().Observable.of((0,A.setAnugaScenarioMenu)(!0))}))},D=function(t,n){return t.ofType(A.CANCEL_ANUGA_RUN).concatMap((function(t){var e,r,o;return a().Observable.from(u().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.projectData)||void 0===o?void 0:o.id,"/scenario/").concat(t.scenario.id,"/run/"),t))})).concatMap((function(t){var e,r,o;return a().Observable.from(u().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.projectData)||void 0===o?void 0:o.id,"/scenario/").concat(t.scenario.id,"/cancel/"),{runId:t.scenario.latest_run.id}))})).concatMap((function(){return a().Observable.of((0,l.show)({message:"cancelling..."},"warning"))}))},I=function(t,n){return t.ofType(A.SAVE_ANUGA_SCENARIO).switchMap((function(t){var e,r,o,i,l,c;return t.scenario.log=t.scenario.log||"anuga log",t.scenario.id?a().Observable.from(u().put("/anuga/api/".concat(null===(i=n.getState())||void 0===i||null===(l=i.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,"/scenario/").concat(t.scenario.id,"/"),t.scenario).then((function(t){return(0,A.saveAnugaScenarioSuccess)(t.data)})).catch((function(t){return(0,A.saveAnugaScenarioError)(t)}))):a().Observable.from(u().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.projectData)||void 0===o?void 0:o.id,"/scenario/"),t.scenario).then((function(t){return(0,A.saveAnugaScenarioSuccess)(t.data)})).catch((function(t){return(0,A.saveAnugaScenarioError)(t)})))}))},h=function(t,n){return t.ofType(A.COMPARE_SCENARIOS).concatMap((function(t){var e,r,o;return a().Observable.from(u().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.projectData)||void 0===o?void 0:o.id,"/scenario/compare/"),t.scenarios).then((function(t){return(0,A.compareScenariosSuccess)(t.data)})))}))},m=function(t,n){return t.ofType(f.SET_OPEN_MENU_GROUP_ID).filter((function(t){return"Results"===(null==t?void 0:t.openMenuGroupId)})).switchMap((function(){return a().Observable.timer(0,1e4).takeUntil(t.ofType(A.STOP_COMPARISON_POLLING)).switchMap((function(){return a().Observable.concat(a().Observable.of((0,A.addComparison)()))}))}))},C=function(t,n){return t.ofType(A.RUN_NETWORK).concatMap((function(t){var e,r,o;return a().Observable.from(u().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.projectData)||void 0===o?void 0:o.id,"/network/").concat(t.network.id,"/run/"),t.network).then((function(t){return(0,A.runNetworkSuccess)(t.data)})))})).concatMap((function(){return a().Observable.of((0,A.setNetworkMenu)(!0))}))},M=function(t,n){return t.ofType(A.CREATE_ANUGA_BOUNDARY).switchMap((function(t){var e,r,o,i,l,c;return a().Observable.from(u().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.projectData)||void 0===o?void 0:o.id,"/boundary/"),{project:null===(i=n.getState())||void 0===i||null===(l=i.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.boundaryTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return a().Observable.of((0,A.addAnugaBoundary)())}))},w=function(t,n){return t.ofType(A.ADD_ANUGA_BOUNDARY).switchMap((function(){var t,e,r;return a().Observable.from(u().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/boundary/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return N(t,n)}))}))},P=function(t,n){return t.ofType(A.ADD_COMPARISON).switchMap((function(){var t,e,r;return a().Observable.from(u().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/comparison/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return N(t,n)}))}))},G=function(t,n){return t.ofType(A.CREATE_ANUGA_FRICTION).switchMap((function(t){var e,r,o,i,l,c;return a().Observable.from(u().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.projectData)||void 0===o?void 0:o.id,"/friction/"),{project:null===(i=n.getState())||void 0===i||null===(l=i.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.frictionTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return a().Observable.of((0,A.addAnugaFriction)())}))},L=function(t,n){return t.ofType(A.ADD_ANUGA_FRICTION).switchMap((function(){var t,e,r;return a().Observable.from(u().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/friction/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return N(t,n)}))}))},j=function(t,n){return t.ofType(A.CREATE_ANUGA_INFLOW).switchMap((function(t){var e,r,o,i,l,c;return a().Observable.from(u().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.projectData)||void 0===o?void 0:o.id,"/inflow/"),{project:null===(i=n.getState())||void 0===i||null===(l=i.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.inflowTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return a().Observable.of((0,A.addAnugaInflow)())}))},k=function(t,n){return t.ofType(A.ADD_ANUGA_INFLOW).switchMap((function(){var t,e,r;return a().Observable.from(u().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/inflow/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return N(t,n)}))}))},H=function(t,n){return t.ofType(A.CREATE_ANUGA_STRUCTURE).switchMap((function(t){var e,r,o,i,l,c;return a().Observable.from(u().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.projectData)||void 0===o?void 0:o.id,"/structure/"),{project:null===(i=n.getState())||void 0===i||null===(l=i.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.structureTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return a().Observable.of((0,A.addAnugaStructure)())}))},F=function(t,n){return t.ofType(A.ADD_ANUGA_STRUCTURE).switchMap((function(){var t,e,r;return a().Observable.from(u().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/structure/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return N(t,n)}))}))},W=function(t,n){return t.ofType(A.ADD_ANUGA_FULL_MESH).switchMap((function(){var t,e,r;return a().Observable.from(u().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/full-mesh/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return N(t,n)}))}))},x=function(t,n){return t.ofType(A.ADD_ANUGA_MESH_REGION).switchMap((function(){var t,e,r;return a().Observable.from(u().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/mesh-region/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return N(t,n)}))}))},V=function(t,n){return t.ofType(A.ADD_LUMPED_CATCHMENT).switchMap((function(){var t,e,r;return a().Observable.from(u().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/catchment/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return N(t,n)}))}))},K=function(t,n){return t.ofType(A.ADD_NODES).switchMap((function(){var t,e,r;return a().Observable.from(u().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/nodes/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return N(t,n)}))}))},B=function(t,n){return t.ofType(A.ADD_LINKS).switchMap((function(){var t,e,r;return a().Observable.from(u().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/links/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return N(t,n)}))}))},Y=function(t,n){return t.ofType(A.CREATE_ANUGA_MESH_REGION).switchMap((function(t){var e,r,o,i,l,c;return a().Observable.from(u().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.projectData)||void 0===o?void 0:o.id,"/mesh-region/"),{project:null===(i=n.getState())||void 0===i||null===(l=i.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.meshRegionTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return a().Observable.of((0,A.addAnugaMeshRegion)())}))},Z=function(t,n){return t.ofType(A.CREATE_NETWORK).switchMap((function(t){var e,r,o,i,l,c;return a().Observable.from(u().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.projectData)||void 0===o?void 0:o.id,"/network/"),{project:null===(i=n.getState())||void 0===i||null===(l=i.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.networkTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return a().Observable.of((0,A.addNetwork)())}))},J=function(t,n){return t.ofType(A.CREATE_FIGURE).switchMap((function(t){var e,r,o;return a().Observable.from(u().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.projectData)||void 0===o?void 0:o.id,"/publication/").concat(t.publicationId,"/create-figure/"),{title:t.figureTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){var n;return console.log("response1:",t),window.open(null==t||null===(n=t.data)||void 0===n?void 0:n.detail_url,"_blank").focus(),a().Observable.of((0,A.initAnuga)())}))},z=function(t,n){return t.ofType(A.CREATE_LUMPED_CATCHMENT).switchMap((function(t){var e,r,o,i,l,c;return a().Observable.from(u().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.projectData)||void 0===o?void 0:o.id,"/catchment/"),{project:null===(i=n.getState())||void 0===i||null===(l=i.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.catchmentTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return a().Observable.of((0,A.addCatchment)())}))},$=function(t,n){return t.ofType(A.CREATE_NODES).switchMap((function(t){var e,r,o,i,l,c;return a().Observable.from(u().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.projectData)||void 0===o?void 0:o.id,"/nodes/"),{project:null===(i=n.getState())||void 0===i||null===(l=i.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.nodesTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return a().Observable.of((0,A.addNodes)())}))},Q=function(t,n){return t.ofType(A.CREATE_LINKS).switchMap((function(t){var e,r,o,i,l,c;return a().Observable.from(u().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.projectData)||void 0===o?void 0:o.id,"/links/"),{project:null===(i=n.getState())||void 0===i||null===(l=i.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.linksTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return a().Observable.of((0,A.addLinks)())}))},q=function(t,n){return t.ofType(A.UPDATE_COMPUTE_INSTANCE).switchMap((function(){var t,e,r;return a().Observable.from(u().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/compute-instance/"))).switchMap((function(t){return a().Observable.of((0,A.updateComputeInstanceSuccess)(t.data))}))}))},X=function(t,n){return t.ofType(d.IN).concatMap((function(t){return a().Observable.of(t)})).filter((function(){return["geonode:bdy_","geonode:inf_","geonode:str_","geonode:fri_","geonode:mes_"].some((function(t){var e,r;return null===(e=n.getState())||void 0===e||null===(r=e.featuregrid)||void 0===r?void 0:r.selectedLayer.includes(t)}))})).concatMap((function(t){var e,r,o,u,i;return null!=t&&null!==(e=t.features)&&void 0!==e&&e[0]&&(null===(r=Object.keys(null==t||null===(o=t.features)||void 0===o?void 0:o[0]))||void 0===r?void 0:r.length)>0?a().Observable.empty():(t.features[0].properties={"geonode:bdy_":{location:"External",boundary:"Dirichlet"},"geonode:inf_":{type:"Rainfall",data:100},"geonode:str_":{method:"Holes"},"geonode:fri_":{manning:.035},"geonode:mes_":{resolution:10}}[null===(u=n.getState())||void 0===u||null===(i=u.featuregrid)||void 0===i?void 0:i.selectedLayer.substring(0,12)],a().Observable.of(t))}))},tt=function(t,n){return t.ofType(f.UPDATE_DATASET_TITLE).switchMap((function(t){return a().Observable.from(u().get("/api/v2/datasets?search=".concat(t.datasetName.split("geonode:")[1],"&search_fields=name"))).switchMap((function(e){var r,o,i,l,c,s,d,A=parseInt(null==e||null===(r=e.data)||void 0===r||null===(o=r.datasets)||void 0===o||null===(i=o[0])||void 0===i?void 0:i.pk,10),f=null===(l=(0,_.Z7)(null==n?void 0:n.getState()).filter((function(t){return t.gn_layer===A})))||void 0===l?void 0:l[0];return a().Observable.from(u().patch("/anuga/api/".concat(null===(c=n.getState())||void 0===c||null===(s=c.anuga)||void 0===s||null===(d=s.projectData)||void 0===d?void 0:d.id,"/").concat(f.apiKey,"/").concat(f.id,"/"),{title:t.newTitle}))})).switchMap((function(){return a().Observable.empty()}))}))},nt=function(t,n){return n.getState,t.ofType(A.UPDATE_ANUGA_RESOURCES).switchMap((function(t){return t.action,a().Observable.defer((function(){return u().get((0,p.zL)("/api/v2/maps"),{params:{page_size:100,page:1}}).then((function(t){return t.data}))})).switchMap((function(t){var n;return a().Observable.of((0,A.setAnugaResources)(O(O({},t),{},{isNextPageAvailable:!(null==t||null===(n=t.links)||void 0===n||!n.next),isPreviousPageAvailable:!(null==t||!t.links.previous),loading:!1})))})).catch((function(t){return a().Observable.of((0,v.mN)(t.data||t.message),(0,A.setAnugaResources)({loading:!1}))})).startWith((0,A.setAnugaResources)({loading:!0}))}))}},375501:(t,n,e)=>{"use strict";e.d(n,{Z:()=>d});var r=e(368658),a=e(351288);function o(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return u(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?u(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function i(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function l(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?i(Object(e),!0).forEach((function(n){c(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):i(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function c(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var s={showAddAnugaElevationData:!1,visibleAnugaScenarioLogId:!1,scenarios:[]};const d=function(){var t,n,e,u,i,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,d=arguments.length>1?arguments[1]:void 0;switch(console.log("state ar: ",c),console.log("action ar: ",d),d.type){case r.SET_CREATING_ANUGA_LAYER:return l(l({},c),{},{isCreatingAnugaLayer:d.isCreatingAnugaLayer});case r.SET_ANUGA_RESOURCES:return l(l({},c),{},{anugaHomePageResources:d.data});case r.UPDATE_ANUGA_SCENARIO:return l(l({},c),{},{scenarios:c.scenarios.map((function(t){return t.id===d.scenario.id?(d.scenario.unsaved=!0,d.scenario):t}))});case r.UPDATE_NETWORK:return l(l({},c),{},{networks:c.networks.map((function(t){return t.id===d.network.id?(d.network.unsaved=!0,d.network):t}))});case r.TOGGLE_SCENARIO_SELECTED:return l(l({},c),{},{scenarios:c.scenarios.map((function(t){return t.id===d.scenario.id?(d.scenario.selected=!t.selected,d.scenario):t}))});case r.SET_ANUGA_POLLING_DATA:var A=c.scenarios.map((function(t){var n=d.scenarios.filter((function(n){return t.id===n.id}))[0];return t.latest_run=l({},null==n?void 0:n.latest_run),t.status=(null==n?void 0:n.status)||"unsaved",t.latest_run_is_valid=null==n?void 0:n.latest_run_is_valid,t})),f=null===(t=c.scenarios)||void 0===t?void 0:t.map((function(t){return null==t?void 0:t.id})),_=null===(n=d.scenarios)||void 0===n||null===(e=n.filter((function(t){return!f.includes(t.id)})))||void 0===e?void 0:e[0];return _&&(A=[].concat(o(A),[_])),l(l({},c),{},{scenarios:A,selectedScenario:d.scenarios.filter((function(t){return c.selectedScenarioId===t.id}))[0]});case r.ADD_ANUGA_SCENARIO:return l(l({},c),{},{scenarios:[].concat(o(c.scenarios),[{id:null,name:"",code:null,description:"",maximum_triangle_area:1e3,constant_rainfall:null,duration:null,status:"new",project:null==c||null===(u=c.projectData)||void 0===u?void 0:u.id,boundary:"",elevation:"",log:"log placeholder",unsaved:!1,selected:!1}])});case r.SET_ANUGA_SCENARIO_IS_LOADED:return l(l({},c),{},{scenarios:c.scenarios.map((function(t){return t.id===d.scenarioId?(t.isLoaded=d.isLoaded,t):t}))});case r.SHOW_ANUGA_SCENARIO_LOG:return l(l({},c),{},{visibleAnugaScenarioLogId:d.scenarioId});case r.SHOW_ANUGA_RUN_MENU:return l(l({},c),{},{visibleAnugaRunMenu:d.visible});case r.SAVE_ANUGA_SCENARIO_SUCCESS:return l(l({},c),{},{scenarios:c.scenarios.map((function(t){return t.id===d.scenario.id?(d.scenario.unsaved=!1,d.scenario):t.id?t:d.scenario}))});case r.SELECT_ANUGA_SCENARIO:return l(l({},c),{},{selectedScenarioId:d.scenario.id,selectedScenario:d.scenario});case r.SET_ANUGA_PROJECT_DATA:return l(l({},c),{},{projectData:d.data});case r.SET_ANUGA_SCENARIO_DATA:return 0===c.scenarios.length?l(l({},c),{},{scenarios:d.scenarios}):l(l({},c),{},{scenarios:null===(i=c.scenarios)||void 0===i?void 0:i.map((function(t){var n;return t.unsaved?l(l({},d.scenario),{},{unsaved:!0}):(null==t?void 0:t.id)===(null===(n=d.scenario)||void 0===n?void 0:n.id)?(d.scenario.unsaved=!1,d.scenario):t}))});case r.UPDATE_COMPUTE_INSTANCE_SUCCESS:return l(l({},c),{},{computeInstances:d.data});case r.SET_COMPARISON_DATA:return l(l({},c),{},{comparisons:d.data});case r.SET_ANUGA_INFLOW_DATA:return l(l({},c),{},{inflows:d.data});case r.SET_ANUGA_FRICTION_DATA:return l(l({},c),{},{frictions:d.data});case r.SET_ANUGA_STRUCTURE_DATA:return l(l({},c),{},{structures:d.data});case r.SET_ANUGA_BOUNDARY_DATA:return l(l({},c),{},{boundaries:d.data});case r.SET_ANUGA_ELEVATION_DATA:return l(l({},c),{},{elevations:d.data});case r.SET_ANUGA_FULL_MESH_DATA:return l(l({},c),{},{fullMeshes:d.data});case r.SET_ANUGA_MESH_REGION_DATA:return l(l({},c),{},{meshRegions:d.data});case r.SET_NETWORK_DATA:return l(l({},c),{},{networks:d.data});case r.SET_LUMPED_CATCHMENT_DATA:return l(l({},c),{},{catchments:d.data});case r.SET_ANUGA_NODES_DATA:return l(l({},c),{},{nodes:d.data});case r.SET_ANUGA_LINKS_DATA:return l(l({},c),{},{links:d.data});case r.SET_PUBLICATION_DATA:return l(l({},c),{},{publications:d.data});case a.SET_OPEN_MENU_GROUP_ID:return d.openMenuGroupId?l(l({},c),{},{showAnugaInputMenu:!1,showAnugaScenarioMenu:!1,showAnugaResultMenu:!1}):c;case r.SET_ANUGA_INPUT_MENU:return l(l({},c),{},{showAnugaInputMenu:d.visible,showAnugaScenarioMenu:!1,showAnugaResultMenu:!1,showNetworkMenu:!1,showReviewPanel:!1,showPublicationPanel:!1});case r.SET_ANUGA_SCENARIO_MENU:return l(l({},c),{},{showAnugaInputMenu:!1,showAnugaScenarioMenu:d.visible,showAnugaResultMenu:!1,showNetworkMenu:!1,showReviewPanel:!1,showPublicationPanel:!1});case r.SET_ANUGA_RESULT_MENU:return l(l({},c),{},{showAnugaScenarioMenu:!1,showAnugaInputMenu:!1,showAnugaResultMenu:d.visible,showNetworkMenu:!1,showReviewPanel:!1,showPublicationPanel:!1});case r.SET_NETWORK_MENU:return l(l({},c),{},{showAnugaInputMenu:!1,showAnugaScenarioMenu:!1,showAnugaResultMenu:!1,showNetworkMenu:d.visible,showReviewPanel:!1,showPublicationPanel:!1});case r.SET_REVIEW_PANEL:return l(l({},c),{},{showAnugaInputMenu:!1,showAnugaScenarioMenu:!1,showAnugaResultMenu:!1,showNetworkMenu:!1,showReviewPanel:d.visible,showPublicationPanel:!1});case r.SET_PUBLICATION_PANEL:return l(l({},c),{},{showAnugaInputMenu:!1,showAnugaScenarioMenu:!1,showAnugaResultMenu:!1,showNetworkMenu:!1,showReviewPanel:!1,showPublicationPanel:d.visible});default:return c}}},926036:(t,n,e)=>{"use strict";function r(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function a(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?r(Object(e),!0).forEach((function(n){o(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):r(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function o(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}e.d(n,{rP:()=>u,Dh:()=>i,mn:()=>l,Z7:()=>c});var u=function(t){var n,e,r,a,o,u,i=null==t||null===(n=t.security)||void 0===n||null===(e=n.user)||void 0===e?void 0:e.pk,l=null==t||null===(r=t.gnresource)||void 0===r||null===(a=r.compactPermissions)||void 0===a||null===(o=a.users)||void 0===o||null===(u=o.filter((function(t){return t.id===i}))[0])||void 0===u?void 0:u.permissions;return["view","edit","manage","owner"].includes(l)},i=function(t){var n,e,r,a,o,u,i=null==t||null===(n=t.security)||void 0===n||null===(e=n.user)||void 0===e?void 0:e.pk,l=null==t||null===(r=t.gnresource)||void 0===r||null===(a=r.compactPermissions)||void 0===a||null===(o=a.users)||void 0===o||null===(u=o.filter((function(t){return t.id===i}))[0])||void 0===u?void 0:u.permissions;return["edit","manage","owner"].includes(l)},l=function(t){var n;return null==t||null===(n=t.anuga)||void 0===n?void 0:n.scenarios.filter((function(t){return null==t?void 0:t.selected}))},c=function(t){var n={elevations:"elevation",boundaries:"boundary",frictions:"friction",inflows:"inflow",meshRegions:"mesh-region",structures:"structure",catchments:"catchment",nodes:"nodes",links:"links"},e=Array();return["elevations","boundaries","frictions","inflows","meshRegions","structures","catchments","nodes","links"].map((function(r){var o;null==t||null===(o=t.anuga)||void 0===o||o[r].map((function(t){e.push(a(a({},t),{},{apiKey:n[r]}))}))})),e}}}]);