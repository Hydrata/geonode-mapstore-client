(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[70082],{801550:(n,t,e)=>{"use strict";e.d(t,{pP:()=>r,TR:()=>o,N7:()=>a,mq:()=>i,uv:()=>u,Qy:()=>l,IL:()=>c,Li:()=>s,OW:()=>A,ZO:()=>d,Um:()=>f,TF:()=>_,Ls:()=>v,Ec:()=>p,Eu:()=>E,JJ:()=>S,nZ:()=>g,YD:()=>N,GI:()=>O,Jb:()=>T,Uh:()=>b,e$:()=>y,eh:()=>U,$j:()=>m,bJ:()=>R,Mk:()=>D,xy:()=>I,o6:()=>C,FP:()=>h,Mo:()=>M,sO:()=>w,Px:()=>P,hd:()=>G,Ju:()=>L,BV:()=>j,SO:()=>k,H0:()=>F,$X:()=>H,ou:()=>W,NE:()=>x,Lq:()=>V,aN:()=>K});var r="CHANGE_MAP_VIEW",o="CLICK_ON_MAP",a="CHANGE_MOUSE_POINTER",i="CHANGE_ZOOM_LVL",u="PAN_TO",l="ZOOM_TO_EXTENT",c="ZOOM_TO_POINT",s="CHANGE_MAP_CRS",A="CHANGE_MAP_SCALES",d="CHANGE_MAP_STYLE",f="CHANGE_ROTATION",_="CREATION_ERROR_LAYER",v="UPDATE_VERSION",p="INIT_MAP",E="RESIZE_MAP",S="CHANGE_MAP_LIMITS",g="SET_MAP_RESOLUTIONS",N="REGISTER_EVENT_LISTENER",O="UNREGISTER_EVENT_LISTENER",T="MOUSE_MOVE",b="MOUSE_OUT",y="MAP:MAP_PLUGIN_LOAD",U="MAP:ORIENTATION",m="MAP:UPDATE_MAP_VIEW",R="MAP:UPDATE_MAP_OPTIONS";function D(n,t,e,r){return{type:y,mapType:t,loading:n,loaded:e,error:r}}function I(n,t,e){return{type:c,pos:n,zoom:t,crs:e}}function C(n,t,e,o,a,i,u,l){return{type:r,center:n,zoom:t,bbox:e,size:o,mapStateSource:a,projection:i,viewerOptions:u,resolution:l}}function h(n,t){return{type:o,point:n,layer:t}}function M(n){return{type:a,pointer:n}}function w(n,t){return{type:i,zoom:n,mapStateSource:t}}function P(n,t,e,r){return{type:l,extent:n,crs:t,maxZoom:e,options:r}}function G(n,t){return{type:d,style:n,mapStateSource:t}}function L(){return{type:E}}function j(n){var t=n.restrictedExtent,e=n.crs,r=n.minZoom;return{type:S,restrictedExtent:t,crs:e,minZoom:r}}function k(n){return{type:g,resolutions:n}}var F=function(n,t){return{type:N,eventName:n,toolName:t}},H=function(n,t){return{type:O,eventName:n,toolName:t}},W=function(n){return{type:T,position:n}},x=function(){return{type:b}},V=function(n){return{type:U,orientation:n}},K=function(n){return{type:R,configUpdate:n}}},615402:(n,t,e)=>{"use strict";e.d(t,{Z:()=>E});var r=e(675263),o=e.n(r),a=e(124852),i=e.n(a);function u(n){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},u(n)}function l(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,_(r.key),r)}}function c(n,t,e){return t=A(t),function(n,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n)}(n,s()?Reflect.construct(t,e||[],A(n).constructor):t.apply(n,e))}function s(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(n){}return(s=function(){return!!n})()}function A(n){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},A(n)}function d(n,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,t){return n.__proto__=t,n},d(n,t)}function f(n,t,e){return(t=_(t))in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function _(n){var t=function(n,t){if("object"!=u(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var r=e.call(n,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==u(t)?t:t+""}var v=e(868195).FormattedHTMLMessage,p=function(n){function t(){return function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,t,arguments)}return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),t&&d(n,t)}(t,n),e=t,(r=[{key:"render",value:function(){return this.context.intl?i().createElement(v,{id:this.props.msgId,values:this.props.msgParams}):i().createElement("span",null,this.props.msgId||"")}}])&&l(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r}(i().Component);f(p,"propTypes",{msgId:o().string.isRequired,msgParams:o().object}),f(p,"contextTypes",{intl:o().object});const E=p},368658:(n,t,e)=>{function r(n){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},r(n)}function o(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function a(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?o(Object(e),!0).forEach((function(t){var o,a,i,u;o=n,a=t,i=e[t],u=function(n,t){if("object"!=r(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var o=e.call(n,"string");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(a),(a="symbol"==r(u)?u:u+"")in o?Object.defineProperty(o,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[a]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):o(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}var i=e(197395).SHOW_NOTIFICATION,u=e(423570),l="INIT_ANUGA",c="SET_ANUGA_INPUT_MENU",s="SET_ANUGA_SCENARIO_MENU",A="SET_ANUGA_RESULT_MENU",d="SET_NETWORK_MENU",f="SET_REVIEW_PANEL",_="SET_PUBLICATION_PANEL",v="SET_ANUGA_PROJECT_DATA",p="SET_ANUGA_SCENARIO_DATA",E="SET_ANUGA_BOUNDARY_DATA",S="SET_ANUGA_FRICTION_DATA",g="SET_ANUGA_INFLOW_DATA",N="SET_ANUGA_STRUCTURE_DATA",O="SET_ANUGA_FULL_MESH_DATA",T="SET_ANUGA_MESH_REGION_DATA",b="SET_NETWORK_DATA",y="SET_LUMPED_CATCHMENT_DATA",U="SET_ANUGA_NODES_DATA",m="SET_ANUGA_LINKS_DATA",R="SET_PUBLICATION_DATA",D="CREATE_ANUGA_BOUNDARY",I="CREATE_ANUGA_FRICTION",C="CREATE_ANUGA_INFLOW",h="CREATE_ANUGA_STRUCTURE",M="CREATE_ANUGA_MESH_REGION",w="CREATE_NETWORK",P="CREATE_LUMPED_CATCHMENT",G="CREATE_NODES",L="CREATE_LINKS",j="CREATE_FIGURE",k="ADD_ANUGA_BOUNDARY",F="ADD_ANUGA_FRICTION",H="ADD_ANUGA_INFLOW",W="ADD_ANUGA_STRUCTURE",x="ADD_ANUGA_FULL_MESH",V="ADD_ANUGA_MESH_REGION",K="ADD_ANUGA_NETWORK",B="ADD_LUMPED_CATCHMENT",Y="ADD_NODES",Z="ADD_LINKS",J="ADD_COMPARISON",$="SET_ANUGA_ELEVATION_DATA",z="CREATE_ANUGA_ELEVATION_FROM_LAYER",X="SET_ADD_ANUGA_ELEVATION_DATA",Q="ADD_ANUGA_SCENARIO",q="RUN_ANUGA_SCENARIO",nn="RUN_ANUGA_SCENARIO_SUCCESS",tn="RUN_NETWORK",en="RUN_NETWORK_SUCCESS",rn="SAVE_ANUGA_SCENARIO",on="SAVE_ANUGA_SCENARIO_SUCCESS",an="SAVE_ANUGA_SCENARIO_ERROR",un="DELETE_ANUGA_SCENARIO",ln="SHOW_ANUGA_SCENARIO_LOG",cn="SHOW_ANUGA_RUN_MENU",sn="START_ANUGA_SCENARIO_POLLING",An="STOP_ANUGA_SCENARIO_POLLING",dn="START_ANUGA_ELEVATION_POLLING",fn="STOP_ANUGA_ELEVATION_POLLING",_n="START_ANUGA_MODEL_CREATION_POLLING",vn="STOP_ANUGA_MODEL_CREATION_POLLING",pn="START_COMPARISON_POLLING",En="STOP_COMPARISON_POLLING",Sn="SET_COMPARISON_DATA",gn="SET_ANUGA_POLLING_DATA",Nn="UPDATE_ANUGA_SCENARIO",On="UPDATE_NETWORK",Tn="SELECT_ANUGA_SCENARIO",bn="SET_CREATING_ANUGA_LAYER",yn="SET_ANUGA_SCENARIO_IS_LOADED",Un="CANCEL_ANUGA_RUN",mn="UPDATE_COMPUTE_INSTANCE",Rn="UPDATE_COMPUTE_INSTANCE_SUCCESS",Dn="TOGGLE_SCENARIO_SELECTED",In="SHOW_MANAGE_ACCOUNT",Cn="COMPARE_SCENARIOS",hn="COMPARE_SCENARIOS_SUCCESS",Mn="UPDATE_ANUGA_RESOURCES",wn="SET_ANUGA_RESOURCES",Pn="FIX_ANUGA_GROUPS";n.exports={INIT_ANUGA:l,initAnuga:function(){return{type:l}},SET_ANUGA_INPUT_MENU:c,setAnugaInputMenu:function(n){return{type:c,visible:n}},SET_ANUGA_SCENARIO_MENU:s,setAnugaScenarioMenu:function(n){return{type:s,visible:n}},SET_ANUGA_RESULT_MENU:A,setAnugaResultMenu:function(n){return{type:A,visible:n}},SET_REVIEW_PANEL:f,setReviewPanel:function(n){return{type:f,visible:n}},SET_PUBLICATION_PANEL:_,setPublicationPanel:function(n){return{type:_,visible:n}},SET_ANUGA_PROJECT_DATA:v,setAnugaProjectData:function(n){return{type:v,data:n}},SET_ANUGA_SCENARIO_DATA:p,setAnugaScenarioData:function(n){return{type:p,scenarios:n}},SET_ANUGA_ELEVATION_DATA:$,setAnugaElevationData:function(n){return{type:$,data:n}},SET_ANUGA_BOUNDARY_DATA:E,setAnugaBoundaryData:function(n){return{type:E,data:n}},SET_ANUGA_FRICTION_DATA:S,setAnugaFrictionData:function(n){return{type:S,data:n}},SET_ANUGA_INFLOW_DATA:g,setAnugaInflowData:function(n){return{type:g,data:n}},SET_ANUGA_STRUCTURE_DATA:N,setAnugaStructureData:function(n){return{type:N,data:n}},SET_ANUGA_FULL_MESH_DATA:O,setAnugaFullMeshData:function(n){return{type:O,data:n}},SET_ANUGA_MESH_REGION_DATA:T,setAnugaMeshRegionData:function(n){return{type:T,data:n}},SET_NETWORK_DATA:b,setNetworkData:function(n){return{type:b,data:n}},SET_LUMPED_CATCHMENT_DATA:y,setCatchmentData:function(n){return{type:y,data:n}},SET_ANUGA_NODES_DATA:U,setAnugaNodesData:function(n){return{type:U,data:n}},SET_ANUGA_LINKS_DATA:m,setAnugaLinksData:function(n){return{type:m,data:n}},SET_PUBLICATION_DATA:R,setPublicationData:function(n){return{type:R,data:n}},CREATE_ANUGA_BOUNDARY:D,createAnugaBoundary:function(n){return{type:D,boundaryTitle:n}},CREATE_ANUGA_FRICTION:I,createAnugaFriction:function(n){return{type:I,frictionTitle:n}},CREATE_ANUGA_INFLOW:C,createAnugaInflow:function(n){return{type:C,inflowTitle:n}},CREATE_ANUGA_STRUCTURE:h,createAnugaStructure:function(n){return{type:h,structureTitle:n}},CREATE_ANUGA_MESH_REGION:M,createAnugaMeshRegion:function(n){return{type:M,meshRegionTitle:n}},CREATE_NETWORK:w,createNetwork:function(n){return{type:w,networkTitle:n}},CREATE_LUMPED_CATCHMENT:P,createCatchment:function(n){return{type:P,catchmentTitle:n}},CREATE_NODES:G,createNodes:function(n){return{type:G,nodesTitle:n}},CREATE_LINKS:L,createLinks:function(n){return{type:L,linksTitle:n}},CREATE_FIGURE:j,createFigure:function(n,t){return{type:j,figureTitle:n,publicationId:t}},ADD_ANUGA_BOUNDARY:k,addAnugaBoundary:function(){return{type:k}},ADD_ANUGA_FRICTION:F,addAnugaFriction:function(){return{type:F}},ADD_ANUGA_INFLOW:H,addAnugaInflow:function(){return{type:H}},ADD_ANUGA_STRUCTURE:W,addAnugaStructure:function(){return{type:W}},ADD_ANUGA_MESH_REGION:V,addAnugaMeshRegion:function(){return{type:V}},ADD_ANUGA_FULL_MESH:x,addAnugaFullMesh:function(){return{type:x}},ADD_NETWORK:K,addNetwork:function(){return{type:K}},ADD_LUMPED_CATCHMENT:B,addCatchment:function(){return{type:B}},ADD_NODES:Y,addNodes:function(){return{type:Y}},ADD_LINKS:Z,addLinks:function(){return{type:Z}},ADD_COMPARISON:J,addComparison:function(){return{type:J}},SET_ADD_ANUGA_ELEVATION_DATA:X,setAddAnugaElevation:function(n){return{type:X,visible:n}},CREATE_ANUGA_ELEVATION_FROM_LAYER:z,createAnugaElevationFromLayer:function(n,t){return{type:z,pk:n,title:t}},SAVE_ANUGA_SCENARIO:rn,saveAnugaScenario:function(n){return{type:rn,scenario:n}},ADD_ANUGA_SCENARIO:Q,addAnugaScenario:function(){return{type:Q}},SAVE_ANUGA_SCENARIO_SUCCESS:on,saveAnugaScenarioSuccess:function(n){return function(t){t({type:i,title:"Success",autoDismiss:6,position:"tc",message:"Scenario ID: ".concat(n.id," building"),uid:u(),level:"success"}),t({type:on,scenario:n})}},SAVE_ANUGA_SCENARIO_ERROR:an,saveAnugaScenarioError:function(n){return function(t){t({type:i,title:"Error",autoDismiss:60,position:"tc",message:"Error saving scenario: ".concat(JSON.stringify(null==n?void 0:n.data)),uid:u(),level:"error"}),t({type:an,error:n})}},DELETE_ANUGA_SCENARIO:un,deleteAnugaScenario:function(n){return{type:un,scenario:n}},DELETE_ANUGA_SCENARIO_SUCCESS:"DELETE_ANUGA_SCENARIO_SUCCESS",deleteAnugaScenarioSuccess:function(n){return function(t){t({type:i,title:"Success",autoDismiss:6,position:"tc",message:"Scenario ID: ".concat(n.id," deleted"),uid:u(),level:"info"}),t({type:l})}},RUN_ANUGA_SCENARIO:q,runAnugaScenario:function(n,t){return{type:q,scenario:n,computeInstanceId:t}},RUN_ANUGA_SCENARIO_SUCCESS:nn,runAnugaScenarioSuccess:function(n){return function(t){t({type:i,title:"Success",autoDismiss:6,position:"tc",message:"Scenario running",uid:u(),level:"success"}),t({type:nn,scenario:n})}},SET_NETWORK_MENU:d,setNetworkMenu:function(n){return{type:d,visible:n}},RUN_NETWORK:tn,runNetwork:function(n){return{type:tn,network:n}},RUN_NETWORK_SUCCESS:en,runNetworkSuccess:function(n){return function(t){t({type:i,title:"Success",autoDismiss:6,position:"tc",message:"Network Calculated",uid:u(),level:"success"}),t({type:en,network:n})}},UPDATE_NETWORK:On,updateNetwork:function(n,t){return{type:On,network:a(a({},n),t)}},UPDATE_ANUGA_SCENARIO:Nn,updateAnugaScenario:function(n,t){return{type:Nn,scenario:a(a({},n),t)}},SELECT_ANUGA_SCENARIO:Tn,selectAnugaScenario:function(n){return{type:Tn,scenario:n}},SHOW_ANUGA_SCENARIO_LOG:ln,showAnugaScenarioLog:function(n){return{type:ln,scenarioId:n}},SHOW_ANUGA_RUN_MENU:cn,showAnugaRunMenu:function(n){return{type:cn,visible:n}},START_ANUGA_SCENARIO_POLLING:sn,startAnugaScenarioPolling:function(){return{type:sn}},STOP_ANUGA_SCENARIO_POLLING:An,stopAnugaScenarioPolling:function(){return{type:An}},START_ANUGA_ELEVATION_POLLING:dn,startAnugaElevationPolling:function(){return{type:dn}},STOP_ANUGA_ELEVATION_POLLING:fn,stopAnugaElevationPolling:function(){return{type:fn}},START_ANUGA_MODEL_CREATION_POLLING:_n,startAnugaModelCreationPolling:function(){return{type:_n}},STOP_ANUGA_MODEL_CREATION_POLLING:vn,stopAnugaModelCreationPolling:function(){return{type:vn}},START_COMPARISON_POLLING:pn,startComparisonPolling:function(){return{type:pn}},STOP_COMPARISON_POLLING:En,stopComparisonPolling:function(){return{type:En}},SET_COMPARISON_DATA:Sn,setComparisonData:function(n){return{type:Sn,data:n}},SET_ANUGA_POLLING_DATA:gn,setAnugaPollingData:function(n){return{type:gn,scenarios:n}},SET_CREATING_ANUGA_LAYER:bn,setCreatingAnugaLayer:function(n){return{type:bn,isCreatingAnugaLayer:n}},SET_ANUGA_SCENARIO_IS_LOADED:yn,setAnugaScenarioResultsLoaded:function(n,t){return{type:yn,scenarioId:n,isLoaded:t}},CANCEL_ANUGA_RUN:Un,cancelAnugaRun:function(n,t){return{type:Un,scenario:n,computeInstanceId:t}},UPDATE_COMPUTE_INSTANCE:mn,updateComputeInstance:function(){return{type:mn}},UPDATE_COMPUTE_INSTANCE_SUCCESS:Rn,updateComputeInstanceSuccess:function(n){return{type:Rn,data:n}},TOGGLE_SCENARIO_SELECTED:Dn,toggleScenarioSelected:function(n){return{type:Dn,scenario:n}},SHOW_MANAGE_ACCOUNT:In,showManageAccount:function(n){return{type:In,visible:n}},COMPARE_SCENARIOS:Cn,compareScenarios:function(n){return{type:Cn,scenarios:n}},COMPARE_SCENARIOS_SUCCESS:hn,compareScenariosSuccess:function(n){return function(t){t({type:i,title:"Success",autoDismiss:6,position:"tc",message:"Scenario comparison started",uid:u(),level:"success"}),t({type:hn,scenarios:n})}},UPDATE_ANUGA_RESOURCES:Mn,updateAnugaResources:function(n){return{type:Mn,action:n,pageSize:arguments.length>1&&void 0!==arguments[1]?arguments[1]:100}},SET_ANUGA_RESOURCES:wn,setAnugaResources:function(n){return{type:wn,data:n}},FIX_ANUGA_GROUPS:Pn,fixAnugaGroups:function(){return{type:Pn}}}},300806:(n,t,e)=>{"use strict";e.d(t,{gE:()=>O,GM:()=>T,z1:()=>b,Z6:()=>y,Zu:()=>U,Rf:()=>m,F7:()=>R,EE:()=>D,ax:()=>I,b2:()=>C,sW:()=>h,Ye:()=>M,dd:()=>w,rJ:()=>P,As:()=>G,lA:()=>L,T9:()=>j,QH:()=>k,XO:()=>F,Qc:()=>H,Ok:()=>W,AC:()=>x,Xv:()=>V,yN:()=>K,oq:()=>B,Qy:()=>Y,BA:()=>Z,Og:()=>J,h2:()=>$,bp:()=>z,d:()=>X,E_:()=>Q,YL:()=>q,o$:()=>nn,HQ:()=>tn});var r=e(49977),o=e.n(r),a=e(375875),i=e.n(a),u=e(580416),l=e(197395),c=e(801550),s=e(73443),A=e(433528),d=e(368658),f=e(351288),_=e(926036),v=e(643892),p=e(55035);function E(n){return function(n){if(Array.isArray(n))return S(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,t){if(n){if("string"==typeof n)return S(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);return"Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e?Array.from(n):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?S(n,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}var g=function(n,t){var e;if(0===(null===(e=n.data)||void 0===e?void 0:e.length))return o().Observable.empty();var r=[(0,d.initAnuga)(),(0,d.setCreatingAnugaLayer)(!1)];return n.data.map((function(n){0===t.getState().layers.flat.filter((function(t){return t.name===(null==n?void 0:n.name)})).length&&(r.unshift((0,u.A4)(n)),r.push((0,l.show)({message:"Adding new layers... You should save your project.",title:"New layers found",uid:1e3,position:"tc"})))})),o().Observable.from(r)},N=[{endpoint:"scenario",action:d.setAnugaScenarioData},{endpoint:"boundary",action:d.setAnugaBoundaryData},{endpoint:"elevation",action:d.setAnugaElevationData},{endpoint:"inflow",action:d.setAnugaInflowData},{endpoint:"structure",action:d.setAnugaStructureData},{endpoint:"friction",action:d.setAnugaFrictionData},{endpoint:"full-mesh",action:d.setAnugaFullMeshData},{endpoint:"mesh-region",action:d.setAnugaMeshRegionData},{endpoint:"network",action:d.setNetworkData},{endpoint:"catchment",action:d.setCatchmentData},{endpoint:"nodes",action:d.setAnugaNodesData},{endpoint:"links",action:d.setAnugaLinksData},{endpoint:"comparison",action:d.setComparisonData},{endpoint:"publication",action:d.setPublicationData}],O=function(n,t){return n.ofType(d.INIT_ANUGA,f.UPDATE_DATASET_TITLE_SUCCESS).filter((function(){return t.getState().gnresource.id})).switchMap((function(){return o().Observable.from(i().post("/anuga/api/project/get_project_from_map_id/",{mapId:t.getState().gnresource.id})).catch((function(n){return console.log("**",n),o().Observable.of("error")}))})).filter((function(n){return(null==n?void 0:n.status)<=400})).filter((function(){var n,e;return!(null===(n=t.getState())||void 0===n||null===(e=n.security)||void 0===e||!e.user)})).switchMap((function(n){return o().Observable.from(i().get("/anuga/api/project/".concat(n.data.projectId,"/"))).catch((function(n){return console.log("xx",n),o().Observable.of("error")})).switchMap((function(t){var e,r=n.data.projectId,a=N.map((function(n){var t=n.endpoint,e=n.action;return function(n,t){return o().Observable.from(i().get("/anuga/api/".concat(t,"/").concat(n,"/"))).catch((function(n){return console.error(n),o().Observable.of({data:{}})})).switchMap((function(n){return o().Observable.of(n.data)}))}(t,r).map(e)}));return o().Observable.of((0,d.setAnugaProjectData)(t.data),(0,d.fixAnugaGroups)(),(0,f.setSvConfig)(t.data.simple_view_config)).concat((e=o().Observable).merge.apply(e,E(a)),o().Observable.of((0,d.startAnugaScenarioPolling)()))}))}))},T=function(n){return n.ofType(d.START_ANUGA_MODEL_CREATION_POLLING).switchMap((function(){return o().Observable.timer(0,1e4).takeUntil(n.ofType(d.STOP_ANUGA_MODEL_CREATION_POLLING)).switchMap((function(){return o().Observable.concat(o().Observable.of((0,d.addAnugaBoundary)()),o().Observable.of((0,d.addAnugaFriction)()),o().Observable.of((0,d.addAnugaStructure)()),o().Observable.of((0,d.addAnugaInflow)()),o().Observable.of((0,d.addAnugaFullMesh)()),o().Observable.of((0,d.addAnugaMeshRegion)()),o().Observable.of((0,d.addNetwork)()),o().Observable.of((0,d.addCatchment)()),o().Observable.of((0,d.addNodes)()),o().Observable.of((0,d.addLinks)()))}))}))},b=function(n,t){return n.ofType(d.START_ANUGA_ELEVATION_POLLING).switchMap((function(){return o().Observable.timer(0,6e3).takeUntil(n.ofType(d.STOP_ANUGA_ELEVATION_POLLING)).switchMap((function(){var n,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(n=t.getState())||void 0===n||null===(e=n.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/elevation/available/"))).catch((function(n){return n}))})).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(n){var e,r,a,i,l,A,_,v,p,E;if((null===(e=n.data)||void 0===e?void 0:e.length)<2)return o().Observable.empty();var S=n.data[0],g=null===(r=n.data)||void 0===r?void 0:r[1];return o().Observable.concat(o().Observable.of((0,d.stopAnugaElevationPolling)()),o().Observable.of((function(){var n,e,r,o=(null===(n=t.getState())||void 0===n||null===(e=n.layers)||void 0===e||null===(r=e.flat)||void 0===r?void 0:r.filter((function(n){return"wms"===n.type&&"background"!==n.group})))||[];return(0,u.oZ)(o)})),o().Observable.of((0,u.A4)(S)),o().Observable.of((0,u.A4)(g)),o().Observable.of((0,c.Px)(null===(a=n.data[0])||void 0===a||null===(i=a.bbox)||void 0===i?void 0:i.bounds,null===(l=n.data[0])||void 0===l||null===(A=l.bbox)||void 0===A?void 0:A.crs,20)),o().Observable.of((0,f.updateUploadStatus)("Complete")),o().Observable.of((0,s.nY)()),o().Observable.of((0,d.initAnuga)()),o().Observable.of((0,d.startAnugaModelCreationPolling)()),o().Observable.of((function(){var n,e,r,o=(null===(n=t.getState())||void 0===n||null===(e=n.layers)||void 0===e||null===(r=e.flat)||void 0===r?void 0:r.filter((function(n){return"wms"===n.type&&"background"!==n.group})))||[];return(0,u.oZ)(o)})),o().Observable.of((0,u.Dv)("Input Data.Elevations","Input Data",null===(_=t.getState())||void 0===_||null===(v=_.layers.groups.filter((function(n){return"Input Data"===n.id})))||void 0===v||null===(p=v[0])||void 0===p||null===(E=p.nodes)||void 0===E?void 0:E.length)))}))}))},y=function(n,t){return n.ofType(d.START_ANUGA_SCENARIO_POLLING).switchMap((function(){return o().Observable.timer(0,8e3).takeUntil(n.ofType(d.STOP_ANUGA_SCENARIO_POLLING)).switchMap((function(){var n,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(n=t.getState())||void 0===n||null===(e=n.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/scenario/")).catch((function(n){return n}))).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(n){return o().Observable.of((0,d.setAnugaPollingData)(n.data)).switchMap((function(n){var e,r,a,i,l,c,s,A,f,_,v,p,E,S,g,N,O,T,b,y,U,m,R,D,I,C,h,M,w=(null===(e=n.scenarios)||void 0===e?void 0:e.filter((function(n){var t;return"complete"===(null===(t=n.latest_run)||void 0===t?void 0:t.status)}))).filter((function(n){var e,r,o;return null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.scenarios)||void 0===o?void 0:o.filter((function(e){var r,o,a,i,u,l,c,s,A,d,f,_=(null==e?void 0:e.id)===n.id,v=!e.isLoaded,p=(r=e,A=null==(o=t.getState())||null===(a=o.layers)||void 0===a||null===(i=a.flat)||void 0===i?void 0:i.filter((function(n){var t,e;return n.name===(null==r||null===(t=r.latest_run)||void 0===t||null===(e=t.gn_layer_depth_max)||void 0===e?void 0:e.name)})),d=null==o||null===(u=o.layers)||void 0===u||null===(l=u.flat)||void 0===l?void 0:l.filter((function(n){var t,e;return n.name===(null==r||null===(t=r.latest_run)||void 0===t||null===(e=t.gn_layer_depth_integrated_velocity_max)||void 0===e?void 0:e.name)})),f=null==o||null===(c=o.layers)||void 0===c||null===(s=c.flat)||void 0===s?void 0:s.filter((function(n){var t,e;return n.name===(null==r||null===(t=r.latest_run)||void 0===t||null===(e=t.gn_layer_velocity_max)||void 0===e?void 0:e.name)})),!(null!=A&&A.length&&null!=d&&d.length&&null!=f&&f.length));return _&&v&&p?n:null}))[0]}))[0],P=null===(r=t.getState())||void 0===r||null===(a=r.layers)||void 0===a||null===(i=a.flat)||void 0===i?void 0:i.map((function(n){return null==n?void 0:n.name})),G=(null===(l=t.getState())||void 0===l||null===(c=l.layers)||void 0===c||null===(s=c.flat)||void 0===s?void 0:s.filter((function(n){return"wms"===(null==n?void 0:n.type)&&"background"!==(null==n?void 0:n.group)})))||[],L=[null==w||null===(A=w.latest_run)||void 0===A||null===(f=A.gn_layer_depth_integrated_velocity_max)||void 0===f?void 0:f.title,null==w||null===(_=w.latest_run)||void 0===_||null===(v=_.gn_layer_depth_max)||void 0===v?void 0:v.title,null==w||null===(p=w.latest_run)||void 0===p||null===(E=p.gn_layer_velocity_max)||void 0===E?void 0:E.title],j=null===(S=t.getState())||void 0===S||null===(g=S.layers)||void 0===g||null===(N=g.flat)||void 0===N?void 0:N.filter((function(n){return L.includes(null==n?void 0:n.title)}));if(console.log("remove these existingResultLayers:",j),w&&null!=w&&null!==(O=w.latest_run)&&void 0!==O&&null!==(T=O.gn_layer_depth_integrated_velocity_max)&&void 0!==T&&T.catalogURL&&null!=w&&null!==(b=w.latest_run)&&void 0!==b&&null!==(y=b.gn_layer_depth_max)&&void 0!==y&&y.catalogURL&&null!=w&&null!==(U=w.latest_run)&&void 0!==U&&null!==(m=U.gn_layer_velocity_max)&&void 0!==m&&m.catalogURL&&!P.includes(null==w||null===(R=w.latest_run)||void 0===R||null===(D=R.gn_layer_depth_integrated_velocity_max)||void 0===D?void 0:D.name)&&!P.includes(null==w||null===(I=w.latest_run)||void 0===I||null===(C=I.gn_layer_depth_max)||void 0===C?void 0:C.name)&&!P.includes(null==w||null===(h=w.latest_run)||void 0===h||null===(M=h.gn_layer_velocity_max)||void 0===M?void 0:M.name)){var k,F,H,W=w.latest_run.gn_layer_depth_integrated_velocity_max,x=w.latest_run.gn_layer_depth_max,V=w.latest_run.gn_layer_velocity_max;return o().Observable.concat(o().Observable.of((0,u.$o)(null==j||null===(k=j[0])||void 0===k?void 0:k.id)),o().Observable.of((0,u.$o)(null==j||null===(F=j[1])||void 0===F?void 0:F.id)),o().Observable.of((0,u.$o)(null==j||null===(H=j[2])||void 0===H?void 0:H.id)),o().Observable.of((0,d.setAnugaPollingData)(n.scenarios)),o().Observable.of((0,u.A4)(W)),o().Observable.of((0,u.A4)(x)),o().Observable.of((0,u.A4)(V)),o().Observable.of((0,d.setAnugaScenarioResultsLoaded)(null==w?void 0:w.id,!0)),o().Observable.of((0,u.oZ)(G)))}return o().Observable.of((0,d.setAnugaPollingData)(n.scenarios))}))}))}))}))},U=function(n,t){return n.ofType(d.DELETE_ANUGA_SCENARIO).concatMap((function(n){var e,r,a;return o().Observable.from(i().delete("/anuga/api/".concat(null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/scenario/").concat(n.scenario.id,"/")))})).concatMap((function(n){return o().Observable.of((0,d.deleteAnugaScenarioSuccess)(n.data))}))},m=function(n,t){return n.ofType(d.RUN_ANUGA_SCENARIO).concatMap((function(n){var e,r,a;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/scenario/").concat(n.scenario.id,"/run/"),n).then((function(n){return(0,d.runAnugaScenarioSuccess)(n.data)})))})).concatMap((function(){return o().Observable.of((0,d.setAnugaScenarioMenu)(!0))}))},R=function(n,t){return n.ofType(d.CANCEL_ANUGA_RUN).concatMap((function(n){var e,r,a;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/scenario/").concat(n.scenario.id,"/run/"),n))})).concatMap((function(n){var e,r,a;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/scenario/").concat(n.scenario.id,"/cancel/"),{runId:n.scenario.latest_run.id}))})).concatMap((function(){return o().Observable.of((0,l.show)({message:"cancelling..."},"warning"))}))},D=function(n,t){return n.ofType(d.SAVE_ANUGA_SCENARIO).switchMap((function(n){var e,r,a,u,l,c;return n.scenario.log=n.scenario.log||"anuga log",n.scenario.id?o().Observable.from(i().put("/anuga/api/".concat(null===(u=t.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,"/scenario/").concat(n.scenario.id,"/"),n.scenario).then((function(n){return(0,d.saveAnugaScenarioSuccess)(n.data)})).catch((function(n){return(0,d.saveAnugaScenarioError)(n)}))):o().Observable.from(i().post("/anuga/api/".concat(null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/scenario/"),n.scenario).then((function(n){return(0,d.saveAnugaScenarioSuccess)(n.data)})).catch((function(n){return(0,d.saveAnugaScenarioError)(n)})))}))},I=function(n,t){return n.ofType(d.COMPARE_SCENARIOS).concatMap((function(n){var e,r,a;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/scenario/compare/"),n.scenarios).then((function(n){return(0,d.compareScenariosSuccess)(n.data)})))}))},C=function(n,t){return n.ofType(f.SET_OPEN_MENU_GROUP_ID).filter((function(n){return"Results"===(null==n?void 0:n.openMenuGroupId)})).switchMap((function(){return o().Observable.timer(0,1e4).takeUntil(n.ofType(d.STOP_COMPARISON_POLLING)).switchMap((function(){return o().Observable.concat(o().Observable.of((0,d.addComparison)()))}))}))},h=function(n,t){return n.ofType(d.RUN_NETWORK).concatMap((function(n){var e,r,a;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/network/").concat(n.network.id,"/run/"),n.network).then((function(n){return(0,d.runNetworkSuccess)(n.data)})))})).concatMap((function(){return o().Observable.of((0,d.setNetworkMenu)(!0))}))},M=function(n,t){return n.ofType(d.CREATE_ANUGA_BOUNDARY).switchMap((function(n){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/boundary/"),{project:null===(u=t.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:n.boundaryTitle}).catch((function(n){return n})))})).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(){return o().Observable.of((0,d.addAnugaBoundary)())}))},w=function(n,t){return n.ofType(d.ADD_ANUGA_BOUNDARY).switchMap((function(){var n,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(n=t.getState())||void 0===n||null===(e=n.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/boundary/available/")).catch((function(n){return n}))).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(n){return g(n,t)}))}))},P=function(n,t){return n.ofType(d.ADD_COMPARISON).switchMap((function(){var n,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(n=t.getState())||void 0===n||null===(e=n.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/comparison/available/")).catch((function(n){return n}))).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(n){return g(n,t)}))}))},G=function(n,t){return n.ofType(d.CREATE_ANUGA_FRICTION).switchMap((function(n){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/friction/"),{project:null===(u=t.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:n.frictionTitle}).catch((function(n){return n})))})).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(){return o().Observable.of((0,d.addAnugaFriction)())}))},L=function(n,t){return n.ofType(d.ADD_ANUGA_FRICTION).switchMap((function(){var n,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(n=t.getState())||void 0===n||null===(e=n.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/friction/available/")).catch((function(n){return n}))).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(n){return g(n,t)}))}))},j=function(n,t){return n.ofType(d.CREATE_ANUGA_INFLOW).switchMap((function(n){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/inflow/"),{project:null===(u=t.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:n.inflowTitle}).catch((function(n){return n})))})).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(){return o().Observable.of((0,d.addAnugaInflow)())}))},k=function(n,t){return n.ofType(d.ADD_ANUGA_INFLOW).switchMap((function(){var n,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(n=t.getState())||void 0===n||null===(e=n.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/inflow/available/")).catch((function(n){return n}))).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(n){return g(n,t)}))}))},F=function(n,t){return n.ofType(d.CREATE_ANUGA_STRUCTURE).switchMap((function(n){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/structure/"),{project:null===(u=t.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:n.structureTitle}).catch((function(n){return n})))})).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(){return o().Observable.of((0,d.addAnugaStructure)())}))},H=function(n,t){return n.ofType(d.ADD_ANUGA_STRUCTURE).switchMap((function(){var n,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(n=t.getState())||void 0===n||null===(e=n.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/structure/available/")).catch((function(n){return n}))).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(n){return g(n,t)}))}))},W=function(n,t){return n.ofType(d.ADD_ANUGA_FULL_MESH).switchMap((function(){var n,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(n=t.getState())||void 0===n||null===(e=n.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/full-mesh/available/")).catch((function(n){return n}))).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(n){return g(n,t)}))}))},x=function(n,t){return n.ofType(d.ADD_ANUGA_MESH_REGION).switchMap((function(){var n,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(n=t.getState())||void 0===n||null===(e=n.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/mesh-region/available/")).catch((function(n){return n}))).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(n){return g(n,t)}))}))},V=function(n,t){return n.ofType(d.ADD_LUMPED_CATCHMENT).switchMap((function(){var n,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(n=t.getState())||void 0===n||null===(e=n.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/catchment/available/")).catch((function(n){return n}))).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(n){return g(n,t)}))}))},K=function(n,t){return n.ofType(d.ADD_NODES).switchMap((function(){var n,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(n=t.getState())||void 0===n||null===(e=n.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/nodes/available/")).catch((function(n){return n}))).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(n){return g(n,t)}))}))},B=function(n,t){return n.ofType(d.ADD_LINKS).switchMap((function(){var n,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(n=t.getState())||void 0===n||null===(e=n.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/links/available/")).catch((function(n){return n}))).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(n){return g(n,t)}))}))},Y=function(n,t){return n.ofType(d.CREATE_ANUGA_MESH_REGION).switchMap((function(n){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/mesh-region/"),{project:null===(u=t.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:n.meshRegionTitle}).catch((function(n){return n})))})).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(){return o().Observable.of((0,d.addAnugaMeshRegion)())}))},Z=function(n,t){return n.ofType(d.CREATE_NETWORK).switchMap((function(n){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/network/"),{project:null===(u=t.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:n.networkTitle}).catch((function(n){return n})))})).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(){return o().Observable.of((0,d.addNetwork)())}))},J=function(n,t){return n.ofType(d.CREATE_FIGURE).switchMap((function(n){var e,r,a;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/publication/").concat(n.publicationId,"/create-figure/"),{title:n.figureTitle}).catch((function(n){return n})))})).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(n){var t;return console.log("response1:",n),window.open(null==n||null===(t=n.data)||void 0===t?void 0:t.detail_url,"_blank").focus(),o().Observable.of((0,d.initAnuga)())}))},$=function(n,t){return n.ofType(d.CREATE_LUMPED_CATCHMENT).switchMap((function(n){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/catchment/"),{project:null===(u=t.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:n.catchmentTitle}).catch((function(n){return n})))})).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(){return o().Observable.of((0,d.addCatchment)())}))},z=function(n,t){return n.ofType(d.CREATE_NODES).switchMap((function(n){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/nodes/"),{project:null===(u=t.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:n.nodesTitle}).catch((function(n){return n})))})).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(){return o().Observable.of((0,d.addNodes)())}))},X=function(n,t){return n.ofType(d.CREATE_LINKS).switchMap((function(n){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=t.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/links/"),{project:null===(u=t.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:n.linksTitle}).catch((function(n){return n})))})).filter((function(n){return(null==n?void 0:n.status)<=400})).switchMap((function(){return o().Observable.of((0,d.addLinks)())}))},Q=function(n,t){return n.ofType(d.UPDATE_COMPUTE_INSTANCE).switchMap((function(){var n,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(n=t.getState())||void 0===n||null===(e=n.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/compute-instance/"))).switchMap((function(n){return o().Observable.of((0,d.updateComputeInstanceSuccess)(n.data))}))}))},q=function(n,t){return n.ofType(A.IN).concatMap((function(n){return o().Observable.of(n)})).filter((function(){return["geonode:bdy_","geonode:inf_","geonode:str_","geonode:fri_","geonode:mes_"].some((function(n){var e,r;return null===(e=t.getState())||void 0===e||null===(r=e.featuregrid)||void 0===r?void 0:r.selectedLayer.includes(n)}))})).concatMap((function(n){var e,r,a,i,u;return null!=n&&null!==(e=n.features)&&void 0!==e&&e[0]&&(null===(r=Object.keys(null==n||null===(a=n.features)||void 0===a?void 0:a[0]))||void 0===r?void 0:r.length)>0?o().Observable.empty():(n.features[0].properties={"geonode:bdy_":{location:"External",boundary:"Dirichlet"},"geonode:inf_":{type:"Rainfall",data:100},"geonode:str_":{method:"Holes"},"geonode:fri_":{manning:.035},"geonode:mes_":{resolution:10}}[null===(i=t.getState())||void 0===i||null===(u=i.featuregrid)||void 0===u?void 0:u.selectedLayer.substring(0,12)],o().Observable.of(n))}))},nn=function(n,t){return n.ofType(f.UPDATE_DATASET_TITLE).switchMap((function(n){return o().Observable.from(i().get("/api/v2/datasets?search=".concat(n.datasetName.split("geonode:")[1],"&search_fields=name"))).switchMap((function(e){var r,a,u,l,c,s,A,d=parseInt(null==e||null===(r=e.data)||void 0===r||null===(a=r.datasets)||void 0===a||null===(u=a[0])||void 0===u?void 0:u.pk,10),f=null===(l=(0,_.Z7)(null==t?void 0:t.getState()).filter((function(n){return n.gn_layer===d})))||void 0===l?void 0:l[0];return o().Observable.from(i().patch("/anuga/api/".concat(null===(c=t.getState())||void 0===c||null===(s=c.anuga)||void 0===s||null===(A=s.projectData)||void 0===A?void 0:A.id,"/").concat(f.apiKey,"/").concat(f.id,"/"),{title:n.newTitle}))})).switchMap((function(){return o().Observable.empty()}))}))},tn=function(n,t){return t.getState,n.ofType(d.UPDATE_ANUGA_RESOURCES).switchMap((function(n){return n.action,o().Observable.defer((function(){return i().get((0,p.zL)("/anuga/api/project/"),{params:{page_size:100,page:1}}).then((function(n){return n.data}))})).switchMap((function(n){var t,e;return o().Observable.of((0,d.setAnugaResources)({projects:E(n),isNextPageAvailable:!(null==n||null===(t=n.links)||void 0===t||!t.next),isPreviousPageAvailable:!(null==n||null===(e=n.links)||void 0===e||!e.previous),loading:!1}))})).catch((function(n){return o().Observable.of((0,v.mN)(n.data||n.message),(0,d.setAnugaResources)({loading:!1}))})).startWith((0,d.setAnugaResources)({loading:!0}))}))}},375501:(n,t,e)=>{"use strict";e.d(t,{Z:()=>A});var r=e(368658),o=e(351288);function a(n){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},a(n)}function i(n){return function(n){if(Array.isArray(n))return u(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,t){if(n){if("string"==typeof n)return u(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);return"Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e?Array.from(n):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?u(n,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function l(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function c(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?l(Object(e),!0).forEach((function(t){var r,o,i,u;r=n,o=t,i=e[t],u=function(n,t){if("object"!=a(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var r=e.call(n,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(o),(o="symbol"==a(u)?u:u+"")in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):l(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}var s={showAddAnugaElevationData:!1,visibleAnugaScenarioLogId:!1,scenarios:[]};const A=function(){var n,t,e,a,u,l,A,d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,f=arguments.length>1?arguments[1]:void 0;switch(console.log("action for Anuga: ",f),f.type){case r.SET_CREATING_ANUGA_LAYER:return c(c({},d),{},{isCreatingAnugaLayer:f.isCreatingAnugaLayer});case r.SET_ANUGA_RESOURCES:console.log("** anugaHomePageResources",f.data);var _=null===(n=f.data)||void 0===n||null===(t=n.projects)||void 0===t?void 0:t.map((function(n){return null==n?void 0:n.base_map_full})).filter((function(n){return!(null!=n&&n.featured)}));return console.log("projects:",_),_&&_.sort((function(n,t){var e=null!=n&&n.base_map_full?new Date(n.base_map_full.last_updated):new Date(0);return(null!=t&&t.base_map_full?new Date(t.base_map_full.last_updated):new Date(0))-e})),console.log("projects2:",_),c(c({},d),{},{anugaHomePageResources:c(c({},f.data),{},{projects:_})});case r.UPDATE_ANUGA_SCENARIO:return c(c({},d),{},{scenarios:d.scenarios.map((function(n){return n.id===f.scenario.id?(f.scenario.unsaved=!0,f.scenario):n}))});case r.UPDATE_NETWORK:return c(c({},d),{},{networks:d.networks.map((function(n){return n.id===f.network.id?(f.network.unsaved=!0,f.network):n}))});case r.TOGGLE_SCENARIO_SELECTED:return c(c({},d),{},{scenarios:d.scenarios.map((function(n){return n.id===f.scenario.id?(f.scenario.selected=!n.selected,f.scenario):n}))});case r.SET_ANUGA_POLLING_DATA:var v=d.scenarios.map((function(n){var t=f.scenarios.filter((function(t){return n.id===t.id}))[0];return n.latest_run=c({},null==t?void 0:t.latest_run),n.status=(null==t?void 0:t.status)||"unsaved",n.latest_run_is_valid=null==t?void 0:t.latest_run_is_valid,n})),p=null===(e=d.scenarios)||void 0===e?void 0:e.map((function(n){return null==n?void 0:n.id})),E=null===(a=f.scenarios)||void 0===a||null===(u=a.filter((function(n){return!p.includes(n.id)})))||void 0===u?void 0:u[0];return E&&(v=[].concat(i(v),[E])),c(c({},d),{},{scenarios:v,selectedScenario:f.scenarios.filter((function(n){return d.selectedScenarioId===n.id}))[0]});case r.ADD_ANUGA_SCENARIO:return c(c({},d),{},{scenarios:[].concat(i(d.scenarios),[{id:null,name:"",code:null,description:"",maximum_triangle_area:1e3,constant_rainfall:null,duration:null,status:"new",project:null==d||null===(l=d.projectData)||void 0===l?void 0:l.id,boundary:"",elevation:"",log:"log placeholder",unsaved:!1,selected:!1}])});case r.SET_ANUGA_SCENARIO_IS_LOADED:return c(c({},d),{},{scenarios:d.scenarios.map((function(n){return n.id===f.scenarioId?(n.isLoaded=f.isLoaded,n):n}))});case r.SHOW_ANUGA_SCENARIO_LOG:return c(c({},d),{},{visibleAnugaScenarioLogId:f.scenarioId});case r.SHOW_ANUGA_RUN_MENU:return c(c({},d),{},{visibleAnugaRunMenu:f.visible});case r.SAVE_ANUGA_SCENARIO_SUCCESS:return c(c({},d),{},{scenarios:d.scenarios.map((function(n){return n.id===f.scenario.id?(f.scenario.unsaved=!1,f.scenario):n.id?n:f.scenario}))});case r.SELECT_ANUGA_SCENARIO:return c(c({},d),{},{selectedScenarioId:f.scenario.id,selectedScenario:f.scenario});case r.SET_ANUGA_PROJECT_DATA:return c(c({},d),{},{projectData:f.data});case r.SET_ANUGA_SCENARIO_DATA:return 0===d.scenarios.length?c(c({},d),{},{scenarios:f.scenarios}):c(c({},d),{},{scenarios:null===(A=d.scenarios)||void 0===A?void 0:A.map((function(n){var t;return n.unsaved?c(c({},f.scenario),{},{unsaved:!0}):(null==n?void 0:n.id)===(null===(t=f.scenario)||void 0===t?void 0:t.id)?(f.scenario.unsaved=!1,f.scenario):n}))});case r.UPDATE_COMPUTE_INSTANCE_SUCCESS:return c(c({},d),{},{computeInstances:f.data});case r.SET_COMPARISON_DATA:return c(c({},d),{},{comparisons:f.data});case r.SET_ANUGA_INFLOW_DATA:return c(c({},d),{},{inflows:f.data});case r.SET_ANUGA_FRICTION_DATA:return c(c({},d),{},{frictions:f.data});case r.SET_ANUGA_STRUCTURE_DATA:return c(c({},d),{},{structures:f.data});case r.SET_ANUGA_BOUNDARY_DATA:return c(c({},d),{},{boundaries:f.data});case r.SET_ANUGA_ELEVATION_DATA:return c(c({},d),{},{elevations:f.data});case r.SET_ANUGA_FULL_MESH_DATA:return c(c({},d),{},{fullMeshes:f.data});case r.SET_ANUGA_MESH_REGION_DATA:return c(c({},d),{},{meshRegions:f.data});case r.SET_NETWORK_DATA:return c(c({},d),{},{networks:f.data});case r.SET_LUMPED_CATCHMENT_DATA:return c(c({},d),{},{catchments:f.data});case r.SET_ANUGA_NODES_DATA:return c(c({},d),{},{nodes:f.data});case r.SET_ANUGA_LINKS_DATA:return c(c({},d),{},{links:f.data});case r.SET_PUBLICATION_DATA:return c(c({},d),{},{publications:f.data});case o.SET_OPEN_MENU_GROUP_ID:return f.openMenuGroupId?c(c({},d),{},{showAnugaInputMenu:!1,showAnugaScenarioMenu:!1,showAnugaResultMenu:!1}):d;case r.SET_ANUGA_INPUT_MENU:return c(c({},d),{},{showAnugaInputMenu:f.visible,showAnugaScenarioMenu:!1,showAnugaResultMenu:!1,showNetworkMenu:!1,showReviewPanel:!1,showPublicationPanel:!1});case r.SET_ANUGA_SCENARIO_MENU:return c(c({},d),{},{showAnugaInputMenu:!1,showAnugaScenarioMenu:f.visible,showAnugaResultMenu:!1,showNetworkMenu:!1,showReviewPanel:!1,showPublicationPanel:!1});case r.SET_ANUGA_RESULT_MENU:return c(c({},d),{},{showAnugaScenarioMenu:!1,showAnugaInputMenu:!1,showAnugaResultMenu:f.visible,showNetworkMenu:!1,showReviewPanel:!1,showPublicationPanel:!1});case r.SET_NETWORK_MENU:return c(c({},d),{},{showAnugaInputMenu:!1,showAnugaScenarioMenu:!1,showAnugaResultMenu:!1,showNetworkMenu:f.visible,showReviewPanel:!1,showPublicationPanel:!1});case r.SET_REVIEW_PANEL:return c(c({},d),{},{showAnugaInputMenu:!1,showAnugaScenarioMenu:!1,showAnugaResultMenu:!1,showNetworkMenu:!1,showReviewPanel:f.visible,showPublicationPanel:!1});case r.SET_PUBLICATION_PANEL:return c(c({},d),{},{showAnugaInputMenu:!1,showAnugaScenarioMenu:!1,showAnugaResultMenu:!1,showNetworkMenu:!1,showReviewPanel:!1,showPublicationPanel:f.visible});default:return d}}},926036:(n,t,e)=>{"use strict";function r(n){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},r(n)}function o(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function a(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?o(Object(e),!0).forEach((function(t){var o,a,i,u;o=n,a=t,i=e[t],u=function(n,t){if("object"!=r(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var o=e.call(n,"string");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(a),(a="symbol"==r(u)?u:u+"")in o?Object.defineProperty(o,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[a]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):o(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}e.d(t,{rP:()=>i,Dh:()=>u,mn:()=>l,Z7:()=>c});var i=function(n){var t,e,r,o,a,i,u=null==n||null===(t=n.security)||void 0===t||null===(e=t.user)||void 0===e?void 0:e.pk,l=null==n||null===(r=n.gnresource)||void 0===r||null===(o=r.compactPermissions)||void 0===o||null===(a=o.users)||void 0===a||null===(i=a.filter((function(n){return n.id===u}))[0])||void 0===i?void 0:i.permissions;return["view","edit","manage","owner"].includes(l)},u=function(n){var t,e,r,o,a,i,u=null==n||null===(t=n.security)||void 0===t||null===(e=t.user)||void 0===e?void 0:e.pk,l=null==n||null===(r=n.gnresource)||void 0===r||null===(o=r.compactPermissions)||void 0===o||null===(a=o.users)||void 0===a||null===(i=a.filter((function(n){return n.id===u}))[0])||void 0===i?void 0:i.permissions;return["edit","manage","owner"].includes(l)},l=function(n){var t;return null==n||null===(t=n.anuga)||void 0===t?void 0:t.scenarios.filter((function(n){return null==n?void 0:n.selected}))},c=function(n){var t={elevations:"elevation",boundaries:"boundary",frictions:"friction",inflows:"inflow",meshRegions:"mesh-region",structures:"structure",catchments:"catchment",nodes:"nodes",links:"links"},e=Array();return["elevations","boundaries","frictions","inflows","meshRegions","structures","catchments","nodes","links"].map((function(r){var o;null==n||null===(o=n.anuga)||void 0===o||o[r].map((function(n){e.push(a(a({},n),{},{apiKey:t[r]}))}))})),e}}}]);