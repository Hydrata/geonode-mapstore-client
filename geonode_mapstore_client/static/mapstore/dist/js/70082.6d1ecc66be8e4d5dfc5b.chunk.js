(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[70082],{801550:(t,n,e)=>{"use strict";e.d(n,{pP:()=>r,TR:()=>o,N7:()=>a,mq:()=>i,uv:()=>u,Qy:()=>l,IL:()=>c,Li:()=>s,OW:()=>d,ZO:()=>A,Um:()=>f,TF:()=>v,Ls:()=>_,Ec:()=>p,Eu:()=>E,JJ:()=>g,nZ:()=>S,YD:()=>O,GI:()=>b,Jb:()=>N,Uh:()=>T,e$:()=>y,eh:()=>m,$j:()=>U,bJ:()=>R,Mk:()=>D,xy:()=>I,o6:()=>h,FP:()=>C,Mo:()=>M,sO:()=>w,Px:()=>P,hd:()=>G,Ju:()=>L,BV:()=>j,SO:()=>k,H0:()=>H,$X:()=>F,ou:()=>W,NE:()=>x,Lq:()=>V,aN:()=>K});var r="CHANGE_MAP_VIEW",o="CLICK_ON_MAP",a="CHANGE_MOUSE_POINTER",i="CHANGE_ZOOM_LVL",u="PAN_TO",l="ZOOM_TO_EXTENT",c="ZOOM_TO_POINT",s="CHANGE_MAP_CRS",d="CHANGE_MAP_SCALES",A="CHANGE_MAP_STYLE",f="CHANGE_ROTATION",v="CREATION_ERROR_LAYER",_="UPDATE_VERSION",p="INIT_MAP",E="RESIZE_MAP",g="CHANGE_MAP_LIMITS",S="SET_MAP_RESOLUTIONS",O="REGISTER_EVENT_LISTENER",b="UNREGISTER_EVENT_LISTENER",N="MOUSE_MOVE",T="MOUSE_OUT",y="MAP:MAP_PLUGIN_LOAD",m="MAP:ORIENTATION",U="MAP:UPDATE_MAP_VIEW",R="MAP:UPDATE_MAP_OPTIONS";function D(t,n,e,r){return{type:y,mapType:n,loading:t,loaded:e,error:r}}function I(t,n,e){return{type:c,pos:t,zoom:n,crs:e}}function h(t,n,e,o,a,i,u,l){return{type:r,center:t,zoom:n,bbox:e,size:o,mapStateSource:a,projection:i,viewerOptions:u,resolution:l}}function C(t,n){return{type:o,point:t,layer:n}}function M(t){return{type:a,pointer:t}}function w(t,n){return{type:i,zoom:t,mapStateSource:n}}function P(t,n,e,r){return{type:l,extent:t,crs:n,maxZoom:e,options:r}}function G(t,n){return{type:A,style:t,mapStateSource:n}}function L(){return{type:E}}function j(t){var n=t.restrictedExtent,e=t.crs,r=t.minZoom;return{type:g,restrictedExtent:n,crs:e,minZoom:r}}function k(t){return{type:S,resolutions:t}}var H=function(t,n){return{type:O,eventName:t,toolName:n}},F=function(t,n){return{type:b,eventName:t,toolName:n}},W=function(t){return{type:N,position:t}},x=function(){return{type:T}},V=function(t){return{type:m,orientation:t}},K=function(t){return{type:R,configUpdate:t}}},615402:(t,n,e)=>{"use strict";e.d(n,{Z:()=>_});var r=e(675263),o=e.n(r),a=e(124852),i=e.n(a);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function l(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,A(r.key),r)}}function c(t,n){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},c(t,n)}function s(t){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},s(t)}function d(t,n,e){return(n=A(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function A(t){var n=function(t,n){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(n)?n:String(n)}var f=e(868195).FormattedHTMLMessage,v=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&c(t,n)}(d,t);var n,e,r,o,a=(r=d,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=s(r);if(o){var e=s(this).constructor;t=Reflect.construct(n,arguments,e)}else t=n.apply(this,arguments);return function(t,n){if(n&&("object"===u(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function d(){return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,d),a.apply(this,arguments)}return n=d,(e=[{key:"render",value:function(){return this.context.intl?i().createElement(f,{id:this.props.msgId,values:this.props.msgParams}):i().createElement("span",null,this.props.msgId||"")}}])&&l(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),d}(i().Component);d(v,"propTypes",{msgId:o().string.isRequired,msgParams:o().object}),d(v,"contextTypes",{intl:o().object});const _=v},368658:(t,n,e)=>{function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function a(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?o(Object(e),!0).forEach((function(n){var o,a,i,u;o=t,a=n,i=e[n],u=function(t,n){if("object"!=r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var o=e.call(t,"string");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(a),(a="symbol"==r(u)?u:String(u))in o?Object.defineProperty(o,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[a]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):o(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}var i=e(197395).SHOW_NOTIFICATION,u=e(984110),l="INIT_ANUGA",c="SET_ANUGA_INPUT_MENU",s="SET_ANUGA_SCENARIO_MENU",d="SET_ANUGA_RESULT_MENU",A="SET_NETWORK_MENU",f="SET_REVIEW_PANEL",v="SET_PUBLICATION_PANEL",_="SET_ANUGA_PROJECT_DATA",p="SET_ANUGA_SCENARIO_DATA",E="SET_ANUGA_BOUNDARY_DATA",g="SET_ANUGA_FRICTION_DATA",S="SET_ANUGA_INFLOW_DATA",O="SET_ANUGA_STRUCTURE_DATA",b="SET_ANUGA_FULL_MESH_DATA",N="SET_ANUGA_MESH_REGION_DATA",T="SET_NETWORK_DATA",y="SET_LUMPED_CATCHMENT_DATA",m="SET_ANUGA_NODES_DATA",U="SET_ANUGA_LINKS_DATA",R="SET_PUBLICATION_DATA",D="CREATE_ANUGA_BOUNDARY",I="CREATE_ANUGA_FRICTION",h="CREATE_ANUGA_INFLOW",C="CREATE_ANUGA_STRUCTURE",M="CREATE_ANUGA_MESH_REGION",w="CREATE_NETWORK",P="CREATE_LUMPED_CATCHMENT",G="CREATE_NODES",L="CREATE_LINKS",j="CREATE_FIGURE",k="ADD_ANUGA_BOUNDARY",H="ADD_ANUGA_FRICTION",F="ADD_ANUGA_INFLOW",W="ADD_ANUGA_STRUCTURE",x="ADD_ANUGA_FULL_MESH",V="ADD_ANUGA_MESH_REGION",K="ADD_ANUGA_NETWORK",B="ADD_LUMPED_CATCHMENT",Y="ADD_NODES",Z="ADD_LINKS",J="ADD_COMPARISON",$="SET_ANUGA_ELEVATION_DATA",z="CREATE_ANUGA_ELEVATION_FROM_LAYER",Q="SET_ADD_ANUGA_ELEVATION_DATA",q="ADD_ANUGA_SCENARIO",X="RUN_ANUGA_SCENARIO",tt="RUN_ANUGA_SCENARIO_SUCCESS",nt="RUN_NETWORK",et="RUN_NETWORK_SUCCESS",rt="SAVE_ANUGA_SCENARIO",ot="SAVE_ANUGA_SCENARIO_SUCCESS",at="SAVE_ANUGA_SCENARIO_ERROR",it="DELETE_ANUGA_SCENARIO",ut="SHOW_ANUGA_SCENARIO_LOG",lt="SHOW_ANUGA_RUN_MENU",ct="START_ANUGA_SCENARIO_POLLING",st="STOP_ANUGA_SCENARIO_POLLING",dt="START_ANUGA_ELEVATION_POLLING",At="STOP_ANUGA_ELEVATION_POLLING",ft="START_ANUGA_MODEL_CREATION_POLLING",vt="STOP_ANUGA_MODEL_CREATION_POLLING",_t="START_COMPARISON_POLLING",pt="STOP_COMPARISON_POLLING",Et="SET_COMPARISON_DATA",gt="SET_ANUGA_POLLING_DATA",St="UPDATE_ANUGA_SCENARIO",Ot="UPDATE_NETWORK",bt="SELECT_ANUGA_SCENARIO",Nt="SET_CREATING_ANUGA_LAYER",Tt="SET_ANUGA_SCENARIO_IS_LOADED",yt="CANCEL_ANUGA_RUN",mt="UPDATE_COMPUTE_INSTANCE",Ut="UPDATE_COMPUTE_INSTANCE_SUCCESS",Rt="TOGGLE_SCENARIO_SELECTED",Dt="SHOW_MANAGE_ACCOUNT",It="COMPARE_SCENARIOS",ht="COMPARE_SCENARIOS_SUCCESS",Ct="UPDATE_ANUGA_RESOURCES",Mt="SET_ANUGA_RESOURCES";t.exports={INIT_ANUGA:l,initAnuga:function(){return{type:l}},SET_ANUGA_INPUT_MENU:c,setAnugaInputMenu:function(t){return{type:c,visible:t}},SET_ANUGA_SCENARIO_MENU:s,setAnugaScenarioMenu:function(t){return{type:s,visible:t}},SET_ANUGA_RESULT_MENU:d,setAnugaResultMenu:function(t){return{type:d,visible:t}},SET_REVIEW_PANEL:f,setReviewPanel:function(t){return{type:f,visible:t}},SET_PUBLICATION_PANEL:v,setPublicationPanel:function(t){return{type:v,visible:t}},SET_ANUGA_PROJECT_DATA:_,setAnugaProjectData:function(t){return{type:_,data:t}},SET_ANUGA_SCENARIO_DATA:p,setAnugaScenarioData:function(t){return{type:p,scenarios:t}},SET_ANUGA_ELEVATION_DATA:$,setAnugaElevationData:function(t){return{type:$,data:t}},SET_ANUGA_BOUNDARY_DATA:E,setAnugaBoundaryData:function(t){return{type:E,data:t}},SET_ANUGA_FRICTION_DATA:g,setAnugaFrictionData:function(t){return{type:g,data:t}},SET_ANUGA_INFLOW_DATA:S,setAnugaInflowData:function(t){return{type:S,data:t}},SET_ANUGA_STRUCTURE_DATA:O,setAnugaStructureData:function(t){return{type:O,data:t}},SET_ANUGA_FULL_MESH_DATA:b,setAnugaFullMeshData:function(t){return{type:b,data:t}},SET_ANUGA_MESH_REGION_DATA:N,setAnugaMeshRegionData:function(t){return{type:N,data:t}},SET_NETWORK_DATA:T,setNetworkData:function(t){return{type:T,data:t}},SET_LUMPED_CATCHMENT_DATA:y,setCatchmentData:function(t){return{type:y,data:t}},SET_ANUGA_NODES_DATA:m,setAnugaNodesData:function(t){return{type:m,data:t}},SET_ANUGA_LINKS_DATA:U,setAnugaLinksData:function(t){return{type:U,data:t}},SET_PUBLICATION_DATA:R,setPublicationData:function(t){return{type:R,data:t}},CREATE_ANUGA_BOUNDARY:D,createAnugaBoundary:function(t){return{type:D,boundaryTitle:t}},CREATE_ANUGA_FRICTION:I,createAnugaFriction:function(t){return{type:I,frictionTitle:t}},CREATE_ANUGA_INFLOW:h,createAnugaInflow:function(t){return{type:h,inflowTitle:t}},CREATE_ANUGA_STRUCTURE:C,createAnugaStructure:function(t){return{type:C,structureTitle:t}},CREATE_ANUGA_MESH_REGION:M,createAnugaMeshRegion:function(t){return{type:M,meshRegionTitle:t}},CREATE_NETWORK:w,createNetwork:function(t){return{type:w,networkTitle:t}},CREATE_LUMPED_CATCHMENT:P,createCatchment:function(t){return{type:P,catchmentTitle:t}},CREATE_NODES:G,createNodes:function(t){return{type:G,nodesTitle:t}},CREATE_LINKS:L,createLinks:function(t){return{type:L,linksTitle:t}},CREATE_FIGURE:j,createFigure:function(t,n){return{type:j,figureTitle:t,publicationId:n}},ADD_ANUGA_BOUNDARY:k,addAnugaBoundary:function(){return{type:k}},ADD_ANUGA_FRICTION:H,addAnugaFriction:function(){return{type:H}},ADD_ANUGA_INFLOW:F,addAnugaInflow:function(){return{type:F}},ADD_ANUGA_STRUCTURE:W,addAnugaStructure:function(){return{type:W}},ADD_ANUGA_MESH_REGION:V,addAnugaMeshRegion:function(){return{type:V}},ADD_ANUGA_FULL_MESH:x,addAnugaFullMesh:function(){return{type:x}},ADD_NETWORK:K,addNetwork:function(){return{type:K}},ADD_LUMPED_CATCHMENT:B,addCatchment:function(){return{type:B}},ADD_NODES:Y,addNodes:function(){return{type:Y}},ADD_LINKS:Z,addLinks:function(){return{type:Z}},ADD_COMPARISON:J,addComparison:function(){return{type:J}},SET_ADD_ANUGA_ELEVATION_DATA:Q,setAddAnugaElevation:function(t){return{type:Q,visible:t}},CREATE_ANUGA_ELEVATION_FROM_LAYER:z,createAnugaElevationFromLayer:function(t,n){return{type:z,pk:t,title:n}},SAVE_ANUGA_SCENARIO:rt,saveAnugaScenario:function(t){return{type:rt,scenario:t}},ADD_ANUGA_SCENARIO:q,addAnugaScenario:function(){return{type:q}},SAVE_ANUGA_SCENARIO_SUCCESS:ot,saveAnugaScenarioSuccess:function(t){return function(n){n({type:i,title:"Success",autoDismiss:6,position:"tc",message:"Scenario ID: ".concat(t.id," building"),uid:u(),level:"success"}),n({type:ot,scenario:t})}},SAVE_ANUGA_SCENARIO_ERROR:at,saveAnugaScenarioError:function(t){return function(n){n({type:i,title:"Error",autoDismiss:60,position:"tc",message:"Error saving scenario: ".concat(JSON.stringify(null==t?void 0:t.data)),uid:u(),level:"error"}),n({type:at,error:t})}},DELETE_ANUGA_SCENARIO:it,deleteAnugaScenario:function(t){return{type:it,scenario:t}},DELETE_ANUGA_SCENARIO_SUCCESS:"DELETE_ANUGA_SCENARIO_SUCCESS",deleteAnugaScenarioSuccess:function(t){return function(n){n({type:i,title:"Success",autoDismiss:6,position:"tc",message:"Scenario ID: ".concat(t.id," deleted"),uid:u(),level:"info"}),n({type:l})}},RUN_ANUGA_SCENARIO:X,runAnugaScenario:function(t,n){return{type:X,scenario:t,computeInstanceId:n}},RUN_ANUGA_SCENARIO_SUCCESS:tt,runAnugaScenarioSuccess:function(t){return function(n){n({type:i,title:"Success",autoDismiss:6,position:"tc",message:"Scenario running",uid:u(),level:"success"}),n({type:tt,scenario:t})}},SET_NETWORK_MENU:A,setNetworkMenu:function(t){return{type:A,visible:t}},RUN_NETWORK:nt,runNetwork:function(t){return{type:nt,network:t}},RUN_NETWORK_SUCCESS:et,runNetworkSuccess:function(t){return function(n){n({type:i,title:"Success",autoDismiss:6,position:"tc",message:"Network Calculated",uid:u(),level:"success"}),n({type:et,network:t})}},UPDATE_NETWORK:Ot,updateNetwork:function(t,n){return{type:Ot,network:a(a({},t),n)}},UPDATE_ANUGA_SCENARIO:St,updateAnugaScenario:function(t,n){return{type:St,scenario:a(a({},t),n)}},SELECT_ANUGA_SCENARIO:bt,selectAnugaScenario:function(t){return{type:bt,scenario:t}},SHOW_ANUGA_SCENARIO_LOG:ut,showAnugaScenarioLog:function(t){return{type:ut,scenarioId:t}},SHOW_ANUGA_RUN_MENU:lt,showAnugaRunMenu:function(t){return{type:lt,visible:t}},START_ANUGA_SCENARIO_POLLING:ct,startAnugaScenarioPolling:function(){return{type:ct}},STOP_ANUGA_SCENARIO_POLLING:st,stopAnugaScenarioPolling:function(){return{type:st}},START_ANUGA_ELEVATION_POLLING:dt,startAnugaElevationPolling:function(){return{type:dt}},STOP_ANUGA_ELEVATION_POLLING:At,stopAnugaElevationPolling:function(){return{type:At}},START_ANUGA_MODEL_CREATION_POLLING:ft,startAnugaModelCreationPolling:function(){return{type:ft}},STOP_ANUGA_MODEL_CREATION_POLLING:vt,stopAnugaModelCreationPolling:function(){return{type:vt}},START_COMPARISON_POLLING:_t,startComparisonPolling:function(){return{type:_t}},STOP_COMPARISON_POLLING:pt,stopComparisonPolling:function(){return{type:pt}},SET_COMPARISON_DATA:Et,setComparisonData:function(t){return{type:Et,data:t}},SET_ANUGA_POLLING_DATA:gt,setAnugaPollingData:function(t){return{type:gt,scenarios:t}},SET_CREATING_ANUGA_LAYER:Nt,setCreatingAnugaLayer:function(t){return{type:Nt,isCreatingAnugaLayer:t}},SET_ANUGA_SCENARIO_IS_LOADED:Tt,setAnugaScenarioResultsLoaded:function(t,n){return{type:Tt,scenarioId:t,isLoaded:n}},CANCEL_ANUGA_RUN:yt,cancelAnugaRun:function(t,n){return{type:yt,scenario:t,computeInstanceId:n}},UPDATE_COMPUTE_INSTANCE:mt,updateComputeInstance:function(){return{type:mt}},UPDATE_COMPUTE_INSTANCE_SUCCESS:Ut,updateComputeInstanceSuccess:function(t){return{type:Ut,data:t}},TOGGLE_SCENARIO_SELECTED:Rt,toggleScenarioSelected:function(t){return{type:Rt,scenario:t}},SHOW_MANAGE_ACCOUNT:Dt,showManageAccount:function(t){return{type:Dt,visible:t}},COMPARE_SCENARIOS:It,compareScenarios:function(t){return{type:It,scenarios:t}},COMPARE_SCENARIOS_SUCCESS:ht,compareScenariosSuccess:function(t){return function(n){n({type:i,title:"Success",autoDismiss:6,position:"tc",message:"Scenario comparison started",uid:u(),level:"success"}),n({type:ht,scenarios:t})}},UPDATE_ANUGA_RESOURCES:Ct,updateAnugaResources:function(t){return{type:Ct,action:t,pageSize:arguments.length>1&&void 0!==arguments[1]?arguments[1]:100}},SET_ANUGA_RESOURCES:Mt,setAnugaResources:function(t){return{type:Mt,data:t}}}},300806:(t,n,e)=>{"use strict";e.d(n,{gE:()=>S,GM:()=>O,z1:()=>b,Z6:()=>N,Zu:()=>T,Rf:()=>y,F7:()=>m,EE:()=>U,ax:()=>R,b2:()=>D,sW:()=>I,Ye:()=>h,dd:()=>C,rJ:()=>M,As:()=>w,lA:()=>P,T9:()=>G,QH:()=>L,XO:()=>j,Qc:()=>k,Ok:()=>H,AC:()=>F,Xv:()=>W,yN:()=>x,oq:()=>V,Qy:()=>K,BA:()=>B,Og:()=>Y,h2:()=>Z,bp:()=>J,d:()=>$,E_:()=>z,YL:()=>Q,o$:()=>q,HQ:()=>X});var r=e(49977),o=e.n(r),a=e(375875),i=e.n(a),u=e(580416),l=e(197395),c=e(801550),s=e(73443),d=e(433528),A=e(368658),f=e(351288),v=e(926036),_=e(643892),p=e(55035);function E(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var g=function(t,n){var e;if(0===(null===(e=t.data)||void 0===e?void 0:e.length))return o().Observable.empty();var r=[(0,A.initAnuga)(),(0,A.setCreatingAnugaLayer)(!1)];return t.data.map((function(t){0===n.getState().layers.flat.filter((function(n){return n.name===(null==t?void 0:t.name)})).length&&(r.unshift((0,u.A4)(t)),r.push((0,l.show)({message:"New layers added... You should save your project.",title:"Layers added",uid:1e3,position:"tc"})))})),o().Observable.from(r)},S=function(t,n){return t.ofType(A.INIT_ANUGA,f.UPDATE_DATASET_TITLE_SUCCESS).filter((function(){var t;return null===(t=n.getState())||void 0===t?void 0:t.gnresource.id})).switchMap((function(){var t;return o().Observable.from(i().post("/anuga/api/project/get_project_from_map_id/",{mapId:null===(t=n.getState())||void 0===t?void 0:t.gnresource.id}).catch((function(t){return console.log("**",t),"error"}))).filter((function(t){return(null==t?void 0:t.status)<=400})).filter((function(){var t,e;return!(null===(t=n.getState())||void 0===t||null===(e=t.security)||void 0===e||!e.user)})).switchMap((function(t){return o().Observable.from(i().get("/anuga/api/project/".concat(t.data.projectId,"/"))).switchMap((function(n){var e;return o().Observable.of((0,A.setAnugaProjectData)(n.data)).concat(o().Observable.of((0,f.setSvConfig)(null===(e=n.data)||void 0===e?void 0:e.simple_view_config)),o().Observable.from(i().get("/anuga/api/".concat(t.data.projectId,"/scenario/"))).switchMap((function(t){return o().Observable.of((0,A.setAnugaScenarioData)(t.data))})),o().Observable.from(i().get("/anuga/api/".concat(t.data.projectId,"/boundary/"))).switchMap((function(t){return o().Observable.of((0,A.setAnugaBoundaryData)(t.data))})),o().Observable.from(i().get("/anuga/api/".concat(t.data.projectId,"/elevation/"))).switchMap((function(t){return o().Observable.of((0,A.setAnugaElevationData)(t.data))})),o().Observable.from(i().get("/anuga/api/".concat(t.data.projectId,"/inflow/"))).switchMap((function(t){return o().Observable.of((0,A.setAnugaInflowData)(t.data))})),o().Observable.from(i().get("/anuga/api/".concat(t.data.projectId,"/structure/"))).switchMap((function(t){return o().Observable.of((0,A.setAnugaStructureData)(t.data))})),o().Observable.from(i().get("/anuga/api/".concat(t.data.projectId,"/friction/"))).switchMap((function(t){return o().Observable.of((0,A.setAnugaFrictionData)(t.data))})),o().Observable.from(i().get("/anuga/api/".concat(t.data.projectId,"/full-mesh/"))).switchMap((function(t){return o().Observable.of((0,A.setAnugaFullMeshData)(t.data))})),o().Observable.from(i().get("/anuga/api/".concat(t.data.projectId,"/mesh-region/"))).switchMap((function(t){return o().Observable.of((0,A.setAnugaMeshRegionData)(t.data))})),o().Observable.from(i().get("/anuga/api/".concat(t.data.projectId,"/network/"))).switchMap((function(t){return o().Observable.of((0,A.setNetworkData)(t.data))})),o().Observable.from(i().get("/anuga/api/".concat(t.data.projectId,"/catchment/"))).switchMap((function(t){return o().Observable.of((0,A.setCatchmentData)(t.data))})),o().Observable.from(i().get("/anuga/api/".concat(t.data.projectId,"/nodes/"))).switchMap((function(t){return o().Observable.of((0,A.setAnugaNodesData)(t.data))})),o().Observable.from(i().get("/anuga/api/".concat(t.data.projectId,"/links/"))).switchMap((function(t){return o().Observable.of((0,A.setAnugaLinksData)(t.data))})),o().Observable.from(i().get("/anuga/api/".concat(t.data.projectId,"/comparison/"))).switchMap((function(t){return o().Observable.of((0,A.setComparisonData)(t.data))})),o().Observable.from(i().get("/anuga/api/".concat(t.data.projectId,"/publication/"))).switchMap((function(t){return o().Observable.of((0,A.setPublicationData)(t.data))})),o().Observable.of((0,A.startAnugaScenarioPolling)()))})).filter((function(t){return t}))}))})).filter((function(t){return t}))},O=function(t){return t.ofType(A.START_ANUGA_MODEL_CREATION_POLLING).switchMap((function(){return o().Observable.timer(0,1e4).takeUntil(t.ofType(A.STOP_ANUGA_MODEL_CREATION_POLLING)).switchMap((function(){return o().Observable.concat(o().Observable.of((0,A.addAnugaBoundary)()),o().Observable.of((0,A.addAnugaFriction)()),o().Observable.of((0,A.addAnugaStructure)()),o().Observable.of((0,A.addAnugaInflow)()),o().Observable.of((0,A.addAnugaFullMesh)()),o().Observable.of((0,A.addAnugaMeshRegion)()),o().Observable.of((0,A.addNetwork)()),o().Observable.of((0,A.addCatchment)()),o().Observable.of((0,A.addNodes)()),o().Observable.of((0,A.addLinks)()))}))}))},b=function(t,n){return t.ofType(A.START_ANUGA_ELEVATION_POLLING).switchMap((function(){return o().Observable.timer(0,6e3).takeUntil(t.ofType(A.STOP_ANUGA_ELEVATION_POLLING)).switchMap((function(){var t,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/elevation/available/"))).catch((function(t){return t}))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){var e,r,a,i,l,d,v,_,p,E;return(null===(e=t.data)||void 0===e?void 0:e.length)<2?o().Observable.empty():o().Observable.concat(o().Observable.of((0,A.stopAnugaElevationPolling)()),o().Observable.of((function(){var t,e,r,o=(null===(t=n.getState())||void 0===t||null===(e=t.layers)||void 0===e||null===(r=e.flat)||void 0===r?void 0:r.filter((function(t){return"wms"===t.type&&"background"!==t.group})))||[];return(0,u.oZ)(o)})),o().Observable.of((0,u.A4)(t.data[0])),o().Observable.of((0,u.A4)(null===(r=t.data)||void 0===r?void 0:r[1])),o().Observable.of((0,c.Px)(null===(a=t.data[0])||void 0===a||null===(i=a.bbox)||void 0===i?void 0:i.bounds,null===(l=t.data[0])||void 0===l||null===(d=l.bbox)||void 0===d?void 0:d.crs,20)),o().Observable.of((0,f.updateUploadStatus)("Complete")),o().Observable.of((0,s.nY)()),o().Observable.of((0,A.initAnuga)()),o().Observable.of((0,A.startAnugaModelCreationPolling)()),o().Observable.of((function(){var t,e,r,o=(null===(t=n.getState())||void 0===t||null===(e=t.layers)||void 0===e||null===(r=e.flat)||void 0===r?void 0:r.filter((function(t){return"wms"===t.type&&"background"!==t.group})))||[];return(0,u.oZ)(o)})),o().Observable.of((0,u.Dv)("Input Data.Elevations","Input Data",null===(v=n.getState())||void 0===v||null===(_=v.layers.groups.filter((function(t){return"Input Data"===t.id})))||void 0===_||null===(p=_[0])||void 0===p||null===(E=p.nodes)||void 0===E?void 0:E.length)))}))}))},N=function(t,n){return t.ofType(A.START_ANUGA_SCENARIO_POLLING).switchMap((function(){return o().Observable.timer(0,8e3).takeUntil(t.ofType(A.STOP_ANUGA_SCENARIO_POLLING)).switchMap((function(){var t,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/scenario/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return o().Observable.of((0,A.setAnugaPollingData)(t.data)).switchMap((function(t){var e,r,a,i,l,c,s,d,f,v,_,p,E,g,S,O,b,N,T,y,m,U,R,D,I,h,C,M,w,P,G,L=(null===(e=t.scenarios)||void 0===e?void 0:e.filter((function(t){var n;return"complete"===(null===(n=t.latest_run)||void 0===n?void 0:n.status)}))).filter((function(t){var e,r,o;return null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(o=r.scenarios)||void 0===o?void 0:o.filter((function(e){var r,o,a,i,u,l,c,s,d,A,f,v=(null==e?void 0:e.id)===t.id,_=!e.isLoaded,p=(r=e,d=null==(o=n.getState())||null===(a=o.layers)||void 0===a||null===(i=a.flat)||void 0===i?void 0:i.filter((function(t){var n,e;return t.name===(null==r||null===(n=r.latest_run)||void 0===n||null===(e=n.gn_layer_depth_max)||void 0===e?void 0:e.name)})),A=null==o||null===(u=o.layers)||void 0===u||null===(l=u.flat)||void 0===l?void 0:l.filter((function(t){var n,e;return t.name===(null==r||null===(n=r.latest_run)||void 0===n||null===(e=n.gn_layer_depth_integrated_velocity_max)||void 0===e?void 0:e.name)})),f=null==o||null===(c=o.layers)||void 0===c||null===(s=c.flat)||void 0===s?void 0:s.filter((function(t){var n,e;return t.name===(null==r||null===(n=r.latest_run)||void 0===n||null===(e=n.gn_layer_velocity_max)||void 0===e?void 0:e.name)})),!(null!=d&&d.length&&null!=A&&A.length&&null!=f&&f.length));return v&&_&&p?t:null}))[0]}))[0],j=null===(r=n.getState())||void 0===r||null===(a=r.layers)||void 0===a||null===(i=a.flat)||void 0===i?void 0:i.map((function(t){return null==t?void 0:t.name})),k=(null===(l=n.getState())||void 0===l||null===(c=l.layers)||void 0===c||null===(s=c.flat)||void 0===s?void 0:s.filter((function(t){return"wms"===(null==t?void 0:t.type)&&"background"!==(null==t?void 0:t.group)})))||[],H=[null==L||null===(d=L.latest_run)||void 0===d||null===(f=d.gn_layer_depth_integrated_velocity_max)||void 0===f?void 0:f.title,null==L||null===(v=L.latest_run)||void 0===v||null===(_=v.gn_layer_depth_max)||void 0===_?void 0:_.title,null==L||null===(p=L.latest_run)||void 0===p||null===(E=p.gn_layer_velocity_max)||void 0===E?void 0:E.title],F=null===(g=n.getState())||void 0===g||null===(S=g.layers)||void 0===S||null===(O=S.flat)||void 0===O?void 0:O.filter((function(t){return H.includes(null==t?void 0:t.title)}));return console.log("remove these existingResultLayers:",F),L&&null!=L&&null!==(b=L.latest_run)&&void 0!==b&&null!==(N=b.gn_layer_depth_integrated_velocity_max)&&void 0!==N&&N.catalogURL&&null!=L&&null!==(T=L.latest_run)&&void 0!==T&&null!==(y=T.gn_layer_depth_max)&&void 0!==y&&y.catalogURL&&null!=L&&null!==(m=L.latest_run)&&void 0!==m&&null!==(U=m.gn_layer_velocity_max)&&void 0!==U&&U.catalogURL&&!j.includes(null==L||null===(R=L.latest_run)||void 0===R||null===(D=R.gn_layer_depth_integrated_velocity_max)||void 0===D?void 0:D.name)&&!j.includes(null==L||null===(I=L.latest_run)||void 0===I||null===(h=I.gn_layer_depth_max)||void 0===h?void 0:h.name)&&!j.includes(null==L||null===(C=L.latest_run)||void 0===C||null===(M=C.gn_layer_velocity_max)||void 0===M?void 0:M.name)?o().Observable.concat(o().Observable.of((0,u.$o)(null==F||null===(w=F[0])||void 0===w?void 0:w.id)),o().Observable.of((0,u.$o)(null==F||null===(P=F[1])||void 0===P?void 0:P.id)),o().Observable.of((0,u.$o)(null==F||null===(G=F[2])||void 0===G?void 0:G.id)),o().Observable.of((0,A.setAnugaPollingData)(t.scenarios)),o().Observable.of((0,u.A4)(L.latest_run.gn_layer_depth_integrated_velocity_max)),o().Observable.of((0,u.A4)(L.latest_run.gn_layer_depth_max)),o().Observable.of((0,u.A4)(L.latest_run.gn_layer_velocity_max)),o().Observable.of((0,A.setAnugaScenarioResultsLoaded)(null==L?void 0:L.id,!0)),o().Observable.of((0,u.oZ)(k))):o().Observable.of((0,A.setAnugaPollingData)(t.scenarios))}))}))}))}))},T=function(t,n){return t.ofType(A.DELETE_ANUGA_SCENARIO).concatMap((function(t){var e,r,a;return o().Observable.from(i().delete("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/scenario/").concat(t.scenario.id,"/")))})).concatMap((function(t){return o().Observable.of((0,A.deleteAnugaScenarioSuccess)(t.data))}))},y=function(t,n){return t.ofType(A.RUN_ANUGA_SCENARIO).concatMap((function(t){var e,r,a;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/scenario/").concat(t.scenario.id,"/run/"),t).then((function(t){return(0,A.runAnugaScenarioSuccess)(t.data)})))})).concatMap((function(){return o().Observable.of((0,A.setAnugaScenarioMenu)(!0))}))},m=function(t,n){return t.ofType(A.CANCEL_ANUGA_RUN).concatMap((function(t){var e,r,a;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/scenario/").concat(t.scenario.id,"/run/"),t))})).concatMap((function(t){var e,r,a;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/scenario/").concat(t.scenario.id,"/cancel/"),{runId:t.scenario.latest_run.id}))})).concatMap((function(){return o().Observable.of((0,l.show)({message:"cancelling..."},"warning"))}))},U=function(t,n){return t.ofType(A.SAVE_ANUGA_SCENARIO).switchMap((function(t){var e,r,a,u,l,c;return t.scenario.log=t.scenario.log||"anuga log",t.scenario.id?o().Observable.from(i().put("/anuga/api/".concat(null===(u=n.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,"/scenario/").concat(t.scenario.id,"/"),t.scenario).then((function(t){return(0,A.saveAnugaScenarioSuccess)(t.data)})).catch((function(t){return(0,A.saveAnugaScenarioError)(t)}))):o().Observable.from(i().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/scenario/"),t.scenario).then((function(t){return(0,A.saveAnugaScenarioSuccess)(t.data)})).catch((function(t){return(0,A.saveAnugaScenarioError)(t)})))}))},R=function(t,n){return t.ofType(A.COMPARE_SCENARIOS).concatMap((function(t){var e,r,a;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/scenario/compare/"),t.scenarios).then((function(t){return(0,A.compareScenariosSuccess)(t.data)})))}))},D=function(t,n){return t.ofType(f.SET_OPEN_MENU_GROUP_ID).filter((function(t){return"Results"===(null==t?void 0:t.openMenuGroupId)})).switchMap((function(){return o().Observable.timer(0,1e4).takeUntil(t.ofType(A.STOP_COMPARISON_POLLING)).switchMap((function(){return o().Observable.concat(o().Observable.of((0,A.addComparison)()))}))}))},I=function(t,n){return t.ofType(A.RUN_NETWORK).concatMap((function(t){var e,r,a;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/network/").concat(t.network.id,"/run/"),t.network).then((function(t){return(0,A.runNetworkSuccess)(t.data)})))})).concatMap((function(){return o().Observable.of((0,A.setNetworkMenu)(!0))}))},h=function(t,n){return t.ofType(A.CREATE_ANUGA_BOUNDARY).switchMap((function(t){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/boundary/"),{project:null===(u=n.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.boundaryTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return o().Observable.of((0,A.addAnugaBoundary)())}))},C=function(t,n){return t.ofType(A.ADD_ANUGA_BOUNDARY).switchMap((function(){var t,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/boundary/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return g(t,n)}))}))},M=function(t,n){return t.ofType(A.ADD_COMPARISON).switchMap((function(){var t,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/comparison/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return g(t,n)}))}))},w=function(t,n){return t.ofType(A.CREATE_ANUGA_FRICTION).switchMap((function(t){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/friction/"),{project:null===(u=n.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.frictionTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return o().Observable.of((0,A.addAnugaFriction)())}))},P=function(t,n){return t.ofType(A.ADD_ANUGA_FRICTION).switchMap((function(){var t,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/friction/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return g(t,n)}))}))},G=function(t,n){return t.ofType(A.CREATE_ANUGA_INFLOW).switchMap((function(t){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/inflow/"),{project:null===(u=n.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.inflowTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return o().Observable.of((0,A.addAnugaInflow)())}))},L=function(t,n){return t.ofType(A.ADD_ANUGA_INFLOW).switchMap((function(){var t,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/inflow/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return g(t,n)}))}))},j=function(t,n){return t.ofType(A.CREATE_ANUGA_STRUCTURE).switchMap((function(t){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/structure/"),{project:null===(u=n.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.structureTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return o().Observable.of((0,A.addAnugaStructure)())}))},k=function(t,n){return t.ofType(A.ADD_ANUGA_STRUCTURE).switchMap((function(){var t,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/structure/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return g(t,n)}))}))},H=function(t,n){return t.ofType(A.ADD_ANUGA_FULL_MESH).switchMap((function(){var t,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/full-mesh/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return g(t,n)}))}))},F=function(t,n){return t.ofType(A.ADD_ANUGA_MESH_REGION).switchMap((function(){var t,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/mesh-region/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return g(t,n)}))}))},W=function(t,n){return t.ofType(A.ADD_LUMPED_CATCHMENT).switchMap((function(){var t,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/catchment/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return g(t,n)}))}))},x=function(t,n){return t.ofType(A.ADD_NODES).switchMap((function(){var t,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/nodes/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return g(t,n)}))}))},V=function(t,n){return t.ofType(A.ADD_LINKS).switchMap((function(){var t,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/links/available/")).catch((function(t){return t}))).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){return g(t,n)}))}))},K=function(t,n){return t.ofType(A.CREATE_ANUGA_MESH_REGION).switchMap((function(t){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/mesh-region/"),{project:null===(u=n.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.meshRegionTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return o().Observable.of((0,A.addAnugaMeshRegion)())}))},B=function(t,n){return t.ofType(A.CREATE_NETWORK).switchMap((function(t){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/network/"),{project:null===(u=n.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.networkTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return o().Observable.of((0,A.addNetwork)())}))},Y=function(t,n){return t.ofType(A.CREATE_FIGURE).switchMap((function(t){var e,r,a;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/publication/").concat(t.publicationId,"/create-figure/"),{title:t.figureTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(t){var n;return console.log("response1:",t),window.open(null==t||null===(n=t.data)||void 0===n?void 0:n.detail_url,"_blank").focus(),o().Observable.of((0,A.initAnuga)())}))},Z=function(t,n){return t.ofType(A.CREATE_LUMPED_CATCHMENT).switchMap((function(t){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/catchment/"),{project:null===(u=n.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.catchmentTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return o().Observable.of((0,A.addCatchment)())}))},J=function(t,n){return t.ofType(A.CREATE_NODES).switchMap((function(t){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/nodes/"),{project:null===(u=n.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.nodesTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return o().Observable.of((0,A.addNodes)())}))},$=function(t,n){return t.ofType(A.CREATE_LINKS).switchMap((function(t){var e,r,a,u,l,c;return o().Observable.from(i().post("/anuga/api/".concat(null===(e=n.getState())||void 0===e||null===(r=e.anuga)||void 0===r||null===(a=r.projectData)||void 0===a?void 0:a.id,"/links/"),{project:null===(u=n.getState())||void 0===u||null===(l=u.anuga)||void 0===l||null===(c=l.projectData)||void 0===c?void 0:c.id,title:t.linksTitle}).catch((function(t){return t})))})).filter((function(t){return(null==t?void 0:t.status)<=400})).switchMap((function(){return o().Observable.of((0,A.addLinks)())}))},z=function(t,n){return t.ofType(A.UPDATE_COMPUTE_INSTANCE).switchMap((function(){var t,e,r;return o().Observable.from(i().get("/anuga/api/".concat(null===(t=n.getState())||void 0===t||null===(e=t.anuga)||void 0===e||null===(r=e.projectData)||void 0===r?void 0:r.id,"/compute-instance/"))).switchMap((function(t){return o().Observable.of((0,A.updateComputeInstanceSuccess)(t.data))}))}))},Q=function(t,n){return t.ofType(d.IN).concatMap((function(t){return o().Observable.of(t)})).filter((function(){return["geonode:bdy_","geonode:inf_","geonode:str_","geonode:fri_","geonode:mes_"].some((function(t){var e,r;return null===(e=n.getState())||void 0===e||null===(r=e.featuregrid)||void 0===r?void 0:r.selectedLayer.includes(t)}))})).concatMap((function(t){var e,r,a,i,u;return null!=t&&null!==(e=t.features)&&void 0!==e&&e[0]&&(null===(r=Object.keys(null==t||null===(a=t.features)||void 0===a?void 0:a[0]))||void 0===r?void 0:r.length)>0?o().Observable.empty():(t.features[0].properties={"geonode:bdy_":{location:"External",boundary:"Dirichlet"},"geonode:inf_":{type:"Rainfall",data:100},"geonode:str_":{method:"Holes"},"geonode:fri_":{manning:.035},"geonode:mes_":{resolution:10}}[null===(i=n.getState())||void 0===i||null===(u=i.featuregrid)||void 0===u?void 0:u.selectedLayer.substring(0,12)],o().Observable.of(t))}))},q=function(t,n){return t.ofType(f.UPDATE_DATASET_TITLE).switchMap((function(t){return o().Observable.from(i().get("/api/v2/datasets?search=".concat(t.datasetName.split("geonode:")[1],"&search_fields=name"))).switchMap((function(e){var r,a,u,l,c,s,d,A=parseInt(null==e||null===(r=e.data)||void 0===r||null===(a=r.datasets)||void 0===a||null===(u=a[0])||void 0===u?void 0:u.pk,10),f=null===(l=(0,v.Z7)(null==n?void 0:n.getState()).filter((function(t){return t.gn_layer===A})))||void 0===l?void 0:l[0];return o().Observable.from(i().patch("/anuga/api/".concat(null===(c=n.getState())||void 0===c||null===(s=c.anuga)||void 0===s||null===(d=s.projectData)||void 0===d?void 0:d.id,"/").concat(f.apiKey,"/").concat(f.id,"/"),{title:t.newTitle}))})).switchMap((function(){return o().Observable.empty()}))}))},X=function(t,n){return n.getState,t.ofType(A.UPDATE_ANUGA_RESOURCES).switchMap((function(t){return t.action,o().Observable.defer((function(){return i().get((0,p.zL)("/anuga/api/project/"),{params:{page_size:100,page:1}}).then((function(t){return t.data}))})).switchMap((function(t){var n,e,r;return o().Observable.of((0,A.setAnugaResources)({projects:(r=t,function(t){if(Array.isArray(t))return E(t)}(r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,n){if(t){if("string"==typeof t)return E(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?E(t,n):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),isNextPageAvailable:!(null==t||null===(n=t.links)||void 0===n||!n.next),isPreviousPageAvailable:!(null==t||null===(e=t.links)||void 0===e||!e.previous),loading:!1}))})).catch((function(t){return o().Observable.of((0,_.mN)(t.data||t.message),(0,A.setAnugaResources)({loading:!1}))})).startWith((0,A.setAnugaResources)({loading:!0}))}))}},375501:(t,n,e)=>{"use strict";e.d(n,{Z:()=>d});var r=e(368658),o=e(351288);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function i(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return u(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?u(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function l(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function c(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?l(Object(e),!0).forEach((function(n){var r,o,i,u;r=t,o=n,i=e[n],u=function(t,n){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o),(o="symbol"==a(u)?u:String(u))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):l(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}var s={showAddAnugaElevationData:!1,visibleAnugaScenarioLogId:!1,scenarios:[]};const d=function(){var t,n,e,a,u,l,d,A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,f=arguments.length>1?arguments[1]:void 0;switch(console.log("Action for Anuga: ",f),f.type){case r.SET_CREATING_ANUGA_LAYER:return c(c({},A),{},{isCreatingAnugaLayer:f.isCreatingAnugaLayer});case r.SET_ANUGA_RESOURCES:return console.log("** anugaHomePageResources",f.data),c(c({},A),{},{anugaHomePageResources:c(c({},f.data),{},{projects:null===(t=f.data)||void 0===t||null===(n=t.projects)||void 0===n?void 0:n.map((function(t){return null==t?void 0:t.base_map_full})).filter((function(t){return!t.featured}))})});case r.UPDATE_ANUGA_SCENARIO:return c(c({},A),{},{scenarios:A.scenarios.map((function(t){return t.id===f.scenario.id?(f.scenario.unsaved=!0,f.scenario):t}))});case r.UPDATE_NETWORK:return c(c({},A),{},{networks:A.networks.map((function(t){return t.id===f.network.id?(f.network.unsaved=!0,f.network):t}))});case r.TOGGLE_SCENARIO_SELECTED:return c(c({},A),{},{scenarios:A.scenarios.map((function(t){return t.id===f.scenario.id?(f.scenario.selected=!t.selected,f.scenario):t}))});case r.SET_ANUGA_POLLING_DATA:var v=A.scenarios.map((function(t){var n=f.scenarios.filter((function(n){return t.id===n.id}))[0];return t.latest_run=c({},null==n?void 0:n.latest_run),t.status=(null==n?void 0:n.status)||"unsaved",t.latest_run_is_valid=null==n?void 0:n.latest_run_is_valid,t})),_=null===(e=A.scenarios)||void 0===e?void 0:e.map((function(t){return null==t?void 0:t.id})),p=null===(a=f.scenarios)||void 0===a||null===(u=a.filter((function(t){return!_.includes(t.id)})))||void 0===u?void 0:u[0];return p&&(v=[].concat(i(v),[p])),c(c({},A),{},{scenarios:v,selectedScenario:f.scenarios.filter((function(t){return A.selectedScenarioId===t.id}))[0]});case r.ADD_ANUGA_SCENARIO:return c(c({},A),{},{scenarios:[].concat(i(A.scenarios),[{id:null,name:"",code:null,description:"",maximum_triangle_area:1e3,constant_rainfall:null,duration:null,status:"new",project:null==A||null===(l=A.projectData)||void 0===l?void 0:l.id,boundary:"",elevation:"",log:"log placeholder",unsaved:!1,selected:!1}])});case r.SET_ANUGA_SCENARIO_IS_LOADED:return c(c({},A),{},{scenarios:A.scenarios.map((function(t){return t.id===f.scenarioId?(t.isLoaded=f.isLoaded,t):t}))});case r.SHOW_ANUGA_SCENARIO_LOG:return c(c({},A),{},{visibleAnugaScenarioLogId:f.scenarioId});case r.SHOW_ANUGA_RUN_MENU:return c(c({},A),{},{visibleAnugaRunMenu:f.visible});case r.SAVE_ANUGA_SCENARIO_SUCCESS:return c(c({},A),{},{scenarios:A.scenarios.map((function(t){return t.id===f.scenario.id?(f.scenario.unsaved=!1,f.scenario):t.id?t:f.scenario}))});case r.SELECT_ANUGA_SCENARIO:return c(c({},A),{},{selectedScenarioId:f.scenario.id,selectedScenario:f.scenario});case r.SET_ANUGA_PROJECT_DATA:return c(c({},A),{},{projectData:f.data});case r.SET_ANUGA_SCENARIO_DATA:return 0===A.scenarios.length?c(c({},A),{},{scenarios:f.scenarios}):c(c({},A),{},{scenarios:null===(d=A.scenarios)||void 0===d?void 0:d.map((function(t){var n;return t.unsaved?c(c({},f.scenario),{},{unsaved:!0}):(null==t?void 0:t.id)===(null===(n=f.scenario)||void 0===n?void 0:n.id)?(f.scenario.unsaved=!1,f.scenario):t}))});case r.UPDATE_COMPUTE_INSTANCE_SUCCESS:return c(c({},A),{},{computeInstances:f.data});case r.SET_COMPARISON_DATA:return c(c({},A),{},{comparisons:f.data});case r.SET_ANUGA_INFLOW_DATA:return c(c({},A),{},{inflows:f.data});case r.SET_ANUGA_FRICTION_DATA:return c(c({},A),{},{frictions:f.data});case r.SET_ANUGA_STRUCTURE_DATA:return c(c({},A),{},{structures:f.data});case r.SET_ANUGA_BOUNDARY_DATA:return c(c({},A),{},{boundaries:f.data});case r.SET_ANUGA_ELEVATION_DATA:return c(c({},A),{},{elevations:f.data});case r.SET_ANUGA_FULL_MESH_DATA:return c(c({},A),{},{fullMeshes:f.data});case r.SET_ANUGA_MESH_REGION_DATA:return c(c({},A),{},{meshRegions:f.data});case r.SET_NETWORK_DATA:return c(c({},A),{},{networks:f.data});case r.SET_LUMPED_CATCHMENT_DATA:return c(c({},A),{},{catchments:f.data});case r.SET_ANUGA_NODES_DATA:return c(c({},A),{},{nodes:f.data});case r.SET_ANUGA_LINKS_DATA:return c(c({},A),{},{links:f.data});case r.SET_PUBLICATION_DATA:return c(c({},A),{},{publications:f.data});case o.SET_OPEN_MENU_GROUP_ID:return f.openMenuGroupId?c(c({},A),{},{showAnugaInputMenu:!1,showAnugaScenarioMenu:!1,showAnugaResultMenu:!1}):A;case r.SET_ANUGA_INPUT_MENU:return c(c({},A),{},{showAnugaInputMenu:f.visible,showAnugaScenarioMenu:!1,showAnugaResultMenu:!1,showNetworkMenu:!1,showReviewPanel:!1,showPublicationPanel:!1});case r.SET_ANUGA_SCENARIO_MENU:return c(c({},A),{},{showAnugaInputMenu:!1,showAnugaScenarioMenu:f.visible,showAnugaResultMenu:!1,showNetworkMenu:!1,showReviewPanel:!1,showPublicationPanel:!1});case r.SET_ANUGA_RESULT_MENU:return c(c({},A),{},{showAnugaScenarioMenu:!1,showAnugaInputMenu:!1,showAnugaResultMenu:f.visible,showNetworkMenu:!1,showReviewPanel:!1,showPublicationPanel:!1});case r.SET_NETWORK_MENU:return c(c({},A),{},{showAnugaInputMenu:!1,showAnugaScenarioMenu:!1,showAnugaResultMenu:!1,showNetworkMenu:f.visible,showReviewPanel:!1,showPublicationPanel:!1});case r.SET_REVIEW_PANEL:return c(c({},A),{},{showAnugaInputMenu:!1,showAnugaScenarioMenu:!1,showAnugaResultMenu:!1,showNetworkMenu:!1,showReviewPanel:f.visible,showPublicationPanel:!1});case r.SET_PUBLICATION_PANEL:return c(c({},A),{},{showAnugaInputMenu:!1,showAnugaScenarioMenu:!1,showAnugaResultMenu:!1,showNetworkMenu:!1,showReviewPanel:!1,showPublicationPanel:f.visible});default:return A}}},926036:(t,n,e)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function a(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?o(Object(e),!0).forEach((function(n){var o,a,i,u;o=t,a=n,i=e[n],u=function(t,n){if("object"!=r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var o=e.call(t,"string");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(a),(a="symbol"==r(u)?u:String(u))in o?Object.defineProperty(o,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[a]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):o(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}e.d(n,{rP:()=>i,Dh:()=>u,mn:()=>l,Z7:()=>c});var i=function(t){var n,e,r,o,a,i,u=null==t||null===(n=t.security)||void 0===n||null===(e=n.user)||void 0===e?void 0:e.pk,l=null==t||null===(r=t.gnresource)||void 0===r||null===(o=r.compactPermissions)||void 0===o||null===(a=o.users)||void 0===a||null===(i=a.filter((function(t){return t.id===u}))[0])||void 0===i?void 0:i.permissions;return["view","edit","manage","owner"].includes(l)},u=function(t){var n,e,r,o,a,i,u=null==t||null===(n=t.security)||void 0===n||null===(e=n.user)||void 0===e?void 0:e.pk,l=null==t||null===(r=t.gnresource)||void 0===r||null===(o=r.compactPermissions)||void 0===o||null===(a=o.users)||void 0===a||null===(i=a.filter((function(t){return t.id===u}))[0])||void 0===i?void 0:i.permissions;return["edit","manage","owner"].includes(l)},l=function(t){var n;return null==t||null===(n=t.anuga)||void 0===n?void 0:n.scenarios.filter((function(t){return null==t?void 0:t.selected}))},c=function(t){var n={elevations:"elevation",boundaries:"boundary",frictions:"friction",inflows:"inflow",meshRegions:"mesh-region",structures:"structure",catchments:"catchment",nodes:"nodes",links:"links"},e=Array();return["elevations","boundaries","frictions","inflows","meshRegions","structures","catchments","nodes","links"].map((function(r){var o;null==t||null===(o=t.anuga)||void 0===o||o[r].map((function(t){e.push(a(a({},t),{},{apiKey:n[r]}))}))})),e}}}]);