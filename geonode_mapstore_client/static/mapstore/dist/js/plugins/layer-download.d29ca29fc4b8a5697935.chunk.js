(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[62426],{580416:(e,t,r)=>{"use strict";r.d(t,{yS:()=>n,Zz:()=>o,ms:()=>a,ih:()=>i,OX:()=>l,sb:()=>s,K$:()=>c,k7:()=>u,cX:()=>p,x9:()=>d,vs:()=>f,oE:()=>y,Po:()=>m,qv:()=>b,cI:()=>v,g6:()=>O,I4:()=>h,l$:()=>g,Xv:()=>w,k3:()=>E,CQ:()=>S,R8:()=>R,HN:()=>P,sH:()=>A,c7:()=>j,_7:()=>D,eF:()=>T,O6:()=>N,ED:()=>x,RP:()=>C,sF:()=>L,VP:()=>_,He:()=>F,vO:()=>I,WO:()=>k,bh:()=>G,pV:()=>M,MK:()=>Z,ZF:()=>W,tV:()=>Y,Dv:()=>B,Yz:()=>U,kI:()=>X,XG:()=>V,A4:()=>q,Rp:()=>H,$o:()=>z,ct:()=>K,oZ:()=>Q,oh:()=>$,$h:()=>J,ud:()=>ee,Qr:()=>te,LR:()=>re,nN:()=>ne,UG:()=>oe,F5:()=>ae,c9:()=>ie,Jh:()=>le,Xy:()=>se});var n="CHANGE_LAYER_PROPERTIES",o="LAYERS:CHANGE_LAYER_PARAMS",a="CHANGE_GROUP_PROPERTIES",i="TOGGLE_NODE",l="SORT_NODE",s="REMOVE_NODE",c="UPDATE_NODE",u="MOVE_NODE",p="LAYER_LOADING",d="LAYER_LOAD",f="LAYER_ERROR",y="ADD_LAYER",m="ADD_GROUP",b="REMOVE_LAYER",v="SHOW_SETTINGS",O="HIDE_SETTINGS",h="UPDATE_SETTINGS",g="REFRESH_LAYERS",w="LAYERS:UPDATE_LAYERS_DIMENSION",E="LAYERS_REFRESHED",S="LAYERS_REFRESH_ERROR",R="LAYERS:BROWSE_DATA",P="LAYERS:DOWNLOAD",A="LAYERS:CLEAR_LAYERS",j="LAYERS:SELECT_NODE",D="LAYERS:FILTER_LAYERS",T="LAYERS:SHOW_LAYER_METADATA",N="LAYERS:HIDE_LAYER_METADATA",x="LAYERS:UPDATE_SETTINGS_PARAMS";function C(e,t,r){return{type:v,node:e,nodeType:t,options:r}}function L(){return{type:O}}function _(e){return{type:h,options:e}}function F(e,t){return{type:n,newProperties:t,layer:e}}function I(e,t){return{type:o,layer:e,params:t}}function k(e,t){return{type:a,newProperties:t,group:e}}function G(e,t,r){return{type:i,node:e,nodeType:t,status:!r}}function M(e){return{type:"CONTEXT_NODE",node:e}}function Z(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:l,node:e,order:t,sortLayers:r}}function W(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:s,node:e,nodeType:t,removeEmpty:r}}function Y(e,t,r){return{type:c,node:e,nodeType:t,options:r}}function B(e,t,r){return{type:u,node:e,groupId:t,index:r}}function U(e){return{type:p,layerId:e}}function X(e,t){return{type:d,layerId:e,error:t}}function V(e,t,r){return{type:f,layerId:e,tilesCount:t,tilesErrorCount:r}}function q(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{type:y,layer:e,foreground:t}}function H(e,t,r){return{type:m,group:e,parent:t,options:r}}function z(e){return{type:b,layerId:e}}function K(e,t){return{type:n,layer:e,newProperties:{_v_:t||(new Date).getTime()}}}function Q(e,t){return{type:g,layers:e,options:t}}function $(e){return{type:E,layers:e}}function J(e,t){return{type:S,layers:e,error:t}}function ee(e,t,r,n){return{type:w,dimension:e,value:t,options:r,layers:n}}function te(e){return{type:R,layer:e}}function re(e){return{type:P,layer:e}}function ne(){return{type:A}}function oe(e,t,r){return{type:j,id:e,nodeType:t,ctrlKey:r}}function ae(e){return{type:D,text:e}}function ie(e,t){return{type:T,metadataRecord:e,maskLoading:t}}function le(){return{type:N}}function se(e,t){return{type:x,newParams:e,update:t}}},95797:(e,t,r)=>{"use strict";r.d(t,{DR:()=>n,S0:()=>o,u7:()=>a,lj:()=>i,yz:()=>l,lN:()=>s,zW:()=>c,Yx:()=>u,VN:()=>p,Hu:()=>d,VT:()=>f,RD:()=>y,Qq:()=>m,R1:()=>b,_T:()=>v,vO:()=>O,XO:()=>h,jG:()=>g,Xc:()=>w,gT:()=>E,rG:()=>S,t3:()=>R,Fs:()=>P,w_:()=>A,Lm:()=>j,rh:()=>D,rP:()=>T,IO:()=>N,zc:()=>x}),r(375875);var n="LAYER_SELECTED_FOR_SEARCH",o="FEATURE_TYPE_SELECTED",a="FEATURE_TYPE_LOADED",i="FEATURE_LOADED",l="FEATURE_LOADING",s="FEATURE_TYPE_ERROR",c="FEATURE_ERROR",u="QUERY_CREATE",p="QUERY:UPDATE_QUERY",d="QUERY_RESULT",f="QUERY_ERROR",y="RESET_QUERY",m="QUERY",b="INIT_QUERY_PANEL",v="QUERY:TOGGLE_SYNC_WMS",O="QUERY:TOGGLE_LAYER_FILTER";function h(){return{type:v}}function g(){return{type:O}}function w(){return{type:b}}function E(e,t){return{type:o,url:e,typeName:t}}function S(e,t){return{type:a,typeName:e,featureType:t}}function R(e,t){return{type:s,typeName:e,error:t}}function P(e){return{type:l,isLoading:e}}function A(e,t,r,n,o){return{type:d,searchUrl:t,filterObj:r,result:e,queryOptions:n,reason:o}}function j(e){return{type:f,error:e}}function D(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.updates,r=e.reason,n=e.useLayerFilter;return{type:p,updates:t,reason:r,useLayerFilter:n}}function T(e,t){return{type:u,searchUrl:e,filterObj:t}}function N(e,t,r,n){return{type:m,searchUrl:e,filterObj:t,queryOptions:r,reason:n}}function x(){return{type:y}}},921533:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(867076),o=r(815135),a=r(159979),i=["renderPopover","popoverOptions"];function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const c=(0,n.compose)((0,n.withProps)((function(e){var t=e.renderPopover,r=e.popoverOptions;return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}(t?{renderPopover:t,popoverOptions:r}:{},function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,i))})),(0,n.branch)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.renderPopover,r=e.popoverOptions;return t&&!!r}),a.Z,o.Z))},159979:(e,t,r)=>{"use strict";r.d(t,{Z:()=>h});var n=r(124852),o=r.n(n),a=r(352595),i=r(724469),l=r(957557),s=r.n(l),c=r(180307),u=r.n(c);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var d=["popoverOptions","keyProp"];function f(){return(f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function b(e,t){return(b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const h=function(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(h,t);var r,n,l,c,p=(l=h,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=O(l);if(c){var r=O(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return v(this,e)});function h(){return y(this,h),p.apply(this,arguments)}return r=h,(n=[{key:"render",value:function(){var t=null,r=this.props,n=r.popoverOptions,l=r.keyProp,c=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(r,d);return o().createElement("span",{className:"mapstore-info-popover"},o().createElement(e,f({},s()(c,["renderPopover","tooltipId"]),{key:l,ref:function(e){t=e}})),o().createElement(a.Z,{placement:n.placement,shouldUpdatePosition:!0,show:!0,target:function(){return u().findDOMNode(t)}},o().createElement(i.Popover,n.props,n.content)))}}])&&m(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),h}(o().Component)}},656903:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(124852),o=r.n(n),a=r(724469),i=r(38560),l=["disabled","id","visible","onClick","glyph","active","className"];function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var c={width:0,padding:0,borderWidth:0},u={},p=function(e){return e?u:c};const d=(0,n.forwardRef)((function(e,t){var r=e.disabled,n=e.id,c=e.visible,u=e.onClick,d=e.glyph,f=e.active,y=e.className,m=void 0===y?"square-button-md":y,b=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,l);return o().createElement(i.Z,s({ref:t},b,{bsStyle:f?"success":"primary",disabled:r,id:"fg-".concat(n),style:p(c),className:m,onClick:function(){return!r&&u()}}),o().createElement(a.Glyphicon,{glyph:d}))}))},38560:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var n=r(724469),o=r(124852),a=r.n(o),i=r(294184),l=r.n(i),s=["disabled","className","onClick"];function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}const u=(p=n.Button,a().forwardRef((function(e,t){var r=e.disabled,n=e.className,o=e.onClick,i=void 0===o?function(){}:o,u=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,s);return a().createElement(p,c({ref:t,className:r?l()("disabled",n):n,onClick:function(){r||i.apply(void 0,arguments)}},u),u.children)})));var p},807472:(e,t,r)=>{"use strict";r.d(t,{Z:()=>P});var n=r(727418),o=r.n(n),a=r(45697),i=r.n(a),l=r(124852),s=r.n(l),c=r(485294),u=r.n(c),p=r(472986),d=r.n(p),f=r(805346);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return w(e)}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(l,e);var t,r,n,a,i=(n=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E(n);if(a){var r=E(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return g(this,e)});function l(){var e;v(this,l);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return S(w(e=i.call.apply(i,[this].concat(r))),"renderLoading",(function(){return e.props.maskLoading?s().createElement("div",{style:{width:"100%",height:"100%",position:"absolute",overflow:"visible",margin:"auto",verticalAlign:"center",left:"0",background:"rgba(255, 255, 255, 0.5)",zIndex:2}},s().createElement("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -40%)"}},s().createElement(f.Z,{msgId:"loading"}),s().createElement(d(),{spinnerName:"circle",noFadeIn:!0,overrideSpinnerClassName:"spinner"}))):null})),S(w(e),"renderRole",(function(t){return s().Children.toArray(e.props.children).filter((function(e){return e.props.role===t}))})),S(w(e),"hasRole",(function(t){return s().Children.toArray(e.props.children).filter((function(e){return e.props.role===t})).length>0})),S(w(e),"onClickOut",(function(t){e.props.onClickOut&&e.mask===t.target&&e.props.onClickOut(t)})),e}return t=l,(r=[{key:"render",value:function(){var e=this,t=s().createElement("div",{id:this.props.id,style:b({},this.props.style),className:"".concat(this.props.draggable?"modal-dialog-draggable":""," ").concat(this.props.className," modal-dialog-container")},s().createElement("div",{className:this.props.headerClassName+" draggable-header"},this.renderRole("header")),s().createElement("div",{className:this.props.bodyClassName},this.renderLoading(),this.renderRole("body")),this.hasRole("footer")?s().createElement("div",{className:this.props.footerClassName},this.renderRole("footer")):s().createElement("span",null)),r=this.props.draggable?s().createElement(u(),{defaultPosition:this.props.start,bounds:this.props.bounds,handle:".draggable-header, .draggable-header *"},t):t,n=o()({},this.props.style.display?{display:this.props.style.display}:{},this.props.backgroundStyle);return this.props.modal?s().createElement("div",{ref:function(t){e.mask=t},onClick:this.onClickOut,style:n,className:"fade in modal "+this.props.containerClassName,role:"dialog"},r):r}}])&&O(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(s().Component);S(R,"propTypes",{id:i().string.isRequired,style:i().object,backgroundStyle:i().object,className:i().string,maskLoading:i().bool,containerClassName:i().string,headerClassName:i().string,bodyClassName:i().string,footerClassName:i().string,onClickOut:i().func,modal:i().bool,start:i().object,draggable:i().bool,bounds:i().oneOfType([i().string,i().object])}),S(R,"defaultProps",{style:{},backgroundStyle:{background:"rgba(0,0,0,.5)"},start:{x:0,y:150},className:"modal-dialog modal-content",maskLoading:!1,containerClassName:"",headerClassName:"modal-header",bodyClassName:"modal-body",footerClassName:"modal-footer",modal:!1,draggable:!0,bounds:"parent"});const P=R},135400:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(124852),o=r.n(n),a=r(379313);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.style,r=void 0===t?{}:t,n=e.mainViewStyle,i=void 0===n?{}:n,s=e.contentStyle,c=void 0===s?{}:s,u=e.imageStyle,p=void 0===u?{}:u,d=e.glyph,f=void 0===d?"info-sign":d,y=e.iconFit,m=e.title,b=e.tooltip,v=e.tooltipId,O=e.description,h=e.content;return o().createElement("div",{className:"empty-state-container",style:l({height:y?"100%":void 0},r)},o().createElement("div",{key:"main-view",className:"empty-state-main-view",style:l({height:y?"100%":void 0},i)},f?o().createElement("div",{key:"glyph",className:"empty-state-image",style:l({height:y?"100%":void 0},p)},o().createElement(a.Z,{iconFit:y,tooltip:b,tooltipId:v,glyph:f})):null,m?o().createElement("h1",{key:"title"},m):null,O?o().createElement("p",{key:"description",className:"empty-state-description"},O):null),o().createElement("div",{key:"content",className:"empty-state-content",style:c},h))}},379313:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(124852),o=r.n(n),a=r(724469),i=r(496259),l=(0,r(815135).Z)(a.Glyphicon);const s=function(e){var t=e.glyph,r=void 0===t?"info-sign":t,n=e.tooltip,a=e.tooltipId,s=e.iconFit,c=e.padding,u=void 0===c?0:c,p=e.margin,d=void 0===p?0:p;return o().createElement(i.Z,null,(function(e){var t=e.width,i=e.height;return o().createElement(l,{glyph:r,tooltip:n,tooltipId:a,style:{display:"inline-block",padding:u+"px",margin:d+"px",textAlign:"center",fontSize:s?Math.min(t,i)-2*u-2*d:t-2*u-2*d}})}))}},532425:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(45697),o=r.n(n),a=r(124852),i=r.n(a);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var u=function(e){return e>100?"full":e>40?"medium":"small"},p=function(e){var t=e.size,r=e.style,n=void 0===r?{}:r,o=e.className,a=e.hidden;return i().createElement("div",{className:o,style:s({width:t,height:t,overflow:"hidden"},n)},!a&&i().createElement("div",{className:"mapstore-".concat(u(t),"-size-loader")}))};p.propTypes={size:o().number,className:o().string,style:o().object};const d=p},352595:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=(0,r(461365).Z)(r(724469).Overlay)},399534:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(461365),o=r(356936);const a=(0,n.Z)(o.h_)},982030:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(124852),o=r.n(n),a=r(623560),i=r.n(a),l=r(867076),s=r(135400);const c=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.Z;return(0,l.branch)(e,(function(){return function(e){return o().createElement(r,t&&i()(t)?t(e):t)}}))}},145869:(e,t,r)=>{"use strict";r.d(t,{Z:()=>m});var n=r(124852),o=r.n(n),a=r(45697),i=r.n(a);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,r,n,a,i=(n=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(n);if(a){var r=d(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return p(this,e)});function l(){return s(this,l),i.apply(this,arguments)}return t=l,(r=[{key:"render",value:function(){var e=this;return o().createElement("label",{className:"mapstore-switch-btn ".concat(this.props.className)},o().createElement("input",{type:"checkbox",disabled:this.props.disabled,checked:this.props.checked,onChange:function(){return e.props.onChange(!e.props.checked)}}),o().createElement("span",{onClick:function(){return e.props.onClick(!e.props.checked)},className:"m-slider"}))}}])&&c(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(o().Component);f(y,"propTypes",{disabled:i().bool,className:i().string,checked:i().bool,onChange:i().func,onClick:i().func}),f(y,"defaultProps",{className:"",checked:!1,onChange:function(){},onClick:function(){}});const m=y},472747:(e,t,r)=>{"use strict";r.d(t,{l:()=>s});var n=r(49977),o=r(375875),a=r.n(o),i=r(510284),l=r(199767),s=function(e,t){return n.Observable.defer((function(){return a().get((0,l.Jy)(e,{version:"1.0.0",REQUEST:"DescribeProcess",IDENTIFIER:t}),{timeout:5e3,headers:{Accept:"application/json","Content-Type":"application/xml"}})})).let(i.oB)}},725599:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Dr});var n={};r.r(n),r.d(n,{checkExportDataEntriesEpic:()=>hr,checkWPSAvailabilityEpic:()=>fr,closeExportDownload:()=>vr,fetchFormatsWFSDownload:()=>mr,openDownloadTool:()=>yr,resetExportDataResultsOnLogout:()=>wr,serializeCookieOnExportDataChange:()=>gr,setExportDataResultsOnLoginSuccessAndMapConfigLoaded:()=>Er,showInfoBubbleMessageEpic:()=>Or,startFeatureExportDownload:()=>br});var o=r(171703),a=r(22222),i="LAYERDOWNLOAD:CHECK_WPS_AVAILABILITY",l="LAYERDOWNLOAD:CHECKING_WPS_AVAILABILITY",s="LAYERDOWNLOAD:DOWNLOAD_FEATURES",c="LAYERDOWNLOAD:DOWNLOAD_FINISHED",u="LAYERDOWNLOAD:FORMAT_SELECTED",p="LAYERDOWNLOAD:CLEAR_DOWNLOAD_OPTIONS",d="LAYERDOWNLOAD:FORMAT_FETCH",f="LAYERDOWNLOAD:FORMAT_UPDATE",y="LAYERDOWNLOAD:SET_WPS_AVAILABLE",m="LAYERDOWNLOAD:SET_SERVICE",b="LAYERDOWNLOAD:SET_EXPORT_DATA_RESULTS",v="LAYERDOWNLOAD:ADD_EXPORT_DATA_RESULT",O="LAYERDOWNLOAD:UPDATE_EXPORT_DATA_RESULT",h="LAYERDOWNLOAD:REMOVE_EXPORT_DATA_RESULT",g="LAYERDOWNLOAD:REMOVE_EXPORT_DATA_RESULTS",w="LAYERDOWNLOAD:CHECK_EXPORT_DATA_ENTRIES",E="LAYERDOWNLOAD:CHECKING_EXPORT_DATA_ENTRIES",S="LAYERDOWNLOAD:SERIALIZE_COOKIE",R="LAYERDOWNLOAD:SHOW_INFO_BUBBLE_MESSAGE",P="LAYERDOWNLOAD:SHOW_INFO_BUBBLE",A="LAYERDOWNLOAD:SET_INFO_BUBBLE_MESSAGE",j=function(e){return{type:l,checking:e}},D=function(e,t){return{type:u,key:e,value:t}},T=function(){return{type:c}},N=function(e){return{type:y,value:e}},x=function(e){return{type:m,service:e}},C=function(e){return{type:b,results:e}},L=function(e,t){return{type:O,id:e,newProps:t}},_=function(e){return{type:E,checking:e}},F=function(e,t,r,n){return{type:R,msgId:e,msgParams:t,level:r,duration:n}},I=function(e){return{type:P,show:e}},k=function(e,t,r){return{type:A,msgId:e,msgParams:t,level:r}},G=r(782904),M=r(731255),Z=r(675110),W=r(824260),Y=function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.service},B=(0,a.P1)(M.Rd,W.X1,Z.Iz,(function(e,t,r){return e?t:null!=r&&r.name?{featureTypeName:r.name,filterType:"OGC",ogcVersion:"1.1.0"}:null})),U=function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.results},X=r(308316),V=r(124852),q=r.n(V),H=r(45697),z=r.n(H),K=r(630998),Q=r.n(K),$=r(727418),J=r.n($),ee=r(724469),te=r(472986),re=r.n(te),ne=r(532425),oe=r(807472),ae=r(399534),ie=r(805346),le=r(135400),se=r(743129),ce=r(227361),ue=r.n(ce),pe=r(91175),de=r.n(pe),fe=r(747037),ye=r.n(fe),me=r(145869);function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}const ve=function(e){var t,r,n=e.cropDataSetVisible,o=void 0!==n&&n,a=e.cropDataSetEnabled,i=void 0!==a&&a,l=e.donwloadFilteredVisible,s=void 0!==l&&l,c=e.downloadFilteredEnabled,u=void 0!==c&&c,p=e.advancedOptionsVisible,d=void 0!==p&&p,f=e.compressionOptions,y=void 0===f?["CCITT RLE","LZW","JPEG","ZLib","PackBits","Deflate"]:f,m=e.selectedCompression,b=e.tileWidth,v=e.tileHeight,O=e.quality,h=e.onChange,g=void 0===h?function(){}:h,w=(t=q().useState(!1),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,l=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(l)throw o}}return a}}(t,r)||function(e,t){if(e){if("string"==typeof e)return be(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?be(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),E=w[0],S=w[1];return q().createElement(q().Fragment,null,o&&q().createElement("div",{className:"mapstore-downloadwpsoptions-menuitem"},q().createElement(me.Z,{checked:i,onClick:function(e){return g("cropDataSet",e)}}),q().createElement(ie.Z,{msgId:"layerdownload.cropDataSet"})),s&&q().createElement("div",{className:"mapstore-downloadwpsoptions-menuitem"},q().createElement(me.Z,{checked:u,onClick:function(e){return g("downloadFilteredDataSet",e)}}),q().createElement(ie.Z,{msgId:"layerdownload.downloadFilteredDataSet"})),d&&q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-options"},q().createElement(ee.Button,{className:"no-border",onClick:function(){return S(!E)}},q().createElement(ee.Glyphicon,{glyph:"chevron-".concat(E?"down":"right")})),q().createElement(ie.Z,{msgId:"layerdownload.advancedOptions"})),E&&d&&q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced"},q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},q().createElement(ie.Z,{msgId:"layerdownload.compression"}),q().createElement(se.ZP,{clearable:!0,value:m,options:y.map((function(e){return ye()(e)?{value:e,label:e}:e})),onChange:function(e){return g("compression",null==e?void 0:e.value)}})),q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},q().createElement(ie.Z,{msgId:"layerdownload.quality"}),q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},q().createElement(ee.FormControl,{placeholder:"0.75",type:"number",min:"0",max:"1",value:O||"",onChange:function(e){return g("quality",e.target.value)}}))),q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},q().createElement(ie.Z,{msgId:"layerdownload.tileWidth"}),q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},q().createElement(ee.FormControl,{placeholder:"256",type:"number",min:"0",value:b||"",onChange:function(e){return g("tileWidth",e.target.value&&e.target.value.length>0?"".concat(parseInt(e.target.value,10)):"")}}),q().createElement("span",null,"px"))),q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem"},q().createElement(ie.Z,{msgId:"layerdownload.tileHeight"}),q().createElement("div",{className:"mapstore-downloadwpsoptions-advanced-menuitem-control"},q().createElement(ee.FormControl,{placeholder:"256",type:"number",min:"0",value:v||"",onChange:function(e){return g("tileHeight",e.target.value&&e.target.value.length>0?"".concat(parseInt(e.target.value,10)):"")}}),q().createElement("span",null,"px")))))};function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function he(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ge(e,t){return(ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function we(e,t){if(t&&("object"===Oe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ee(e)}function Ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Se(e){return(Se=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Re(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ge(e,t)}(i,e);var t,r,n,o,a=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Se(n);if(o){var r=Se(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return we(this,e)});function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),Re(Ee(t=a.call(this,e)),"getSelectedFormat",(function(){return ue()(t.props,"downloadOptions.selectedFormat")})),Re(Ee(t),"getSelectedSRS",(function(){return ue()(t.props,"downloadOptions.selectedSrs")||t.props.defaultSrs||ue()(de()(t.props.srsList),"name")})),t}return t=i,(r=[{key:"render",value:function(){var e,t=this;return q().createElement("form",null,!this.props.hideServiceSelector&&this.props.wpsAvailable&&this.props.wfsAvailable&&q().createElement(q().Fragment,null,q().createElement("label",null,q().createElement(ie.Z,{msgId:"layerdownload.service"})),q().createElement(se.ZP,{clearable:!1,value:this.props.service,onChange:function(e){return t.props.setService(e.value)},options:this.props.services})),q().createElement("label",null,q().createElement(ie.Z,{msgId:"layerdownload.format"})),q().createElement(se.ZP,{clearable:!1,isLoading:this.props.formatsLoading,onOpen:function(){return t.props.formatOptionsFetch(t.props.layer)},value:null===(e=this.props.downloadOptions)||void 0===e?void 0:e.selectedFormat,noResultsText:q().createElement(ie.Z,{msgId:"layerdownload.format"}),onChange:function(e){return t.props.onChange("selectedFormat",e.value)},options:this.props.formats.map((function(e){return{value:e.name,label:e.label||e.name}}))}),q().createElement("label",null,q().createElement(ie.Z,{msgId:"layerdownload.srs"})),q().createElement(se.ZP,{clearable:!1,value:this.getSelectedSRS(),onChange:function(e){return t.props.onChange("selectedSrs",e.value)},options:this.props.srsList.map((function(e){return{value:e.name,label:e.label||e.name}}))}),this.props.wpsOptionsVisible&&q().createElement(ve,{cropDataSetVisible:!0,donwloadFilteredVisible:this.props.downloadFilteredVisible,advancedOptionsVisible:this.props.wpsAdvancedOptionsVisible,cropDataSetEnabled:this.props.downloadOptions.cropDataSet,downloadFilteredEnabled:this.props.downloadOptions.downloadFilteredDataSet,selectedCompression:this.props.downloadOptions.compression,quality:this.props.downloadOptions.quality,tileWidth:this.props.downloadOptions.tileWidth,tileHeight:this.props.downloadOptions.tileHeight,onChange:this.props.onChange}),this.props.virtualScroll?null:q().createElement(ee.Checkbox,{checked:this.props.downloadOptions.singlePage,onChange:function(){return t.props.onChange("singlePage",!t.props.downloadOptions.singlePage)}},q().createElement(ie.Z,{msgId:"layerdownload.downloadonlycurrentpage"})))}}])&&he(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(q().Component);Re(Pe,"propTypes",{wpsAvailable:z().bool,wfsAvailable:z().bool,service:z().string,downloadOptions:z().object,formatOptionsFetch:z().func,formats:z().array,srsList:z().array,setService:z().func,onChange:z().func,defaultSrs:z().string,wpsOptionsVisible:z().bool,wpsAdvancedOptionsVisible:z().bool,downloadFilteredVisible:z().bool,layer:z().object,formatsLoading:z().bool,virtualScroll:z().bool,services:z().arrayOf(z().object),hideServiceSelector:z().bool}),Re(Pe,"defaultProps",{wpsAvailable:!1,wfsAvailable:!0,service:"wps",downloadOptions:{},formatsLoading:!1,formats:[],srsList:[],wpsOptionsVisible:!1,wpsAdvancedOptionsVisible:!1,downloadFilteredVisible:!1,virtualScroll:!0,services:[{value:"wps",label:"WPS"},{value:"wfs",label:"WFS"}],hideServiceSelector:!1});const Ae=Pe;var je=r(38560),De=r(196958);function Te(e){return(Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ce(e,t){return(Ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Le(e,t){if(t&&("object"===Te(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _e(e)}function _e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fe(e){return(Fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ce(e,t)}(i,e);var t,r,n,o,a=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Fe(n);if(o){var r=Fe(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Le(this,e)});function i(){var e;Ne(this,i);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Ie(_e(e=a.call.apply(a,[this].concat(r))),"onClose",(function(){e.props.onClose()})),Ie(_e(e),"renderIcon",(function(){return e.props.loading?q().createElement("div",{style:{float:"left"}},q().createElement(re(),{spinnerName:"circle",noFadeIn:!0})):q().createElement(ee.Glyphicon,{glyph:"download"})})),Ie(_e(e),"handleExport",(function(){var t=e.props,r=t.url,n=t.filterObj,o=t.downloadOptions,a=t.defaultSrs,i=t.srsList,l=t.onExport,s=t.layer,c=t.attributes,u=t.customAttributeSettings,p=o&&o.selectedSrs||a||(i[0]||{}).name,d=(0,De.Pf)(c,u);l(r||s.url,n,J()({},o,{selectedSrs:p},{propertyName:d}))})),e}return t=i,(r=[{key:"componentDidUpdate",value:function(e){this.props.enabled!==e.enabled&&this.props.enabled&&(this.props.onClearDownloadOptions(),"wms"===this.props.layer.type&&this.props.onCheckWPSAvailability(this.props.url||this.props.layer.url,this.props.defaultSelectedService))}},{key:"render",value:function(){var e,t,r,n=this,o=function(e){return n.props.formats.filter((function(t){var r,o,a=t.validServices,i=t.type,l=void 0===i?"vector":i;return(!a||Q()(a,(function(t){return t===e}))>-1)&&("vector"===l&&(null===(r=n.props.layer.search)||void 0===r?void 0:r.url)||"raster"===l&&!(null!==(o=n.props.layer.search)&&void 0!==o&&o.url))}))},a=o("wfs"),i=o("wps"),l=a.length>0?a.filter((function(e){return n.props.wfsFormats.find((function(t){return t.name.toLowerCase()===e.name.toLowerCase()}))})):this.props.wfsFormats,s=Boolean(null===(e=this.props.layer.search)||void 0===e?void 0:e.url);return this.props.enabled?q().createElement(ae.Z,null,q().createElement(oe.Z,{id:"mapstore-export",draggable:!1,modal:!0},q().createElement("span",{role:"header"},q().createElement("span",{className:"about-panel-title"},q().createElement(ie.Z,{msgId:"layerdownload.title"})),q().createElement("button",{onClick:this.onClose,className:"settings-panel-close close"},this.props.closeGlyph?q().createElement(ee.Glyphicon,{glyph:this.props.closeGlyph}):q().createElement("span",null,"Ã—"))),q().createElement("div",{role:"body"},this.props.checkingWPSAvailability?q().createElement(ne.Z,{size:100,style:{margin:"0 auto"}}):this.props.wpsAvailable||s?q().createElement(Ae,{wpsAvailable:this.props.wpsAvailable,wfsAvailable:s,service:this.props.service,downloadOptions:this.props.downloadOptions,setService:this.props.setService,onChange:this.props.onDownloadOptionChange,formatOptionsFetch:"wfs"===this.props.service?this.props.onFormatOptionsFetch:function(){},formatsLoading:this.props.formatsLoading,formats:"wfs"===this.props.service?l:i,srsList:this.props.srsList,defaultSrs:this.props.defaultSrs,wpsOptionsVisible:"wps"===this.props.service,wpsAdvancedOptionsVisible:!(null!==(t=this.props.layer.search)&&void 0!==t&&t.url),downloadFilteredVisible:!(null===(r=this.props.layer.search)||void 0===r||!r.url),layer:this.props.layer,virtualScroll:this.props.virtualScroll,customAttributesSettings:this.props.customAttributeSettings,attributes:this.props.attributes,hideServiceSelector:this.props.hideServiceSelector}):q().createElement(le.Z,{title:q().createElement(ie.Z,{msgId:"layerdownload.noSupportedServiceFound"})})),!this.props.checkingWPSAvailability&&q().createElement("div",{role:"footer"},q().createElement(je.Z,{bsStyle:"primary",className:"download-button",disabled:!this.props.downloadOptions.selectedFormat||this.props.loading,onClick:this.handleExport},this.renderIcon()," ",q().createElement(ie.Z,{msgId:"layerdownload.export"}))))):null}}])&&xe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(q().Component);Ie(ke,"propTypes",{filterObj:z().object,closeGlyph:z().string,url:z().string,wpsAvailable:z().bool,service:z().string,defaultSelectedService:z().string,enabled:z().bool,loading:z().bool,checkingWPSAvailability:z().bool,onClose:z().func,onExport:z().func,onCheckWPSAvailability:z().func,setService:z().func,onDownloadOptionChange:z().func,onClearDownloadOptions:z().func,onFormatOptionsFetch:z().func,downloadOptions:z().object,wfsFormats:z().array,formats:z().array,srsList:z().array,defaultSrs:z().string,layer:z().object,formatsLoading:z().bool,virtualScroll:z().bool,customAttributeSettings:z().object,attributes:z().array,hideServiceSelector:z().bool}),Ie(ke,"defaultProps",{onExport:function(){},onClose:function(){},onCheckWPSAvailability:function(){},setService:function(){},onDownloadOptionChange:function(){},onClearDownloadOptions:function(){},onFormatOptionsFetch:function(){},checkingWPSAvailability:!1,layer:{},closeGlyph:"1-close",wpsAvailable:!1,service:"wfs",defaultSelectedService:"wps",wfsFormats:[],formats:[{name:"application/json",label:"GeoJSON",type:"vector",validServices:["wps"]},{name:"application/arcgrid",label:"ArcGrid",type:"raster",validServices:["wps"]},{name:"image/tiff",label:"TIFF",type:"raster",validServices:["wps"]},{name:"application/wfs-collection-1.0",label:"wfs-collection-1.0",type:"vector",validServices:["wps"]},{name:"application/wfs-collection-1.1",label:"wfs-collection-1.1",type:"vector",validServices:["wps"]},{name:"application/zip",label:"Shapefile",type:"vector",validServices:["wps"]},{name:"text/csv",label:"CSV",type:"vector",validServices:["wps"]}],formatsLoading:!1,srsList:[{name:"native",label:"Native"},{name:"EPSG:4326",label:"WGS84"}],virtualScroll:!0,downloadOptions:{},hideServiceSelector:!1});const Ge=ke;var Me=r(982030),Ze=r(950966),We=r(624262),Ye=q().createElement(ee.Button,{bsStyle:"primary",bsSize:"small",className:"mapstore-exportdataresults-item-failed"},q().createElement(ee.Glyphicon,{glyph:"exclamation-sign"}));const Be=(0,Me.Z)((function(e){var t=e.results;return!(void 0===t?[]:t).length}),{title:q().createElement(ie.Z,{msgId:"exportDataResults.emptyStateMessage"})})((function(e){var t=e.loading,r=void 0!==t&&t,n=e.results,o=void 0===n?[]:n,a=e.currentLocale,i=e.onRemoveResult,l=void 0===i?function(){}:i;return r?q().createElement(ne.Z,{size:100,style:{margin:"0 auto",padding:"10px"}}):q().createElement("div",{className:"mapstore-exportdataresults-container"},o.map((function(e){var t=e.id,r=e.layerName,n=e.layerTitle,o=e.startTime,i=e.status,s=e.result,c=(0,We.in)({name:r,title:n},a),u=new Date(o),p=function(e){return e<10?"0".concat(e):"".concat(e)},d="".concat(p(u.getDate()),"/").concat(p(u.getMonth()+1),"/").concat(u.getFullYear()," ").concat(p(u.getHours()),":").concat(p(u.getMinutes()));return q().createElement("div",{key:t,className:"mapstore-exportdataresults-item"},q().createElement("div",{className:"mapstore-exportdataresults-item-name"},c),q().createElement("div",{className:"mapstore-exportdataresults-item-date"},d),q().createElement("div",{className:"mapstore-exportdataresults-item-buttons"},"pending"===i&&q().createElement(ne.Z,{size:22,style:{marginLeft:"2px"}}),"failed"===i&&s&&s.msgId?q().createElement(Ze.Z,{placement:"top",overlay:q().createElement(ee.Tooltip,{id:"exportresults-failure-tooltip"},q().createElement(ie.Z,{msgId:s.msgId,msgParams:s.msgParams}))},Ye):null,"failed"!==i||s&&s.msgId?null:Ye,"completed"===i&&q().createElement("a",{href:s,target:"_blank",rel:"noopener noreferrer"},q().createElement(ee.Button,{bsStyle:"primary",bsSize:"small"},q().createElement(ee.Glyphicon,{glyph:"floppy-disk"}))),q().createElement(ee.Button,{bsStyle:"primary",bsSize:"small",onClick:function(){return l(t)}},q().createElement(ee.Glyphicon,{glyph:"trash"}))))})))}));var Ue=r(294184),Xe=r.n(Ue);function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}const qe=function(e){var t,r=e.show,n=e.arrowDirection,o=void 0===n?"bottom":n,a=e.className,i=e.containerClassName,l=e.children;return q().createElement("div",{className:Xe().apply(void 0,["mapstore-info-bubble"].concat((t=r?["mapstore-info-bubble-visible"]:[],function(e){if(Array.isArray(e))return Ve(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return Ve(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ve(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[a]))},q().createElement("div",{className:Xe()("mapstore-info-bubble-container",i)},q().createElement("div",{className:Xe()("mapstore-info-bubble-arrow-container","arrow-".concat(o))},q().createElement("div",{className:"mapstore-info-bubble-arrow"})),q().createElement("div",{className:"mapstore-info-bubble-inner"},l)))},He=function(e){var t=e.msgId,r=e.msgParams,n=e.level,o=void 0===n?"normal":n,a=e.className;return q().createElement("div",{className:Xe()("mapstore-info-bubble-default-inner","mapstore-info-bubble-default-inner-level-".concat(o),a)},t?q().createElement(ie.Z,{msgId:t,msgParams:r}):null)};var ze=r(921533),Ke=r(656903),Qe=(0,ze.Z)(Ke.Z),$e=r(49977),Je=r.n($e),et=r(41545),tt=r.n(et),rt=r(313311),nt=r.n(rt),ot=r(478718),at=r.n(ot),it=r(493220),lt=r.n(it),st=r(984596),ct=r.n(st),ut=r(178598),pt=r(505055),dt=r(507526),ft=r(423570),yt=r.n(ft),mt=r(275982),bt=r(580416),vt=r(95797),Ot=r(197395),ht=r(263516),gt=r(881808),wt=r(607147),Et=r(800827),St=r(274621),Rt=r(886850),Pt=r(472747),At=r(3674),jt=r.n(At),Dt=r(957557),Tt=r.n(Dt),Nt=r(199767),xt=r(27835);function Ct(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Lt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ct(Object(r),!0).forEach((function(t){_t(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ct(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ft(e){return function(e){if(Array.isArray(e))return kt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||It(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function It(e,t){if(e){if("string"==typeof e)return kt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?kt(e,t):void 0}}function kt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Gt=function(e){var t=e.type,r=e.data;return"TEXT"===t?(0,Nt.XA)((0,Nt.p5)((0,Nt.Rr)(r.data),r.mimeType)):(0,Nt.fA)(r.mimeType,r.href,r.method,(0,Nt.Rr)(r.requestBodyData))},Mt=function(e){var t=e.layerName,r=e.ROI,n=e.roiCRS,o=e.dataFilter,a=e.targetCRS;return(0,xt.Uh)("gs:DownloadEstimator",[(0,Nt.qP)("layerName",(0,Nt.XA)((0,Nt.gN)(t)))].concat(Ft(r?[(0,Nt.qP)("ROI",Gt(r))]:[]),Ft(n?[(0,Nt.qP)("RoiCRS",(0,Nt.XA)((0,Nt.gN)(n)))]:[]),Ft(o?[(0,Nt.qP)("filter",Gt(o))]:[]),Ft(a?[(0,Nt.qP)("targetCRS",(0,Nt.XA)((0,Nt.gN)(a)))]:[])))},Zt=function(e){var t=e.layerName,r=e.dataFilter,n=e.outputFormat,o=e.targetCRS,a=e.roiCRS,i=e.ROI,l=e.cropToROI,s=e.asynchronous,c=e.outputAsReference,u=e.resultOutput,p=e.writeParameters;return(0,xt.Uh)("gs:Download",[(0,Nt.qP)("layerName",(0,Nt.XA)((0,Nt.gN)(t))),(0,Nt.qP)("outputFormat",(0,Nt.XA)((0,Nt.gN)(n)))].concat(Ft(i?[(0,Nt.qP)("ROI",Gt(i))]:[]),Ft(r?[(0,Nt.qP)("filter",Gt(r))]:[]),Ft(o?[(0,Nt.qP)("targetCRS",(0,Nt.XA)((0,Nt.gN)(o)))]:[]),Ft(a?[(0,Nt.qP)("RoiCRS",(0,Nt.XA)((0,Nt.gN)(a)))]:[]),[(0,Nt.qP)("cropToROI",(0,Nt.XA)((0,Nt.gN)(l?"true":"false")))],Ft(p&&jt()(p).length>0?[(0,Nt.XJ)(lt()(p).map((function(e){var t,r,n=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,l=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(l)throw o}}return a}}(t,r)||It(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],a=n[1];return(0,Nt.Dx)(o,a)})).join(""))]:[])),(0,Nt.DK)(s?(0,Nt.Tr)(!0,!0,c?(0,Nt.t$)(u,!0,"result"):(0,Nt.En)("result",u)):(0,Nt.En)("result",u)))},Wt=function(e,t,r){if(e&&t){var n=(0,xt.mG)(e,Mt({layerName:t.layerName,ROI:t.ROI,roiCRS:t.roiCRS,dataFilter:t.dataFilter,targetCRS:t.targetCRS}),{outputsExtractor:(0,xt.dr)(xt.ai)}),o=t.resultOutput||t.outputFormat||"application/zip",a=(0,xt.mG)(e,Zt(Lt(Lt({},Tt()(t,"notifyDownloadEstimatorSuccess","attribute")),{},{outputAsReference:!!t.asynchronous&&t.outputAsReference,resultOutput:o})),r,{headers:{"Content-Type":"application/xml",Accept:"application/xml, ".concat(o)}});return n.catch((function(){throw new Error("DownloadEstimatorException")})).mergeMap((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length>0&&"result"===e[0].identifier&&"true"===e[0].data)return t.notifyDownloadEstimatorSuccess?$e.Observable.of("DownloadEstimatorSuccess").concat(a):a;throw new Error("DownloadEstimatorFailed")}))}return $e.Observable.empty()},Yt=function(e,t,r){if(e&&t){var n=(0,xt.mG)(e,Mt({layerName:t.layerName,ROI:t.ROI,roiCRS:t.roiCRS,dataFilter:t.dataFilter,targetCRS:t.targetCRS}),{outputsExtractor:(0,xt.dr)(xt.ai)}),o=t.resultOutput||t.outputFormat||"application/zip",a=(0,xt.mG)(e,Zt(Lt(Lt({},Tt()(t,"notifyDownloadEstimatorSuccess","attribute","asynchronous","outputFormat")),{},{asynchronous:!0,outputAsReference:!0,resultOutput:"application/wfs-collection-1.0",outputFormat:"application/wfs-collection-1.0"})),r,{headers:{"Content-Type":"application/xml",Accept:"application/xml, application/wfs-collection-1.0"}});return n.catch((function(){throw new Error("DownloadEstimatorException")})).mergeMap((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length>0&&"result"===e[0].identifier&&"true"===e[0].data)return t.notifyDownloadEstimatorSuccess?$e.Observable.of("DownloadEstimatorSuccess").concat(a):a;throw new Error("DownloadEstimatorFailed")})).mergeMap((function(n){if("DownloadEstimatorSuccess"===n)return $e.Observable.of("DownloadEstimatorSuccess");if(n&&1===(null==n?void 0:n.length))return(0,xt.mG)(e,function(e){var t=e.input,r=e.attribute,n=e.filter,o=e.asynchronous,a=e.outputAsReference,i=e.resultOutput;return(0,xt.Uh)("vec:Query",[(0,Nt.qP)("features",(0,Nt.fA)(t.mimeType,t.href.replace(/&/g,"&amp;"),"GET"))].concat(Ft(r?r.map((function(e){return(0,Nt.qP)("attribute",(0,Nt.XA)((0,Nt.gN)(e)))})):[]),Ft(n?[(0,Nt.qP)("filter",Gt(n))]:[])),(0,Nt.DK)(o?(0,Nt.Tr)(!0,!0,a?(0,Nt.t$)(i,!0,"result"):(0,Nt.En)("result",i)):(0,Nt.En)("result",i)))}(Lt(Lt({},Tt()(t,"notifyDownloadEstimatorSuccess")),{},{input:n[0],filter:null,outputAsReference:!!t.asynchronous&&t.outputAsReference,resultOutput:o})),r,{headers:{"Content-Type":"application/xml",Accept:"application/xml, ".concat(o)}});throw new Error("DownloadFailed")}))}return $e.Observable.empty()},Bt=r(47805),Ut=[{outputFormat:"shape-zip",extension:"zip"},{outputFormat:"csv",extension:"csv"},{outputFormat:"excel",extension:"xls"},{outputFormat:"excel2007",extension:"xlsx"},{outputFormat:"dxf",extension:"dxf"},{outputFormat:"dxf-zip",extension:"zip"},{outputFormat:"application/vnd.google-earth.kml+xml",extension:"kml"},{outputFormat:"application/json",extension:"json"},{outputFormat:"gml3",extension:"gml"},{outputFormat:"GML2",extension:"gml"},{outputFormat:"application/vnd.googlxml",extension:"kml"},{outputFormat:"OGR-CSV",extension:"csv"},{outputFormat:"OGR-FileGDB",extension:"gdb"},{outputFormat:"OGR-GPKG",extension:"gpkg"},{outputFormat:"OGR-KML",extension:"kml"},{outputFormat:"OGR-MIF",extension:"mif"},{outputFormat:"OGR-TAB",extension:"tab"},{outputFormat:"SHAPE-ZIP",extension:"zip"},{outputFormat:"gml32",extension:"gml"},{outputFormat:"application/x-gpk",extension:"gpk"}],Xt=r(896309),Vt=r(510284),qt=r(439156),Ht=r.n(qt),zt=r(838848);function Kt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Qt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Kt(Object(r),!0).forEach((function(t){$t(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function $t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jt(e){return function(e){if(Array.isArray(e))return tr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||er(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function er(e,t){if(e){if("string"==typeof e)return tr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?tr(e,t):void 0}}function tr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var rr={gml3:"GML3.1",GML2:"GML2","DXF-ZIP":"DXF-ZIP","application/vnd.google-earth.kml+xml":"KML","OGR-CSV":"OGR-CSV","OGR-FileGDB":"OGR-GeoDatabase","OGR-GPKG":"OGR-GeoPackage","OGR-KML":"OGR-KML","OGR-MIF":"OGR-MIF","OGR-TAB":"OGR-TAB","SHAPE-ZIP":"Shapefile",gml32:"GML3.2","application/json":"GeoJSON",csv:"CSV","application/x-gpkg":"GeoPackage",excel:"excel",excel2007:"excel2007"},nr=Ht()({wfsVersion:"1.1.0"}),or=nr.getFeature,ar=nr.query,ir=nr.sortBy,lr=nr.propertyName,sr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.filterObj,n=void 0===r?{}:r,o=e.layerFilter,a=e.downloadOptions,i=void 0===a?{}:a,l=e.options,s=l.sortOptions,c=l.propertyNames,u=(0,Bt.mergeFiltersToOGC)({ogcVersion:"1.1.0",addXmlnsToRoot:!0,xmlnsToAdd:['xmlns:ogc="http://www.opengis.net/ogc"','xmlns:gml="http://www.opengis.net/gml"']},o,n);return(0,Rt.V6)(t,or(ar(n.featureTypeName,[].concat(Jt(s?[ir(s.sortBy,s.sortOrder)]:[]),Jt(c?[lr(c)]:[]),Jt(u?ct()(u):[])),{srsName:i.selectedSrs})),l,i.selectedFormat)},cr=function(e){var t,r=ue()(e,"filterObj.featureTypeName"),n=(t=ue()(e,"downloadOptions.selectedFormat"),de()(Ut.filter((function(e){return e.outputFormat===t})))||function(e){var t=e.split(/[^\w]/)[1];return t?{outputFormat:e,extension:t.toLowerCase()}:void 0}(t));return n&&n.extension?r+"."+n.extension:r},ur=function(e){return e.query&&e.query.featureTypes&&e.query.featureTypes[e.query.typeName]&&e.query.featureTypes[e.query.typeName].attributes&&e.query.featureTypes[e.query.typeName].attributes[0]&&e.query.featureTypes[e.query.typeName].attributes[0].attribute||null},pr=function(e){switch(e.code){case"ProcessFailed":return{msgId:"layerdownload.wpsExecuteError.processFailed",msgParams:{exceptionReport:e.message}};case"NoStatusLocation":case"NoExecutionId":case"UnexpectedProcessStatus":return{msgId:"layerdownload.wpsExecuteError.badResponse",msgParams:{eCode:e.code}};case"ExecuteProcessXHRFailed":return{msgId:"layerdownload.wpsExecuteError.executeProcessXhrFailed"};case"GetExecutionStatusXHRFailed":return{msgId:"layerdonwload.wpsExecuteError.getExecutionStatusXhrFailed"};default:return{msgId:"layerdownload.wpsExecuteError.unexpectedError"}}},dr=function(e){var t=(0,St.np)(e);if(null!=t&&t.id){var r=document.cookie.split(";").filter((function(e){return e.indexOf("exportDataResults_".concat(t.id,"="))>-1}))[0];if(r){var n=JSON.parse(decodeURIComponent(r.split("=")[1])).results;return Je().Observable.of(C(n.filter((function(e){return"pending"!==e.status}))))}}return Je().Observable.empty()},fr=function(e,t){return e.ofType(i).switchMap((function(e){var r=e.url,n=e.selectedService;return(0,Pt.l)(r,"gs:DownloadEstimator,gs:Download").switchMap((function(e){return Je().Observable.defer((function(){return new Promise((function(t,r){return(0,pt.parseString)(e.data,{tagNameProcessors:[dt.stripPrefix]},(function(e,n){return e?r(e):t(n)}))}))}))})).flatMap((function(e){var r,o,a,i,l,s,c,u,p,d=t.getState(),f=(0,Z.Iz)(d),y=[null==e||null===(r=e.ProcessDescriptions)||void 0===r||null===(o=r.ProcessDescription)||void 0===o||null===(a=o[0])||void 0===a||null===(i=a.Identifier)||void 0===i?void 0:i[0],null==e||null===(l=e.ProcessDescriptions)||void 0===l||null===(s=l.ProcessDescription)||void 0===s||null===(c=s[1])||void 0===c||null===(u=c.Identifier)||void 0===u?void 0:u[0]],m=Q()(y,(function(e){return"gs:DownloadEstimator"===e}))>-1&&Q()(y,(function(e){return"gs:Download"===e}))>-1,b=null===(p=f.search)||void 0===p?void 0:p.url,v=m&&("wps"===n||!b);return Je().Observable.of(x(v?"wps":"wfs"),N(m),j(!1))})).catch((function(){return Je().Observable.of(x("wfs"),N(!1),j(!1))})).startWith(j(!0))}))},yr=function(e){return e.ofType(bt.HN).switchMap((function(e){var t;return Je().Observable.from([(0,G.Xi)("layerdownload"),D("singlePage",!1)].concat(Jt(null!==(t=e.layer.search)&&void 0!==t&&t.url?[(0,vt.rP)(e.layer.url,{featureTypeName:e.layer.name})]:[])))}))},mr=function(e){return e.ofType(d).switchMap((function(e){return(0,Rt.ED)(e).map((function(e){return t=function(e){var t=ue()(e,"WFS_Capabilities.OperationsMetadata.Operation"),r=nt()(t,(function(e){return"GetFeature"===e.name})),n=ue()(r,"Parameter"),o=nt()(n,(function(e){return"outputFormat"===e.name})).Value,a=at()(rr,o);return lt()(a).map((function(e){var t,r,n=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,l=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(l)throw o}}return a}}(t,r)||er(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{name:n[0],label:n[1]}}))}(e),{type:f,wfsFormats:t};var t}))}))},br=function(e,t){return e.ofType(s).switchMap((function(r){var n,o,a,i,l,s,c=t.getState(),u=(c.featuregrid||{}).virtualScroll,p=void 0!==u&&u,d=Y(c),f=(0,Z.Iz)(c),y=(0,Et.pQ)(c),m=(0,X.Pz)(c),b=r.downloadOptions.propertyName?[(0,zt.dm)((0,W.qj)(c,f.name))].concat(Jt(r.downloadOptions.propertyName)):null,O=f.layerFilter;return"wps"===d?(o=!(null===(n=f.search)||void 0===n||!n.url),a=r.downloadOptions.cropDataSet&&!!y&&!!y.bounds,i={layerName:f.name,outputFormat:r.downloadOptions.selectedFormat,asynchronous:!0,outputAsReference:!0,targetCRS:r.downloadOptions.selectedSrs&&"native"!==r.downloadOptions.selectedSrs?r.downloadOptions.selectedSrs:void 0,cropToROI:a,dataFilter:r.downloadOptions.downloadFilteredDataSet?{type:"TEXT",data:{mimeType:"text/xml; subtype=filter/1.1",data:(0,Bt.mergeFiltersToOGC)({ogcVersion:"1.1.0",addXmlnsToRoot:!0,xmlnsToAdd:['xmlns:ogc="http://www.opengis.net/ogc"','xmlns:gml="http://www.opengis.net/gml"']},f.layerFilter,r.filterObj)}}:void 0,ROI:a?{type:"TEXT",data:{mimeType:"application/wkt",data:tt().stringify((0,Xt.bboxToFeatureGeometry)(y.bounds))}}:void 0,roiCRS:a?y.crs||"EPSG:4326":void 0,writeParameters:Qt(Qt(Qt({},r.downloadOptions.tileWidth?{tilewidth:r.downloadOptions.tileWidth}:{}),r.downloadOptions.tileHeight?{tileheight:r.downloadOptions.tileHeight}:{}),r.downloadOptions.compression?Qt({compression:r.downloadOptions.compression},r.downloadOptions.quality?{quality:r.downloadOptions.quality}:{}):{}),notifyDownloadEstimatorSuccess:!0,attribute:b},l={id:yt()(),layerName:f.name,layerTitle:f.title,status:"pending"},s={outputsExtractor:(0,xt.dr)(xt.RW)},(o&&b?Yt:Wt)(r.url,i,s).takeUntil(e.ofType(h).filter((function(e){return e.id===l.id})).take(1)).flatMap((function(e){var t,r;return"DownloadEstimatorSuccess"===e?Je().Observable.of((r=Qt(Qt({},l),{},{startTime:(new Date).getTime()}),{type:v,result:r}),F("layerdownload.exportResultsMessages.newExport"),T(),(0,G.Xi)("layerdownload","enabled")):(t=Je().Observable).of.apply(t,Jt(e&&e.length>0&&e[0].href?[L(l.id,{status:"completed",result:e[0].href}),F("layerdownload.exportResultsMessages.exportSuccess",{layerTitle:(0,We.in)(f,m)},"success")]:[L(l.id,{status:"failed",result:{msgId:"layerdonwload.exportResultsMessages.invalidHref"}}),F("layerdownload.exportResultsMessages.exportFailure",{layerTitle:(0,We.in)(f,m)},"danger")]))})).catch((function(e){var t;return(t=Je().Observable).of.apply(t,Jt(e.message&&e.message.indexOf("DownloadEstimator")>-1?[(0,Ot.error)({error:e,title:"layerdownload.error.downloadEstimatorTitle",message:"layerdownload.error.downloadEstimatorFailed"}),T()]:[L(l.id,{status:"failed",result:pr(e)}),F("layerdownload.exportResultsMessages.exportFailure",{layerTitle:(0,We.in)(f,m)},"danger")]))}))):sr({url:r.url,downloadOptions:r.downloadOptions,filterObj:r.filterObj,layerFilter:O,options:{pagination:!p&&ue()(r,"downloadOptions.singlePage")?r.filterObj&&r.filterObj.pagination:null,propertyNames:b}}).do((function(e){var t=e.data;if("application/xml"===e.headers["content-type"]){var r=String.fromCharCode.apply(null,new Uint8Array(t));if(0===r.indexOf("<ows:ExceptionReport"))throw r}})).catch((function(){return sr({url:r.url,downloadOptions:r.downloadOptions,filterObj:r.filterObj,layerFilter:O,options:{pagination:!p&&ue()(r,"downloadOptions.singlePage")?r.filterObj&&r.filterObj.pagination:null,sortOptions:(e=ur(t.getState()),e?{sortBy:e,sortOrder:"A"}:{}),propertyNames:r.downloadOptions.propertyName?[].concat(Jt(r.downloadOptions.propertyName),[(0,zt.dm)((0,W.qj)(c,f.name))]):null}}).do((function(e){var t=e.data,n=e.headers;if("application/xml"===n["content-type"]){var o=String.fromCharCode.apply(null,new Uint8Array(t));if(0===o.indexOf("<ows:ExceptionReport"))throw o}(0,ut.saveAs)(new Blob([t],{type:n&&n["content-type"]}),cr(r))}));var e})).do((function(e){var t=e.data,n=e.headers;(0,ut.saveAs)(new Blob([t],{type:n&&n["content-type"]}),cr(r))})).map((function(){return T()})).catch((function(e){return Je().Observable.of((0,Ot.error)({error:e,title:"layerdownload.error.title",message:"layerdownload.error.invalidOutputFormat",autoDismiss:5,position:"tr"}),T())}))}))},vr=function(e,t){return e.ofType(G.kM).filter((function(e){return"queryPanel"===e.control&&!(0,wt._d)(t.getState())&&(0,wt.lI)(t.getState())})).switchMap((function(){return Je().Observable.of((0,G.Xi)("layerdownload"))}))},Or=function(e){return e.ofType(R).concatMap((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Je().Observable.of(k(e.msgId,e.msgParams,e.level),I(!0)).delay(10).concat(Je().Observable.of(I(!1)).delay(e.duration||3e3)).concat(Je().Observable.empty().delay(1e3))}))},hr=function(e,t){return e.ofType(w).exhaustMap((function(){var e=t.getState(),r=(U(e)||[]).filter((function(e){return"completed"===e.status}));return r.length>0?Je().Observable.forkJoin(r.map((function(e){var t=e.result,r=t.indexOf("executionId="),n=t.slice(r),o=n.indexOf("&"),a=(o>-1?n.slice(0,o):n).slice(12),i=t.indexOf("?"),l=t.slice(0,i);return(0,xt.W5)(l,a).let(Vt.oB).catch((function(){return Je().Observable.of(null)})).map((function(t){return t?null:e.id}))}))).flatMap((function(e){return Je().Observable.of((t=e.filter((function(e){return!!e})),{type:g,ids:t}),{type:S},_(!1));var t})).startWith(_(!0)):Je().Observable.empty()}))},gr=function(e,t){return e.ofType(v,h,O,S).filter((function(){return(0,St.jl)(t.getState())})).do((function(){var e=t.getState(),r=U(e),n=(0,St.np)(e).id,o=JSON.stringify({results:r});document.cookie="exportDataResults_".concat(n,"=").concat(encodeURIComponent(o))})).flatMap((function(){return Je().Observable.empty()}))},wr=function(e){return e.ofType(gt.ok).switchMap((function(){return e.ofType(ht.Nv).switchMap((function(){return Je().Observable.of(C([]))})).takeUntil(e.ofType(mt.nk))}))},Er=function(e,t){return e.ofType(gt.ok).switchMap((function(){return dr(t.getState()).concat(e.ofType(ht.XP).switchMap((function(){return dr(t.getState())})).takeUntil(e.ofType(mt.nk)))}))};function Sr(e){return function(e){if(Array.isArray(e))return Rr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Rr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Rr(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ar(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pr(Object(r),!0).forEach((function(t){jr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function jr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Dr=(0,r(322843).rx)("LayerDownload",{component:(0,o.connect)((0,a.zB)({url:W.Bu,filterObj:B,enabled:function(e){var t,r;return null==e||null===(t=e.controls)||void 0===t||null===(r=t.layerdownload)||void 0===r?void 0:r.enabled},downloadOptions:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.downloadOptions},loading:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.loading},wfsFormats:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.wfsFormats},formatsLoading:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.formatsLoading},layer:Z.Iz,wpsAvailable:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.wpsAvailable},service:Y,checkingWPSAvailability:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.checkingWPSAvailability},virtualScroll:function(e){return e&&e.featuregrid&&e.featuregrid.virtualScroll},customAttributeSettings:M.Xh,attributes:W.L}),{onExport:function(e,t,r){return{type:s,url:e,filterObj:t,downloadOptions:r}},setService:x,onDownloadOptionChange:D,onClearDownloadOptions:function(){return{type:p}},onFormatOptionsFetch:function(e){return{type:d,layer:e}},onCheckWPSAvailability:function(e,t){return{type:i,url:e,selectedService:t}},onClose:function(){return(0,G.Xi)("layerdownload")}})(Ge),containers:{TOC:{doNotHide:!0,name:"LayerDownload"},FeatureEditor:{doNotHide:!0,name:"LayerDownload",position:20,target:"toolbar",Component:(0,o.connect)((0,a.zB)({isDownloadOpen:function(e){var t,r;return null==e||null===(t=e.controls)||void 0===t||null===(r=t.layerdownload)||void 0===r?void 0:r.enabled}}),{onClick:function(){return(0,G.Xi)("layerdownload")}})((function(e){var t=e.disabled,r=e.results,n=void 0===r?[]:r,o=e.mode,a=e.isDownloadOpen,i=e.onClick,l=void 0===i?function(){}:i;return q().createElement(Qe,{id:"download-grid",keyProp:"download-grid",tooltipId:"featuregrid.toolbar.downloadGridData",disabled:t||0===n.length,active:a,visible:"VIEW"===o,onClick:l,glyph:"download"})}))},MapFooter:{doNotHide:!0,name:"LayerDownload",position:1,tool:(0,o.connect)((0,a.zB)({active:function(e){var t,r;return null==e||null===(t=e.controls)||void 0===t||null===(r=t.exportDataResults)||void 0===r?void 0:r.enabled},showInfoBubble:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.showInfoBubble},infoBubbleMessage:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.infoBubbleMessage},checkingExportDataEntries:function(e){var t;return null==e||null===(t=e.layerdownload)||void 0===t?void 0:t.checkingExportDataEntries},results:U,currentLocale:X.Pz}),{onToggle:G.Xi.bind(null,"exportDataResults","enabled"),onActive:function(){return{type:w}},onRemoveResult:function(e){return{type:h,id:e}}})((function(e){var t=e.active,r=void 0!==t&&t,n=e.showInfoBubble,o=void 0!==n&&n,a=e.infoBubbleMessage,i=void 0===a?{}:a,l=e.checkingExportDataEntries,s=e.results,c=void 0===s?[]:s,u=e.currentLocale,p=e.onToggle,d=void 0===p?function(){}:p,f=e.onActive,y=void 0===f?function(){}:f,m=e.onRemoveResult;return q().useEffect((function(){r&&y()}),[r]),q().createElement(q().Fragment,null,c.length>0?q().createElement("div",{id:"mapstore-export-data-results-button-container"},q().createElement(Ze.Z,{placement:"left",overlay:q().createElement(ee.Tooltip,{id:"mapstore-export-data-results-tooltip"},q().createElement(ie.Z,{msgId:"exportDataResults.title"}))},q().createElement(ee.Button,{bsStyle:"primary",bsSize:"small",onClick:function(){return d()}},q().createElement(ee.Glyphicon,{glyph:"download"}))),q().createElement(qe,{show:o,className:"mapstore-export"},q().createElement(He,i))):null,q().createElement("div",null,r&&q().createElement(ae.Z,null,q().createElement(oe.Z,{id:"mapstore-export-data-results",draggable:!1,modal:!0},q().createElement("span",{role:"header"},q().createElement("span",{className:"about-panel-title"},q().createElement(ie.Z,{msgId:"exportDataResults.title"})),q().createElement("button",{onClick:function(){return d()},className:"settings-panel-close close"},q().createElement(ee.Glyphicon,{glyph:"1-close"}))),q().createElement("div",{role:"body"},q().createElement(Be,{loading:l,results:c,currentLocale:u,onRemoveResult:m}))))))}))}},epics:n,reducers:{layerdownload:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{downloadOptions:{singlePage:!0}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case s:return Ar(Ar({},e),{},{loading:!0});case u:return Ar(Ar({},e),{},{downloadOptions:Ar(Ar({},e.downloadOptions),{},jr({},t.key,t.value))});case p:return Ar(Ar({},e),{},{downloadOptions:{singlePage:!0}});case d:return Ar(Ar({},e),{},{layer:t.layer,wfsFormats:[],formatsLoading:!0});case c:return Ar(Ar({},e),{},{loading:!1});case f:return Ar(Ar({},e),{},{wfsFormats:t.wfsFormats,formatsLoading:!1});case m:return Ar(Ar({},e),{},{service:t.service});case y:return Ar(Ar({},e),{},{wpsAvailable:t.value});case l:return Ar(Ar({},e),{},{checkingWPSAvailability:t.checking});case b:return Ar(Ar({},e),{},{results:t.results});case v:return Ar(Ar({},e),{},{results:[].concat(Sr(e.results||[]),[t.result])});case O:var r=Q()(e.results||[],{id:t.id});return Ar(Ar({},e),{},{results:r>-1?[].concat(Sr(e.results.slice(0,r)),[Ar(Ar({},e.results[r]),t.newProps||{})],Sr(e.results.slice(r+1))):e.results});case h:return Ar(Ar({},e),{},{results:(e.results||[]).filter((function(e){return e.id!==t.id}))});case g:return Ar(Ar({},e),{},{results:(e.results||[]).filter((function(e){return-1===Q()(t.ids,(function(t){return t===e.id}))}))});case P:return Ar(Ar({},e),{},{showInfoBubble:t.show});case A:return Ar(Ar({},e),{},{infoBubbleMessage:{msgId:t.msgId,msgParams:t.msgParams,level:t.level}});case E:return Ar(Ar({},e),{},{checkingExportDataEntries:t.checking});default:return e}}}})},510284:(e,t,r)=>{"use strict";r.d(t,{sw:()=>v,oB:()=>O});var n=r(49977),o=r.n(n),a=r(227361),i=r.n(a),l=r(505055),s=r(507526);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){var t="function"==typeof Map?new Map:void 0;return(p=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return d(e,arguments,m(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),y(n,e)})(e)}function d(e,t,r){return(d=f()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&y(o,r.prototype),o}).apply(null,arguments)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r(849843);var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(o,e);var t,r,n=(t=o,r=f(),function(){var e,n=m(t);if(r){var o=m(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return u(this,e)});function o(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(r=n.call(this,e)).name="OGCError",r.code=t,r}return o}(p(Error)),v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{tagNameProcessors:[s.stripPrefix],explicitArray:!1,mergeAttrs:!0};return o().Observable.bindNodeCallback((function(e,r){return(0,l.parseString)(e,t,r)}))(e)},O=function(e){return e.switchMap((function(e){return"string"==typeof e.data&&e.data.indexOf("ExceptionReport")>0?o().Observable.bindNodeCallback((function(e,t){return(0,l.parseString)(e,{tagNameProcessors:[s.stripPrefix],explicitArray:!1,mergeAttrs:!0},t)}))(e.data).map((function(e){var t=i()(e,"ExceptionReport.Exception.ExceptionText");throw new b(t||"Undefined OGC Service Error",i()(e,"ExceptionReport.Exception.exceptionCode"))})):o().Observable.of(e)}))}}}]);